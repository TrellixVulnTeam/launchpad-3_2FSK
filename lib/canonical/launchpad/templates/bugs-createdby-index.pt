<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="context/@@malone_template/master"
      i18n:domain="malone">

<body>

<div metal:fill-slot="main" tal:define="owner python:request.get('owner', '')">

  <h1 tal:condition="owner">Bugs created by <span tal:content="request/owner">someone</span></h1>
  <h1 tal:condition="python: not owner">All Bugs</h1>
  <form method="GET" action="">
    <b>Show bugs for:</b>
    <select name="owner" onclick="form.submit()">
      <option value="" tal:attributes="selected python:not owner">All Users</option>
      <option tal:repeat="p view/getAllPeople"
              tal:content="p/name"
              tal:attributes="selected python:p.name == owner">someone</option>
    </select>
  </form>
  <table class="listing rowNavigation">
    <tr>
      <th>Bug</th>
      <th>Title</th>
      <th>Task On</th>
      <th>Status</th>
      <th>Priority</th>
      <th>Severity</th>
      <th>Date Created</th>
      <th tal:condition="not:owner">Owner</th>
    </tr>
    <tr tal:repeat="bug view/getBugs"
        tal:attributes="onclick string:window.location='${bug/id}';">
        <td valign="top" align="center" tal:content="bug/id">$Bug.title</td>
        <td valign="top">
          <a tal:content="bug/title" tal:attributes="href bug/id">title</a>
        </td>
        <td valign="top">
          <div tal:repeat="task bug/bugtasks">
             <span tal:omit-tag
                   tal:condition="task/product">
                   <span tal:omit-tag
                         tal:condition="task/product/project"
                         tal:content="task/product/project/name" />
                   <span tal:omit-tag
                         tal:condition="not: task/product/project">
                         upstream</span>
                   <span tal:omit-tag tal:content="task/product/name" />
             </span>
             <span tal:omit-tag
                   tal:condition="task/distribution"
                   tal:content="task/distribution/name" />
          </div>
        </td>
        <td valign="top">
          <div tal:repeat="task bug/bugtasks"
               tal:content="task/status/lp:BugTaskStatus"></div>
        </td>
        <td valign="top" nowrap>
          <div tal:repeat="task bug/bugtasks"
               tal:content="task/priority/lp:BugPriority"></div>
        </td>
        <td valign="top" nowrap>
          <div tal:repeat="task bug/bugtasks"
               tal:content="task/severity/lp:BugSeverity"></div>
        </td>
        <td valign="top" tal:content="python:bug.datecreated.strftime('%d %b %y')" nowrap>date</td>
        <td valign="top" tal:condition="not:owner" tal:content="bug/owner/name"></td>
    </tr>
  </table>

  <input type="submit" value="Add" onclick="window.open('+new','_top')" />

</div>

</body>
</html>
