<div
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  id="series-derivation" class="portlet"
  tal:define="overview_menu context/menu:overview">
  <tal:is_derived condition="context/is_derived_series">
    <tal:is_initialized condition="not: context/isInitializing">
    <tal:one_parent condition="view/has_unique_parent">
      <h2>Derived from <tal:name replace="view/unique_parent/displayname"/></h2>
    </tal:one_parent>
    <tal:multiple_parents condition="not: view/has_unique_parent">
      <h2>Derived from <tal:name replace="view/number_of_parents"/> parents</h2>
    </tal:multiple_parents>

      <tal:diffs define="nb_diffs view/num_differences;
                         nb_diffs_in_parent view/num_differences_in_parent;
                         nb_diffs_in_child view/num_differences_in_child;">
        <ul id="derivation_stats">
          <li tal:condition="nb_diffs">
            <a tal:attributes="href string:${context/fmt:url}/+localpackagediffs"
               class="sprite info"
               title="Source package differences between this series and his parent(s)">
              <tal:nb_diffs replace="nb_diffs"/> package<tal:plural
                content="string:s"
                condition="python:nb_diffs!=1"/> with differences
            </a>
          </li>
         <li tal:condition="nb_diffs_in_parent">
            <a tal:attributes="href string:${context/fmt:url}/+missingpackages"
               class="sprite info"
               title="Source packages only in parent series">
              <tal:one_parent condition="view/has_unique_parent">
                <tal:nb_diffs replace="nb_diffs_in_parent"/> package<tal:plural
                  content="string:s"
                  condition="python:nb_diffs_in_parent!=1"/> only in <tal:replace
                    replace="view/unique_parent/displayname">Sid</tal:replace>
              </tal:one_parent>
              <tal:multiple_parents condition="not: view/has_unique_parent">
                <tal:nb_diffs replace="nb_diffs_in_parent"/> package<tal:plural
                  content="string:s"
                  condition="python:nb_diffs_in_parent!=1"/> only in a parent series
               </tal:multiple_parents>
            </a>
          </li>
          <li tal:condition="nb_diffs_in_child">
            <a tal:attributes="href string:${context/fmt:url}/+uniquepackages"
               class="sprite info"
               title="Source packages only in derived series">
              <tal:nb_diffs replace="nb_diffs_in_child"/> package<tal:plural
                content="string:s"
                condition="python:nb_diffs_in_child!=1"/> only in <tal:replace
                  replace="context/displayname">Natty</tal:replace>
            </a>
          </li>
         </ul>
        <tal:no_diffs
          condition="python:not(nb_diffs or nb_diffs_in_parent or nb_diffs_in_child)">
          No differences.
        </tal:no_diffs>
      </tal:diffs>
  </tal:is_initialized>
  </tal:is_derived>
  <tal:is_initializing condition="context/isInitializing">
    <h2>Series initialization in progress</h2>
      This series is initializing.
  </tal:is_initializing>
</div>
