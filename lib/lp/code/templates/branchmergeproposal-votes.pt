<div
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  id="code-review-votes">

<table tal:condition="view/show_table" class="listing compressed">
  <thead>
    <tr>
      <th>Reviewer</th>
      <th>Review Type</th>
      <th>Date Requested</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody>
    <!-- Current reviews -->
    <tr tal:repeat="info view/review_info">
      <td>
        <tal:reviewer
         replace="structure info/review/message/owner/fmt:link:mainsite">
        Eric the Reviewer</tal:reviewer>
        <tal:untrusted condition="not: info/trusted">
            (community)
        </tal:untrusted>
      </td>
      <td tal:content="info/review/vote_tag" />
      <td><tal:req condition="info/request">
          <tal:date replace="info/request/date_created/fmt:approximatedate"/>
      </tal:req></td>
      <td>
        <span tal:attributes="class string:vote${info/review/vote/name}"
              tal:content="info/review/vote/title">
          Approved
        </span>
        <tal:date replace="info/review/message/datecreated/fmt:displaydate" />
      </td>
    </tr>
    <!-- Pending reviews -->
    <tr tal:repeat="review view/requested_reviews">
      <td tal:content="structure review/reviewer/fmt:link:mainsite" />
      <td tal:content="review/review_type" />
      <td>
        <tal:date-requested condition="review/show_date_requested">
          <span tal:attributes="title string:Requested by ${review/registrant/displayname}">
            <tal:date replace="review/date_requested/fmt:approximatedate"/>
          </span>
        </tal:date-requested>
      </td>
      <td>
        <span class="votePENDING">Pending</span>
        <tal:vote-link condition="review/user_can_review">
          <a tal:attributes="href string:+review?claim=${review/reviewer/name}&amp;review_type=${review/review_type_str}">[Review]</a>
        </tal:vote-link>
      </td>
    </tr>
    <tr>
      <td colspan="4" style="padding-top: 1em; patting-bottom: 0.5em">
        Review <a href="https://help.launchpad.net/Code/Review"
                  class="help">via email</a>:
        <img src="/@@/mail" style="padding-left:0.5em"/>
        <a tal:attributes="href string:mailto:${context/address}"
           tal:content="context/address">mp-x@launchpad.net</a>
      </td>
    </tr>

    <tal:request-review define="link context/menu:context/request_review"
                        condition="link/enabled">
    <tr>
      <td colspan="4" style="text-align:right">
        <div tal:content="structure link/render">
          Request review
        </div>
      </td>
    </tr>
    </tal:request-review>
  </tbody>
</table>

</div>
