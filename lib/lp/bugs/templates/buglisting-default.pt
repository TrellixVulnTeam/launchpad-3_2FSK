<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  metal:use-macro="view/macro:page/main_side"
  i18n:domain="malone"
>

<metal:block fill-slot="head_epilogue">
  <meta condition="not: view/should_show_bug_information"
        name="robots" content="noindex,nofollow" />
  <script type="text/javascript"
      tal:condition="
        request/features/malone.advanced-structural-subscriptions.enabled">
    LPS.use('lp.registry.structural_subscription', function(Y) {
        var module = Y.lp.registry.structural_subscription;
        Y.on('domready', function() {
          module.setup({content_box: "#structural-subscription-content-box"});
        });
    });
  </script>
</metal:block>

<body>

  <div metal:fill-slot="main">
    <div tal:condition="not: view/bug_tracking_usage/enumvalue:UNKNOWN"
         class="top-portlet">
      <tal:is_project_group condition="view/_projectContext">
        <tal:block condition="view/required:launchpad.Edit">
          <p tal:condition="not: context/products" class="warning message">
            There are no projects registered for
            <span tal:replace="context/displayname">project displayname</span>.
            <br />
            You need to <a href="+newproduct">register another project that is
            part of <tal:project replace="context/displayname" /></a> or
            associate an existing project with it.
          </p>
        </tal:block>

        <tal:has_products condition="context/products">
          <tal:no_bug_info condition="not:view/should_show_bug_information">
            <p tal:define="name context/displayname">
              <strong>
                You cannot report a bug for <tal:name replace="name"/> as none
                of the projects within the group use Launchpad for bug
                tracking.  Please check the individual projects for details of
                where bugs are reported.
              </strong>
            </p>
            <p id="getting-started-help">
              <a class="sprite maybe"
                 href="https://help.launchpad.net/Bugs">Getting started
                with bug tracking in Launchpad</a>.
            </p>
          </tal:no_bug_info>
        </tal:has_products>
      </tal:is_project_group>

        <tal:do_not_show_advanced_form
          condition="not: view/shouldShowAdvancedForm">
          <div tal:define="batch_navigator view/search">
            <div metal:use-macro="context/@@+bugtarget-macros-search/simple-search-form"></div>
            <tal:buglisting content="structure batch_navigator/@@+table-view" />
          </div>
        </tal:do_not_show_advanced_form>

        <tal:show_advanced_form condition="view/shouldShowAdvancedForm">
          <metal:advanced_form
             use-macro="context/@@+bugtask-macros-tableview/advanced_search_form" />
        </tal:show_advanced_form>

      <div class="yui-u">
        <div id="structural-subscription-content-box"></div>
      </div>

    </div>
    <div tal:condition="view/bug_tracking_usage/enumvalue:UNKNOWN"
          class="top-portlet">
      <p>
        <strong>
          <tal:displayname replace="context/displayname" />
          does not use Launchpad for bug tracking.
        </strong>
      </p>
      <p id="getting-started-help">
        <a class="sprite maybe"
          href="https://help.launchpad.net/Bugs">Getting started
        with bug tracking in Launchpad</a>.
      </p>
    </div>
  </div>

  <tal:side metal:fill-slot="side">
    <div id="bug-portlets" tal:condition="view/should_show_bug_information">
      <div id="involvement" class="portlet involvement">
        <ul>
          <li style="border: 0">
            <a href="+filebug" class="menu-link-filebug sprite bugs">
              Report a bug
            </a>
          </li>
        </ul>
      </div>
      <tal:menu replace="structure view/@@+related-pages" />
      <tal:do_not_show_portlets_advanced_form
        condition="not: view/shouldShowAdvancedForm">
        <tal:block content="structure context/@@+portlet-bugfilters" />
        <tal:block
            content="structure context/@@+portlet-publishing-details | nothing"/>
        <tal:block content="structure context/@@+portlet-bugtags"/>
        <tal:releasecriticalbugs
            tal:condition="view/shouldShowReleaseCriticalPortlet"
            tal:content="structure context/@@+portlet-bugtasklist-seriesbugs" />
        <tal:milestonecriticalbugs
          tal:condition="view/shouldShowReleaseCriticalPortlet"
          tal:content="structure context/@@+portlet-bugtasklist-milestonebugs" />
       </tal:do_not_show_portlets_advanced_form>
    </div>
  </tal:side>
</body>

</html>
