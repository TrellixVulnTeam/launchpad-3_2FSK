<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  metal:use-macro="view/macro:page/main_only"
  i18n:domain="launchpad"
>

<body>

<div metal:fill-slot="main">
  <div class="top-portlet">
    <h2>Packages by project series</h2>

  <tal:series_dict repeat="series_dict view/series_packages">
  <tal:series_packagings
    define="series series_dict/series;
            packagings series_dict/packagings">
    <h3>
      <a tal:attributes="href series/name">
        <span tal:replace="series/name">main</span> series
      </a>
    </h3>

    <p tal:condition="not: packagings">
      No packages linked to this series.
    </p>

    <tal:comment condition="nothing">
      This DIV is necessary for the table-actions:nth-child stylesheet.
    </tal:comment>
    <div>
      <table class="listing"
        tal:condition="packagings"
        tal:attributes="id series/name/fmt:css-id/packages-">
        <thead>
          <tr>
            <th>Distribution</th>
            <th>Distribution series</th>
            <th>Source package</th>
            <th>Version</th>
            <th style="width: 1em;"
              tal:condition="view/can_delete_packaging">&nbsp;</th>
          </tr>
        </thead>
        <tbody>
          <tr tal:repeat="packaging_dict packagings">
          <tal:packaging_field
            define="packaging packaging_dict/packaging;
                    form_id packaging_dict/form_id;
                    field packaging_dict/field">
            <td>
              <a tal:replace="structure packaging/distroseries/distribution/fmt:link" />
            </td>

            <td>
              <a tal:attributes="href packaging/distroseries/fmt:url"
                tal:content="packaging/distroseries/named_version" />
            </td>

            <td>
              <a
                tal:attributes="href string:${packaging/distroseries/fmt:url}/+source/${packaging/sourcepackagename/name}"
                tal:content="packaging/sourcepackagename/name">Apache</a>
            </td>

            <td>
              <tal:currentrelease
                replace="packaging/sourcepackage/currentrelease/version|nothing">
                  2.3.4-1
              </tal:currentrelease>
            </td>
            <td tal:condition="view/can_delete_packaging">
              <form style="display: inline" method="post"
                tal:attributes="action request/URL;
                                id form_id">
                <tal:hidden replace="structure field" />
                <a class="sprite remove"
                   tal:attributes="href packaging/sourcepackage/menu:overview/remove_packaging/fmt:url"
                  ></a>
              </form>
            </td>
          </tal:packaging_field>
          </tr>
        </tbody>
      </table>

      <ul class="table-actions"
        tal:condition="series/menu:overview/ubuntupkg/linked">
        <li>
          <a tal:replace="structure series/menu:overview/ubuntupkg/fmt:link" />
        </li>
      </ul>
    </div>
  </tal:series_packagings>
  </tal:series_dict>
  </div>

  <div class="portlet">
    <h2>Packages by distribution</h2>

  <tal:distribution repeat="distro view/distro_packaging">
    
    <h3>
      <a tal:attributes="href distro/distribution/fmt:url"
        tal:content="distro/distribution/title">Ubuntu Linux</a>
    </h3>

    <table id="distribution-series" class="listing">
      <thead>
        <tr>
          <th>Distribution series</th>
          <th>Source package</th>
          <th>Version</th>
          <th>Project series</th>
        </tr>
      </thead>
      <tbody>
        <tr tal:repeat="pkging distro/packagings">
          <td>
            <a tal:attributes="href pkging/distroseries/fmt:url"
                tal:content="pkging/distroseries/named_version" />
          </td>
          <td>
            <a
               tal:attributes="href string:${pkging/distroseries/fmt:url}/+source/${pkging/sourcepackagename/name}"
               tal:content="pkging/sourcepackagename/name"
              >Apache</a>
          </td>
          <td>
            <span tal:condition="pkging/sourcepackage/currentrelease"
                    tal:replace="pkging/sourcepackage/currentrelease/version"
                    >2.3.4-1</span>
          </td>
          <td>
            <a tal:replace="structure pkging/productseries/fmt:link" />
          </td>
        </tr>
      </tbody>
    </table>

  </tal:distribution>
  </div>
</div>
</body>
</html>
