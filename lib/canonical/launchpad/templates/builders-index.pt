<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  xml:lang="en"
  lang="en"
  dir="ltr"
  metal:use-macro="context/@@main_template/master"
  i18n:domain="launchpad"
>
  <body>

    <metal:heading fill-slot="pageheading">
      <h1>Build machines for Launchpad</h1>
    </metal:heading>

<metal:block fill-slot="head_epilogue">
    <meta http-equiv="refresh" content="300" />
</metal:block>

<metal:portlets fill-slot="portlets">
  <div class="portlet" id="portlet-build-queue-depth"
       tal:condition="view/hasQueuedBuilds">
    <h2>Build queue depth</h2>
    <div class="portletBody">
      <table width="100%">
        <tbody>
          <tr tal:repeat="arch view/buildQueueDepthByArch">
            <td tal:repeat="value arch" tal:content="value" />
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</metal:portlets>

  <div metal:fill-slot="main">

      <table class="listing sortable" tal:attributes="id string:builders">
      <thead>
        <tr class="builder-row">
            <th>Builder</th>
            <th>Architecture</th>
            <th>Owner</th>
            <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <tal:builder repeat="builder context/getBuilders">
          <tr class="builder-row">
            <td>
              <a tal:attributes="href builder/fmt:url"
                 tal:content="builder/name"
                 /><br />
              <tal:manual condition="builder/manual">Manual</tal:manual>
              <tal:auto condition="not: builder/manual">Automatic</tal:auto>
            </td>
            <td>
              <span tal:replace="builder/processor/name">i386</span>
              <tal:hardened
                 condition="builder/virtualized">&nbsp;Virtual</tal:hardened>
            </td>
            <td>
              <a tal:replace="structure builder/owner/fmt:link" />
            </td>
            <td>
              <tal:problem condition="not: builder/builderok">
                Not available
                <tal:reason condition="builder/failnotes">
                  because:<br />
                  <span tal:replace="builder/failnotes">Live CD</span>
                </tal:reason>
              </tal:problem>
              <tal:ok condition="builder/builderok">
                <tal:building condition="builder/currentjob">
                <tal:build define="build builder/currentjob/build">
                  Building
                  <span tal:replace="build/sourcepackagerelease/name" />
                  <span tal:replace="build/sourcepackagerelease/version" />
                  <br />
                  for
                  <tal:ppa condition="build/archive/purpose/enumvalue:PPA">
                    <a tal:replace="structure build/archive/owner/fmt:link" />
                  </tal:ppa>
                  <span tal:replace="build/distribution/displayname" />
                  <span tal:replace="build/distroseries/displayname" />
                  <tal:ppa condition="build/archive/purpose/enumvalue:PPA">
                    PPA
                  </tal:ppa>
                  <tal:no_ppa condition="not: build/archive/purpose/enumvalue:PPA">
                    (<span tal:replace="build/pocket/name/fmt:lower" />)
                  </tal:no_ppa>
                </tal:build>
                </tal:building>
                <tal:idle condition="not: builder/currentjob">
                  Idle
                </tal:idle>
              </tal:ok>
            </td>
          </tr>
        </tal:builder>
      </tbody>
      </table>

      <p class="discreet">Generated at <span tal:replace="view/now"/></p>

  </div>
</body>
</html>

