<metal:suggestions define-macro="translation-suggestions">
  <tal:comment replace="nothing">
  This macro expects the following variables defined:
      :pomsgset_view: An IPOMsgSet View.
      :submissions: A list of IPOSubmission objects.
  </tal:comment>
  <tal:block condition="submissions">
    <tr class="discreet secondary">
      <th colspan="3" style="border: inherit;">
        <label><metal:title define-slot="suggestion-title" />:</label>
      </th>
    </tr>
    <tal:submission repeat="submission submissions">
    <tr class="discreet secondary">
      <td colspan="3" />
      <td class="icon left right">
        <input type="image" src="/@@/copy" title="Copy text"
          tal:attributes="name string:copy_${pomsgset_view/potmsgset/id}_singular"
        />
      </td>
      <td>
          <div
            tal:define="submissionlang submission/pomsgset/pofile/language"
            tal:attributes="
              lang submissionlang/dashedcode;
              dir submissionlang/abbreviated_text_dir
            "
            tal:content=
              "structure submission/potranslation/translation/fmt:text-to-html"
            >suggestion</div>
      </td>
    </tr>
    <tr class="suggestion secondary">
      <th colspan="3" style="padding-bottom: 1em;">
        Coming from:
      </th>
      <td class="icon left right" />
      <td style="overflow: auto;">
        <a tal:content="submission/pomsgset/pofile/title"
           tal:attributes="href submission/pomsgset/fmt:url">
          Spanish translation for evolution
        </a> by
        <a tal:content="submission/person/browsername"
           tal:attributes="href submission/person/fmt:url">Foo Bar</a> on
        <span tal:content="submission/datecreated/fmt:date">
          2006-08-05 01:04 UTC
        </span>
      </td>
    </tr>
    </tal:submission>
  </tal:block>
</metal:suggestions>
<metal:pomsgset define-macro="pomsgset-view">
  <tal:comment replace="nothing">
  This macro expects the following variable defined:
      :pomsgset_view: An IPOMsgSet View.
  </tal:comment>
  <tr>
    <td style="text-align: right;">
      <span tal:replace="pomsgset_view/sequence">1</span>.
      <input
        type="hidden"
        tal:attributes="
        name string:msgset_${pomsgset_view/potmsgset/id}"
        />
    </td>
    <td>
      <a tal:attributes="href pomsgset_view/zoom_url">
        <img tal:attributes="
          alt pomsgset_view/zoom_alt;
          title pomsgset_view/zoom_alt;
          src pomsgset_view/zoom_icon;" /></a>
    </td>
    <th style="border-style: dotted; border-width: 1px 0 0;">
      <label class="language-code" tal:condition="not:pomsgset_view/is_plural">
        English:
      </label>
      <label class="language-code" tal:condition="pomsgset_view/is_plural">
        English singular:
      </label>
    </th>
    <td class="icon left right">
      <input type="image" src="/@@/copy" title="Copy text"
        tal:attributes="name string:copy_${pomsgset_view/potmsgset/id}_singular"
        />
    </td>
    <td tal:content="structure pomsgset_view/msgid">
      The original text.
    </td>
  </tr>
  <tr class="secondary" tal:condition="pomsgset_view/is_plural">
    <th colspan="3">
      <label>English plural:</label>
    </th>
    <td class="icon left right">
      <input type="image" src="/@@/copy" title="Copy text"
        tal:attributes="name string:copy_${pomsgset_view/potmsgset/id}_plural"
        />
    </td>
    <td tal:content="structure pomsgset_view/msgid_plural">
      plural source
    </td>
  </tr>
  <tr class="discreet secondary" tal:condition="pomsgset_view/msgid_has_tab">
    <td colspan="4" />
    <td>
      <img
        alt="Note:"
        src="/@@/info"
        title="This is a note to translators"
        />
      <code>[tab]</code> represents a tab character.
      Please write it exactly the same way, <code>[tab]</code>, in your
      translation.
    </td>
  </tr>
  <tr class="discreet secondary" tal:condition="pomsgset_view/source_comment">
    <td colspan="4" />
    <td>
      <img
        alt="Developer note:"
        src="/@@/info"
        title="This note was provided by the software developer."
        />
      <span
        tal:content="pomsgset_view/source_comment"
        tal:omit-tag="">
        This refers to the content type.
      </span>
    </td>
  </tr>
  <tr class="error" tal:condition="pomsgset_view/error">
    <td />
    <th colspan="2">
          <strong>Error in Translation:</strong>
    </th>
    <td colspan="3">
      <div>
          <span tal:replace="pomsgset_view/error" />
        </div>
    </td>
  </tr>
  <tal:language-code
    define="language_code pomsgset_view/pofile/language/code">
  <tal:plural-forms repeat="index pomsgset_view/translation_range">
    <tr class="secondary">
      <th colspan="3">
        <label class="language-code">Current
          <span tal:replace="pomsgset_view/pofile/language/englishname">
            Welsh
          </span><span tal:replace="string:[${index}]"
                       tal:condition="pomsgset_view/is_plural">[0]</span>:
        </label>
      </th>
      <td>
        <input type="image" src="/@@/copy" title="Copy text"
          tal:attributes="name string:msgset_${pomsgset_view/potmsgset/id}_${language_code}_translation_${index}_copy"
        />
      </td>
      <tal:with-content condition="python:pomsgset_view.getTranslation(index)">
        <td tal:content="structure python:pomsgset_view.getTranslation(index)">
          current translation
        </td>
      </tal:with-content>
      <tal:without-content
        condition="python:pomsgset_view.getTranslation(index) is None">
        <td>
          (no translation yet)
        </td>
      </tal:without-content>
    </tr>
    <tal:active
      define="active python:pomsgset_view.context.getActiveSubmission(index)"
      condition="active">
      <tr class="discreet secondary">
        <th colspan="3" style="padding-bottom: 1em;">
          Translated by:
        </th>
        <td class="icon left right" />
        <td style="overflow: auto;">
          <a tal:content="active/person/browsername"
             tal:attributes="href active/person/fmt:url">Foo Bar</a> on
          <span tal:content="active/datecreated/fmt:datetime">
            2006-08-05 01:04 UTC
          </span>
        </td>
      </tr>
    </tal:active>
    <tal:block
      define="submissions python:pomsgset_view.get_suggested_submissions(index)">
      <metal:submissions
        use-macro="submissions/@@+pomsgset-translate/translation-suggestions">
        <metal:fill metal:fill-slot="suggestion-title">Suggestions</metal:fill>
      </metal:submissions>
    </tal:block>
    <tal:block
      define="submissions python:pomsgset_view.get_current_submissions(index)">
      <metal:submissions
        use-macro="submissions/@@+pomsgset-translate/translation-suggestions">
        <metal:fill
          metal:fill-slot="suggestion-title">Used elsewhere</metal:fill>
      </metal:submissions>
    </tal:block>
    <tal:block
      define="submissions python:pomsgset_view.get_wiki_submissions(index)">
      <metal:submissions
        use-macro="submissions/@@+pomsgset-translate/translation-suggestions">
        <metal:fill
          metal:fill-slot="suggestion-title">Suggested elsewhere</metal:fill>
      </metal:submissions>
    </tal:block>
    <tal:block
      define="submissions
      python:pomsgset_view.get_alternate_language_submissions(index)">
      <metal:submissions
        use-macro="submissions/@@+pomsgset-translate/translation-suggestions">
        <metal:fill metal:fill-slot="suggestion-title"><span
          tal:replace="pomsgset_view/second_lang_pofile/language/englishname"
          /> (Alternate Language)</metal:fill>
      </metal:submissions>
    </tal:block>
    <tr class="discreet secondary">
      <th colspan="3">
        <label>New suggestion:</label>
      </th>
      <td>
        <input
          type="checkbox"
          tal:attributes="
            name string:msgset_${pomsgset_view/potmsgset/id}_${language_code}_translation_${index}_new_checkbox;
            " />
      </td>
      <td>
        <textarea
          style="width: 100%;"
          rows=6
          tal:attributes="
            name string:msgset_${pomsgset_view/potmsgset/id}_${language_code}_translation_${index}_new;
            lang pomsgset_view/pofile/language/dashedcode;
            dir pomsgset_view/pofile/language/abbreviated_text_dir;
            "></textarea>
      </td>
    </tr>
    </tal:plural-forms>
    <tr class="secondary">
      <td colspan="4" />
      <td>
        <div>
          <label class="fuzzy-checkbox">
            <input
              type="checkbox"
              value="fuzzy"
              tal:attributes="
                checked pomsgset_view/is_fuzzy;
                name string:msgset_${pomsgset_view/potmsgset/id}_${language_code}_needsreview;
                tabindex view/generateNextTabIndex
                " />
            <tal:block condition="not:pomsgset_view/is_plural">
              Someone should review this translation
            </tal:block>
            <tal:block condition="pomsgset_view/is_plural">
              Someone should review these translations
            </tal:block>
          </label>
        </div>
      </td>
    </tr>
    </tal:language-code>
  <tr tal:condition="pomsgset_view/comment" class="secondary">
    <th colspan="3"><label>Translator note:</label></th>
    <td />
    <td tal:content="pomsgset_view/comment">
      Translator comment.
    </td>
  </tr>
  <tr class="discreet secondary">
    <th colspan="3" style="padding-bottom: 1em;">
      Located in:
    </th>
    <td class="icon left right" />
    <td style="overflow: auto;" tal:content="pomsgset_view/file_references">
      ./plone_forms/discussion_reply_form.pt
    </td>
  </tr>
</metal:pomsgset>
