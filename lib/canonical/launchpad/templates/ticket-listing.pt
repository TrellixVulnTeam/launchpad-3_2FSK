<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="context/@@main_template_2col/master"
      i18n:domain="launchpad">

<body>

<metal:leftportlets fill-slot="portlets_one">
  <div tal:replace="structure context/@@+portlet-supportcontacts|nothing" />
  <div tal:replace="structure context/@@+portlet-details|nothing" />
  <div tal:condition="context/distribution|nothing"
       tal:replace="structure context/distribution/@@+portlet-supportcontacts" />
</metal:leftportlets>

<metal:css fill-slot="head_epilogue">
  <style type="text/css">
    div.inlined-widget {
      display: inline;
    }

    div.inlined-widget div {
      display: inline;
    }
  </style>
</metal:css>

<metal:heading fill-slot="pageheading">
  <h1 i18n:translate="" tal:content="view/pageheading">Support Requests</h1>
</metal:heading>

<div metal:fill-slot="main"
     tal:define="tickets view/searchResults">

  <div id="ticket-search-form">
    <form method="get" id="ticket-search-form" action=""
          tal:attributes="action request/URL">
      <tal:searchbox replace="structure view/widgets/search_text" />

      <tal:sort replace="structure view/widgets/sort" />

      <input tal:replace="structure view/search_action/render" />

      <label tal:condition="view/show_all_languages_checkbox"
              style="font-weight: normal">
        <input name="all_languages" value="1" type="checkbox"
                tal:attributes="checked python:request.form.get('all_languages') and 'checked' or ''" />
        <tal:label i18n:translate="">All Languages</tal:label>
      </label>

      <tal:status define="widget nocall:view/widgets/status|nothing"
                  condition="nocall: widget">
        <metal:widget use-macro="widget/@@launchpad_widget_macros/launchpad_widget_row" />
      </tal:status>

    </form>
  </div>

  <tal:no-results condition="not: tickets/batch">
    <p i18n:translate=""
       tal:content="view/empty_listing_message">
      No support requests.
    </p>
  </tal:no-results>

  <p class="informational message"
     tal:condition="not: view/all_languages_shown" i18n:translate="">
    Only support requests in
      <tal:languages i18n:name="languages">
        <tal:language_loop repeat="lang view/displayed_languages">
          <span tal:replace="lang/englishname"
            /><tal:comma condition="not: repeat/lang/end">,</tal:comma>
        </tal:language_loop>
      </tal:languages>
    are displayed. To see support requests in other languages, either
    <a href="/+editmylanguages">change your preferred</a> languages
    or select the &ldquo;All Languages&rdquo; option.
  </p>

  <tal:block condition="tickets/batch">
    <table class="listing" id="ticket-listing">
      <thead>
        <tr>
          <th colspan="3" i18n:translate="">Summary</th>
          <th i18n:translate="">Created</th>
          <th i18n:translate="">Submitter</th>
          <th tal:condition="view/displayTargetColumn"
              i18n:translate="">In</th>
          <th tal:condition="view/displaySourcePackageColumn"
              i18n:translate="">Source Package</th>
          <th i18n:translate="">Status</th>
        </tr>
      </thead>
      <tbody>
        <tr tal:repeat="ticket tickets/batch"
            tal:attributes="title ticket/description/fmt:shorten/300">
          <td class="icon right">
            <img alt="Open" title="Open" src="/@@/ticket"
                 tal:attributes="alt ticket/status/title;
                                 title ticket/status/title;" />
          </td>
          <td class="amount"
              tal:content="ticket/id"
              >42</td>
          <td class="ticket">
            <a href="#"
               tal:content="ticket/title"
               tal:attributes="href ticket/fmt:url">
              Firefox is too slow for my laptop
            </a>
          </td>
          <td tal:content="ticket/datecreated/fmt:date">2006-07-17</td>
          <td><img src="/@@/user" />
            <a tal:attributes="href string:${ticket/owner/fmt:url}/+tickets"
               tal:content="ticket/owner/browsername"
              >Foo Bar</a>
          </td>
          <td class="ticket-target"
              tal:condition="view/displayTargetColumn"
              ><a href="#"
                  tal:define="target ticket/target"
                  tal:attributes="href string:${target/fmt:url}/+tickets"
                  tal:content="target/displayname">Firefox</a></td>
          <td tal:condition="view/displaySourcePackageColumn"
              tal:content="structure python:view.formatSourcePackageName(ticket)"
              >mozilla-firefox</td>
          <td class="ticketstatus"
              tal:content="ticket/status/title"
              tal:attributes="class string:ticketstatus${ticket/status/name}"
              >Open</td>
        </tr>
      </tbody>
    </table>
    <div
      class="results"
      tal:content="structure tickets/@@+navigation-links-lower"
    />
  </tal:block>
</div>

<metal:help fill-slot="help">
  <p>This listing displays the support requests matching the selected
    criteria in this context (distribution, product, person, sourcepackage).
  </p>
  <p>The search criteria for the current listing can be modified directly at
    the top of the page.
  </p>
  <p>If you hover the mouse over a support request, the beginning of its
    description will pop-up after a few seconds.
  </p>
</metal:help>
</body>
</html>
