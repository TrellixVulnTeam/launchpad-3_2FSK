<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/tal/i18n"
      xml:lang="en" lang="en"
      metal:use-macro="context/@@main_template/master"
      i18n:domain="launchpad"
>
  <body>
    <metal:heading fill-slot="pageheading">
      <h1 tal:content="view/datestring">Time</h1>
    </metal:heading>

    <metal:leftportlets fill-slot="portlets_one">
      <div tal:replace="structure context/calendar/@@+portlet-subscriptions|nothing" />
    </metal:leftportlets>

    <div metal:fill-slot="main">

      <table class="cal-navigation">
        <tr>
          <td width="30%" align="left">
            <a tal:attributes="href context/prevRange/fmt:url">&#8592; Previous</a>
          </td>
          <td width="30%" align="center">
            <a href="../today">Today</a>
          </td>
          <td width="30%" align="right">
            <a tal:attributes="href context/nextRange/fmt:url">Next &#8594;</a>
          </td>
        </tr>
      </table>

      <div id="calendar-view-day"
           tal:attributes="style python:'height: ' + str(view.visiblehours * 4 + 1) + 'em'">
        <!-- Day grid -->
        <tal:loop repeat="hour view/getHours"
                  tal:define="height python:4">
          <metal:block tal:define="num repeat/hour/index;
                                 top python:num * height">
            <div class="calendar-hour"
                 tal:define="oddrow repeat/hour/odd"
                 tal:attributes="style python:'top: ' + str(top) + 'em';
                                 class python:oddrow and 'hour odd' or 'hour even'">
              <span tal:content="hour/title">08:00</span><br />
              <a href="../+add" class="cal-addlink"
                 tal:attributes="href hour/addURL">(add)</a>
            </div>
          </metal:block>
        </tal:loop>

        <!-- Events -->
        <div class="events">
        <tal:loop repeat="hour view/getHours"
                  tal:define="height python:4">
          <metal:block tal:define="num repeat/hour/index;
                                   top python:num * height">
            <tal:block repeat="event hour/cols">
              <tal:if condition="event">
                <div class="event"
                     onmouseover="this.style.zIndex=9;"
                     onmouseout="this.style.zIndex=1;"
                     tal:define="num repeat/event/index;
                                 compress python:view.getColumns() > 2;
                                 unit python:compress and '%' or 'em';
                                 indent python:compress and 15 or 20.5;
                                 evdate python:view.eventStartDate(event);
                                 colour python:view.eventColour(event);
                                 mine python:True"
                     tal:attributes="style python:'background: %s;; height: %sem !important;; margin-left: %s%s;; top: %sem' % (colour, view.eventHeight(event), str(num * indent), unit, view.eventTop(event));
                                 class python:mine and 'event' or 'event other';
                                 ">
                  <a tal:attributes="href event/fmt:url">
                  <span tal:replace="python:view.eventStart(event)">12:00</span>
                  -
                  <span tal:replace="event/title">Title</span>
                  </a>
                      
                </div>
              </tal:if>
            </tal:block>
          </metal:block>
        </tal:loop>
        </div>
      </div>
    </div>

  </body>
</html>
