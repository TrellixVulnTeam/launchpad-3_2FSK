<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  metal:use-macro="view/macro:page/main_only"
>
  <body>
    <tal:head_epilogue metal:fill-slot="head_epilogue">
      <style type="text/css">
        .inactive_links a{
          background: none;
        }
        .inactive_links a{
          color: lightgray;
        }
        .template_links a{
          padding-right: 1em;
        }
        td.sourcepackage_column, th.sourcepackage_column {
            width: 10em;
        }
        td.template_column, th.template_column {
            width: 14em;
        }
        td.actions_column, th.actions_column {
            width: 27em;
        }
      </style>
      <style tal:condition="view/is_distroseries" type="text/css">
        #templates_table {
            width: 81em;
        }
      </style>
      <style tal:condition="not:view/is_distroseries" type="text/css">
        #templates_table {
            width: 79em;
        }
      </style>
      <script language="JavaScript" type="text/javascript">
      LPS.use('node-base', 'event-delegate', function(Y) {
          Y.on('domready', function(e) {
              Y.all('#templates_table .template_links').addClass(
                    'inactive_links');
              Y.all('#templates_table .template_row').each(function(row) {
                  var template_links = row.one('.template_links');
                  row.on('mouseover', function(e) {
                      template_links.removeClass('inactive_links');
                  });
                  row.on('mouseout', function(e) {
                      template_links.addClass('inactive_links');
                  });
              });
          });
      });
      </script>
    </tal:head_epilogue>
    <div metal:fill-slot="main">
      <div class="translation-help-links">
        <a href="https://help.launchpad.net/Translations"
           id="link-to-translations-help"
           >Help for translations
        </a>
        <div></div><!-- to clear-up all floats -->
      </div>

      <div class="yui-b top-portlet">
        <p>
          This is a listing of all the translatable templates
          in <a tal:replace="structure context/fmt:link">here</a>.
        </p>
      </div>

      <div class="yui-b">
      <table class="sortable listing" id="templates_table">
        <thead>
          <tr>
            <th class="priority_column">Priority</th>
            <th tal:condition="view/is_distroseries"
                class="sourcepackage_column">Source package</th>
            <th class="template_column">Template name</th>
            <th class="length_column">Length</th>
            <th class="lastupdate_column">Updated</th>
            <th class="actions_column"
                tal:condition="context/required:launchpad.AnyPerson">
              Actions</th>
          </tr>
        </thead>
        <tbody>
          <tal:templates repeat="template view/iter_templates">
            <tr tal:define="
                  inactive_css_class python:view.rowCSSClass(template);
                  template_url template/fmt:url"
                tal:condition="python: view.can_edit or template.iscurrent"
                tal:attributes="
                  class string: template_row ${inactive_css_class}">
              <td class="priority_column"
                  tal:content="template/priority">7</td>
              <td tal:condition="view/is_distroseries"
                  tal:content="template/sourcepackagename/name"
                  class="sourcepackage_column">Source package
              </td>
              <td class="template_column">
                <a tal:attributes="href template_url">
                  <span tal:content="template/name">Template name</span>
                </a>
                <tal:inactive condition="not: template/iscurrent">
                  (inactive)
                </tal:inactive>
              </td>
              <td class="length_column"
                  tal:content="template/messagecount">1777</td>
              <td class="lastupdate_column">
                <span class="sortkey"
                      tal:condition="template/date_last_updated"
                      tal:content="template/date_last_updated/fmt:datetime">
                      time sort key
                </span>
                <span class="lastupdate_column"
                      tal:condition="template/date_last_updated"
                      tal:attributes="
                        title template/date_last_updated/fmt:datetime"
                      tal:content="
                        template/date_last_updated/fmt:approximatedate"
                >
                   2009-09-23
                </span>
              </td>
              <td class="actions_column"
                  tal:condition="context/required:launchpad.AnyPerson">
              <div class="template_links">
                <a class="sprite edit"
                    tal:condition="view/can_edit"
                    tal:attributes="
                        href string: ${template_url}/+edit">Edit</a>
                <a class="sprite add"
                    tal:condition="view/can_edit"
                    tal:attributes="
                        href string: ${template_url}/+upload">Upload</a>
                <a class="sprite download"
                    tal:attributes="
                        href string: ${template_url}/+export">Download</a>
                <a class="sprite edit"
                    tal:condition="view/can_admin"
                    tal:attributes="
                        href string: ${template_url}/+admin">Administer</a>
              </div>
              </td>
            </tr>
          </tal:templates>
        </tbody>
      </table>
      </div>
    </div>
  </body>
</html>
