<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  xml:lang="en"
  lang="en"
  dir="ltr"
  metal:use-macro="context/@@main_template/master"
  i18n:domain="launchpad"
  >
<body>

<metal:portlets fill-slot="portlets">
   <tal:portlet replace="structure context/distribution/@@+portlet-ppa-architectures" />
</metal:portlets>

<div metal:fill-slot="main">

  <h1>Delete packages from <tal:title replace="context/title" /></h1>

    <tal:inactive_ppa_header condition="not: view/has_published_sources">
      <p>This PPA does not contain any source packages published.</p>
    </tal:inactive_ppa_header>

  <div metal:use-macro="context/@@launchpad_form/form">

    <div class="form" metal:fill-slot="widgets"
         tal:condition="view/has_published_sources">

      <tal:search define="name_widget nocall:view/widgets/name_filter">
         <label tal:attributes="for name_widget/name"
         >Show only sources with name matching:</label>
         <input tal:replace="structure name_widget"/>
         <input
             tal:replace="structure view/actions/field.actions.update/render" />
      </tal:search>

      <tal:no_sources tal:condition="not:view/available_sources_size">
        <div id="empty-result" style="border: 1px solid;">
          <p>No matching source packages for '<tal:name_filter
             tal:replace="request/field.name_filter|nothing" />'.</p>
        </div>
      </tal:no_sources>

      <tal:sources condition="view/available_sources_size"
                   define="widget nocall:view/widgets/selected_sources;
                           field_name widget/context/__name__;
                           error python:view.getFieldError(field_name);">
        <table class="listing" style="margin-top: 1em;">
          <thead>
          <tr class="ppa_package_row">
            <th colspan="2">Source</th>
            <th tal:condition="context/owner/isTeam">Uploader</th>
            <th>Published</th>
            <th>Status</th>
            <th>Series</th>
            <th>Section</th>
          </tr>
          </thead>
          <tbody>
          <tal:terms tal:repeat="term widget/vocabulary">
            <tal:block
              define="pub term/value"
              replace="structure pub/@@+listing-ppa-detailed-selectable" />
          </tal:terms>
          </tbody>
          <tfoot tal:condition="view/has_undisplayed_sources">
             <tr>
               <td colspan="7" tal:condition="context/owner/isTeam">
                 <div>Presenting only <tal:presented replace="
                   view/max_sources_presented"/> of <tal:available replace="
                   view/available_sources_size" /> available sources.</div>
               </td>
               <td colspan="6" tal:condition="not: context/owner/isTeam">
                 <div>Presenting only <tal:presented replace="
                   view/max_sources_presented"/> of <tal:available replace="
                   view/available_sources_size" /> available sources.</div>
               </td>
             </tr>
          </tfoot>
        </table>
        <input tal:attributes="name string:${widget/name}-empty-marker"
               type="hidden" value="1" />
        <div class="error message" tal:condition="error"
             tal:content="structure error">Error message</div>
      </tal:sources>

      <tal:actions condition="view/available_sources_size"
                   define="widget nocall:view/widgets/deletion_comment;
                           field_name widget/context/__name__;
                           error python:view.getFieldError(field_name);">
        <p class="warning message"
          >Read the page help to understand how removals work.</p>
        <div style="margin-top: 1em;">
          <label tal:attributes="for widget/name"
                 tal:content="string:${widget/label}:">Label</label>
          <input tal:replace="structure widget" />
          <input tal:replace="structure
             view/actions/field.actions.delete/render" />
          <p class="formHelp" tal:condition="widget/hint"
             tal:content="widget/hint">Some Help Text</p>
        </div>
        <div class="error message" tal:condition="error"
             tal:content="structure error">Error message</div>
      </tal:actions>

   </div> <!-- widgets -->

   <div class="actions" metal:fill-slot="buttons">
   </div> <!--empties buttons section -->

  </div> <!-- launchpad_form -->

</div> <!--main -->

<div metal:fill-slot="help">
   <p>Search for the desired packages, then select one of more of them
     for deletion. A message is displayed below the list of packages
     if there were more than <tal:max_sources
     replace="view/max_sources_presented"/> packages found; you may
     want to refine your search if the packages you are interested in
     are not listed. A short text comment should be provided when
     deleting packages, it will be recorded and displayed when
     presenting the package information.</p>

   <p>The  deletion will affect the source selected and any binary
     built from it.<p>

   <p>The deleted packages will disappear from the archive  indexes
     within 20 minutes, so users won't be able to install it via apt,
     and the related files will be removed automatically from the
     archive disk only when all published references to it are also
     gone.</p>

   <p>Since the <i>archive-remover</i> only runs once a day for all
     PPAs, it may take 1 or 2 days (runs), depending on how long we
     have to wait for each reference to be removed, to remove the
     related files from disk. Published files can take a long time to
     be removed from the archive pool, because there might exist
     implicit references from other versions of the same package
     published in other suites.</p>

   <p>The best alternative to replace a broken source is always to
     upload a higher version and let the system automatically
     supersede and remove if from disk when it is time. You should not
     rely on deletion requests to re-upload the same source version
     with different contents.</p>
</div>

</body>
</html>
