<div xmlns="http://www.w3.org/1999/xhtml"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal">

    <style type="text/css">
        table {
            border: 1px solid black;
        }
        th {
            background: lightgray;
        }
        td {
            padding: 0 1em 0 1em;
        }
        .even td {
            background: #99cc00;
        }
    </style>
    <table tal:define="site_url view/feed/getSiteURL">
        <tr>
            <th>Affects</th>
            <th>Status</th>
            <th>Importance</th>
            <th>Assigned to</th>
        </tr>

        <!-- Bugtask -->
        <tr tal:repeat="bugtask context/bugtasks">
            <td tal:condition="bugtask/product">
                <img alt=""
                  tal:attributes="src string:${site_url}/@@/product" />
                <span tal:replace="bugtask/target/name">Fake BugTask Name</span>
            </td>

            <td style="padding: 0.3em 0em 0.3em 1.5em"
                tal:condition="not:bugtask/product">
                <img alt=""
                  tal:attributes="src string:${site_url}/@@/milestone" />
                <span tal:replace="bugtask/target/name">Fake BugTask Name</span>
            </td>
            <td tal:content="bugtask/status/title">Won't Fix</td>
            <td tal:content="bugtask/importance/title">Unknown</td>
            <td tal:content="bugtask/assignee/displayname|string:-">Person</td>
            <td tal:condition="bugtask/bugwatch">
            <a tal:attributes="href bugtask/bugwatch/url"
               tal:content="bugtask/bugwatch/title">bugwatch</a>
            </td>
        </tr>

        <!-- Nomination for series in above bugtask -->
        <tr tal:repeat="nomination context/getNominations">
            <td colspan="4" style="padding-left: 3em">Nominated for
                <span tal:replace="nomination/target/title">Trunk</span> by
                <a tal:replace="structure nomination/owner/fmt:link">
                Edwin Grubbs</a>
            </td>
        </tr>

    </table>
    <br/>
    <table style="border: 1px solid black">
        <tr><th>Duplicate of:</th>
            <td tal:condition="context/duplicateof">
                <a href="#"
                   tal:attributes="href context/duplicateof/fmt:url">
                        bug #
                    <span tal:replace="context/duplicateof/id">42</span></a>
            </td>
            <td tal:condition="not:context/duplicateof">-</td>
        </tr>

        <tr><th>Security Related:</th>
            <td tal:content="context/security_related">True</td>
        </tr>

        <tr><th>CVE:</th>
            <td><span tal:repeat="cve context/cves">
                    <img border="0" src="https://launchpad.net/@@/cve" />
                    <a tal:attributes="href cve/url"
                       tal:content="cve/sequence">cve</a>
                    <br/>
                </span>
            </td>

        <tr><th>Blueprints:</th>
            <td tal:condition="context/specifications">
                <span tal:repeat="spec context/specifications">
                    <span tal:replace="structure spec/@@+listing-compact">
                        Ubuntu
                    </span>
                </span>
            </td>
            <td tal:condition="not:context/specifications">-</td>
        </tr>

        <tr><th>Questions:</th>
            <td tal:condition="context/questions">
                <span tal:repeat="q context/questions">
                    <img src="http://launchpad.net/@@/question" />
                    <span tal:replace="q/target/displayname"></span>:
                    <a tal:attributes="href q/fmt:url" tal:content="q/title">
                        Question</a><br/>
                </span>
            </td>
            <td tal:condition="not:context/questions">-</td>
        </tr>

        <!-- This is duplicated here in addition to the Atom category,
                since not all feed readers display categories.
        -->
        <tr><th>Bug Tags:</th>
        <td><span tal:repeat="tag context/tags">
                <span tal:content="tag">oops</span>
            </span>
            <span tal:condition="not:context/tags">-</span>
        </td>
    </table>

    <!-- recent activity log entries -->
    <br/>
    <b>Activity Log:</b>
    <table>
        <tr>
            <th>Date</th>
            <th>Who</th>
            <th>What changed</th>
            <th>Old value</th>
            <th>New value</th>
            <th>Message</th>
        </tr>
        <tr tal:repeat="log context/activity">
            <td tal:content="python:log.datechanged.strftime('%d %b %y %H:%M')">
                17 Sep 07 14:31
            </td>
            <td tal:content="structure log/person/fmt:link">person</td>
            <td tal:content="log/whatchanged">what changed</td>
            <td tal:content="log/oldvalue">old value</td>
            <td tal:content="log/newvalue">new value</td>
            <td tal:content="log/message">message</td>
        </tr>
    </table>

    <!-- bug description. Duplicated here because several feed readers do not show
            the <entry><summary>
    -->
    <br/>
    <b>Description:</b>
      <hr/>
        <div tal:content="structure context/description/fmt:text-to-html" />
      <hr/>
      <br/>
    <b>Recent Comments:</b>
    <hr/>
        <div tal:repeat="comment view/getBugCommentsForDisplay">
            <tal:comment_has_owner>
                <tal:comment_owner replace="structure comment/owner/fmt:link" />
            </tal:comment_has_owner>
            wrote
            <span
            tal:attributes="title comment/datecreated/fmt:datetime"
            tal:content="comment/datecreated/fmt:displaydate">
            7 minutes ago
            </span>:
            <a tal:attributes="href comment/fmt:url">
            <strong tal:condition="comment/display_title"
                    tal:content="comment/title" />
            (permalink)
            </a>

        <div>
            <ul tal:condition="comment/bugattachments" style="margin-bottom: 1em">
            <li tal:repeat="attachment comment/bugattachments">
                <a tal:attributes="href attachment/libraryfile/http_url"
                tal:content="attachment/title">foo.txt</a>
                (<span
                tal:replace="attachment/libraryfile/content/filesize/fmt:bytes" />,
                <span tal:replace="attachment/libraryfile/mimetype" />)
            </li>
            </ul>

            <div style="font-family: monospace;"
            tal:content="structure
                comment/text_for_display/fmt:obfuscate-email/fmt:email-to-html">
            Comment text.
            </div>
      </div>
    <hr/>
</div>
