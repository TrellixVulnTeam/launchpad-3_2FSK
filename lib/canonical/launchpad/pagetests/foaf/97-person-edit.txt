== Changing personal details ==

Foo Bar wants to check if his personal information is up to date in
Launchpad.

    >>> browser.addHeader('Authorization', 'Basic foo.bar@canonical.com:test')
    >>> browser.open('http://launchpad.dev/~name16')
    >>> browser.getLink('Change details').click()

    >>> browser.getControl('Display Name').value
    'Foo Bar'
    >>> browser.getControl('Name', index=1).value
    'name16'
    >>> browser.getControl('Time zone').value
    ['Africa/Johannesburg']
    >>> browser.getControl(
    ...     'Hide my email addresses from other Launchpad users').selected
    False


He noticed that his information is out of date and will update it.
(If he leaves leading or trailing whitespace in the displayname it'll
be stripped)

    >>> browser.getControl('Name', index=1).value = 'foobar'
    >>> browser.getControl('Display Name').value = '  Foo Bar2  '
    >>> browser.getControl(
    ...     'Hide my email addresses from other Launchpad users').click()
    >>> browser.getControl('Save').click()

    >>> browser.url
    'http://launchpad.dev/~foobar'

Now we check to make sure the displayname was changed and stripped.

    >>> browser.open('http://launchpad.dev/~foobar/+edit')
    >>> browser.getControl('Display Name').value
    'Foo Bar2'

And the email addresses are not shown on Foo Bar's home page to any random
user.

    >>> user_browser.open('http://launchpad.dev/~foobar')
    >>> 'foo.bar@canonical.com' in user_browser.contents
    False

He will decide to make all bug notifications that are sent to him
verbose.

    >>> browser.getControl("Include bug descriptions when sending me "
    ...     "bug notifications").selected
    False

    >>> browser.getControl("Include bug descriptions when sending me "
    ...     "bug notifications").click()
    >>> browser.getControl('Save').click()

    >>> browser.url
    'http://launchpad.dev/~foobar'

We now check to ensure that the verbose bug notifications option was
changed:

    >>> browser.open('http://launchpad.dev/~foobar/+edit')
    >>> browser.getControl("Include bug descriptions when sending me "
    ...     "bug notifications").selected
    True

He will also change his timezone:

    >>> browser.getControl('Time zone').value = ['Africa/Dakar']
    >>> browser.getControl('Save').click()

    >>> browser.url
    'http://launchpad.dev/~foobar'

    >>> browser.getLink('Change details').click()
    >>> browser.getControl('Time zone').value
    ['Africa/Dakar']

Selecting a time zone that is not supported by the tzdata package
will raise an error.

    >>> from canonical.launchpad.vocabularies import timezones
    >>> from zope.schema.vocabulary import SimpleVocabulary
    >>> real_timezone_vocab = timezones._timezone_vocab
    >>> timezones._timezone_vocab = SimpleVocabulary.fromValues(['asdf'])
    >>> browser.open('http://launchpad.dev/~foobar/+edit')
    >>> browser.getControl('Time zone').options
    ['asdf']
    >>> browser.getControl('Save').click()
    >>> for tag in find_tags_by_class(browser.contents, 'error'):
    ...     print tag.renderContents().strip()
    There is 1 error.
    ...Invalid time zone...
    >>> timezones._timezone_vocab = real_timezone_vocab
