  Accessing /shipit while you're already logged in (with a non-shipit-admin
  user) will redirect you to your request page.

  >>> print http(r"""
  ... GET /shipit/++vh++http:shipit.async.com.br:80/++/ HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... """)
  HTTP/1.1 303 See Other
  ...
  Location: myrequest
  ...


  If you don't have a request that wasn't exported yet, you can place a new
  one.

  >>> print http(r"""
  ... GET /shipit/++vh++http:shipit.async.com.br:80/++/myrequest HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... """)
  HTTP/1.1 200 Ok
  ...
  ...Logged in as Sample Person...
  ...
  ...<h1>How many CDs would you like?</h1> ...
  ...
  ...<h2>Request Details</h2>...
  ...
  ...<h1>Shipping Address</h1>...
  ...


  Trying to place a new request without providing the shipping details is not
  possible.

  >>> print http(r"""
  ... POST /shipit/++vh++http:shipit.async.com.br:80/++/myrequest HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... Content-Type: application/x-www-form-urlencoded
  ... recipientdisplayname=Some+Name&ordertype=standard&standardrequest=3&organization=&addressline1=&addressline2=&city=&province=&postcode=&field.country=&field.country-empty-marker=1&phone=&newrequest=Request+CDs""")
  HTTP/1.1 200 Ok
  ...
  ...There were errors in your request...
  ...<option selected="selected" value="3"...
  ...You must choose your country from the list below...
  ...You must enter your city in the form...
  ...You must enter an address...
  ...


  If you successfully place a standard request, you'll see that it's
  automatically approved.

  >>> print http(r"""
  ... POST /shipit/++vh++http:shipit.async.com.br:80/++/myrequest HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... Content-Type: application/x-www-form-urlencoded
  ... 
  ... recipientdisplayname=Some+Name&ordertype=standard&standardrequest=3&organization=&addressline1=some+street&addressline2=somewhere&city=Any+city&province=&postcode=&field.country=15&field.country-empty-marker=1&phone=&newrequest=Request+CDs""")
  HTTP/1.1 200 Ok
  ...
  ...<h1>Your current ShipIt request</h1>...
  ...Status:...
  ...Approved...
  ...<h2>Change Request Details</h2>...
  ...


  Now try to change it to a custom request, with a negative number of CDs and
  without a reason.

  >>> print http(r"""
  ... POST /shipit/++vh++http:shipit.async.com.br:80/++/myrequest HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... Content-Type: application/x-www-form-urlencoded
  ... 
  ... recipientdisplayname=Some+Name&ordertype=custom&quantityx86=12&quantityamd64=1&quantityppc=-1&reason=&organization=&addressline1=some+street&addressline2=somewhere&city=Any+city&province=&postcode=&field.country=15&field.country-empty-marker=1&phone=&changerequest=Change+Request+Details""")
  HTTP/1.1 200 Ok
  ...
  ...There were errors in your request...
  ...
  ...You requested a negative number of CDs, which doesn't make sense...
  ...You've chosen to make a custom request. Please provide a reason...
  ...


  Now place a custom request properly, with all required fields, and check
  that it's now marked as waiting for approval.

  >>> print http(r"""
  ... POST /shipit/++vh++http:shipit.async.com.br:80/++/myrequest HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... Content-Type: application/x-www-form-urlencoded
  ... 
  ... recipientdisplayname=Some+Name&ordertype=custom&quantityx86=72&quantityamd64=9&quantityppc=9&reason=no+reason&organization=&addressline1=some+street&addressline2=somewhere&city=Any+city&province=&postcode=&field.country=15&field.country-empty-marker=1&phone=&changerequest=Change+Request+Details""")
  HTTP/1.1 200 Ok
  ...
  ...<h1>Your current ShipIt request</h1>...
  ...Status:...
  ...Waiting for approval...
  ...
  
  Whenever a new custom request is placed (or when a standard request is
  changed into a custom one), an email is sent to info@shipit.ubuntu.com.

  >>> import email, re
  >>> from canonical.launchpad.mail import stub
  >>> from_addr, to_addrs, raw_msg = stub.test_emails.pop()
  >>> to_addrs
  ['info@shipit.ubuntu.com']


  Change the request from custom to standard.
  
  >>> print http(r"""
  ... POST /shipit/++vh++http:shipit.async.com.br:80/++/myrequest HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... Content-Type: application/x-www-form-urlencoded
  ... 
  ... recipientdisplayname=Some+Name&ordertype=standard&standardrequest=3&organization=&addressline1=some+street&addressline2=somewhere&city=Any+city&province=&postcode=&field.country=15&field.country-empty-marker=1&phone=&changerequest=Change+Request+Details""")
  HTTP/1.1 200 Ok
  ...
  ...<h1>Your current ShipIt request</h1>...
  ...Status:...
  ...Approved...
  ...<h2>Change Request Details</h2>...
  ...


  Now, cancel the existing request and get the option to place a new one.

  >>> print http(r"""
  ... POST /shipit/++vh++http:shipit.async.com.br:80/++/myrequest HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... Content-Type: application/x-www-form-urlencoded
  ... 
  ... cancelrequest=Cancel+Request""")
  HTTP/1.1 200 Ok
  ...
  ...<h1>How many CDs would you like?</h1>...
  ...
  ...<input type="submit" value="Request CDs" name="newrequest"...


  ShipIt admins can place as many orders as they want, each one with a
  different address, if they want to.

  First we place an order for Steve Jobs.

  >>> print http(r"""
  ... POST /shipit/++vh++http:shipit.async.com.br:80/++/myrequest HTTP/1.1
  ... Authorization: Basic bWFyaWxpemVAaGJkLmNvbTp0ZXN0
  ... Content-Type: application/x-www-form-urlencoded
  ... 
  ... ordertype=custom&quantityx86=12&quantityamd64=25&quantityppc=0&reason=Apple+will+stop+using+PPC%2C+right%3F+Let%27s+send+them+some+Ubuntu+CDs+and+maybe+they%27ll+give+up+on+this+Mac+OS+X+thing+too.&recipientdisplayname=Steve+Jobs&organization=&addressline1=Somewhere&addressline2=between+heaven+and+hell&city=New+Orleans&province=&postcode=1234546&field.country=226&field.country-empty-marker=1&phone=&order=&newrequest=Request+CDs""")
  HTTP/1.1 200 Ok
  ...
  ...<h1>Your current ShipIt request</h1>...
  ...
  ...<th>Name:</th>...
  ...Steve Jobs...
  ...


  And now an order for the Tooth Fairy.

  >>> print http(r"""
  ... POST /shipit/++vh++http:shipit.async.com.br:80/++/myrequest HTTP/1.1
  ... Authorization: Basic bWFyaWxpemVAaGJkLmNvbTp0ZXN0
  ... Content-Type: application/x-www-form-urlencoded
  ... 
  ... ordertype=custom&quantityx86=2&quantityamd64=5&quantityppc=8&reason=Foo+Bar.&recipientdisplayname=Tooth+Fairy&organization=&addressline1=Somewhere&addressline2=between+heaven+and+hell&city=New+Orleans&province=&postcode=1234546&field.country=226&field.country-empty-marker=1&phone=&order=&newrequest=Request+CDs""")
  HTTP/1.1 200 Ok
  ...
  ...<h1>Your current ShipIt request</h1>...
  ...
  ...<th>Name:</th>...
  ...Tooth Fairy...
  ...


  ShipIt admins can also edit the shipping details of any existing orders.

  >>> print http(r"""
  ... GET /shipit/++vh++http:shipit.async.com.br:80/++/myrequest?order=4 HTTP/1.1
  ... Authorization: Basic bWFyaWxpemVAaGJkLmNvbTp0ZXN0
  ... """)
  HTTP/1.1 200 Ok
  ...
  ...Logged in as Marilize Coetzee...
  ...<th>Address:</th>...
  ...Somewhere...
  ...


  >>> print http(r"""
  ... POST /shipit/++vh++http:shipit.async.com.br:80/++/myrequest?order=4 HTTP/1.1
  ... Authorization: Basic bWFyaWxpemVAaGJkLmNvbTp0ZXN0
  ... Content-Type: application/x-www-form-urlencoded
  ... recipientdisplayname=Robert+Collins&organization=Something&addressline1=whatever&addressline2=between+heaven+and+hell&city=whatever&province=not+mandatory&postcode=999432423&field.country=45&field.country-empty-marker=1&phone=%2B55+16+3374-2027&order=4&changerequest=Change+Request+Details""")
  HTTP/1.1 200 Ok
  ...
  ...Logged in as Marilize Coetzee...
  ...whatever...
  ...


  But it's not possible to edit an order that was cancelled.

  >>> print http(r"""
  ... GET /shipit/++vh++http:shipit.async.com.br:80/++/myrequest?order=6 HTTP/1.1
  ... Authorization: Basic bWFyaWxpemVAaGJkLmNvbTp0ZXN0
  ... """)
  HTTP/1.1 200 Ok
  ...
  ...<h1>This order was cancelled</h1>...
