<div
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  omit-tag="">

  <!-- one way to hook in a script with an onload function-->
  <metal:load-javascript define-macro="check_lp_links"
    tal:define="
        revno modules/canonical.launchpad.versioninfo/revno | string:unknown;
        icingroot string:/+icing/rev${revno};
        lp_js string:${icingroot}/build"
  >
    <script type="text/javascript"
        tal:attributes="src string:${lp_js}/app/lp-linkchecker.js">
    </script>

    <!-- and another way to hook in some callbacks -->
    <tal:script
    replace="structure
    string:&lt;script id='linkchecker-script' type='text/javascript'&gt;" />
    <!--
    LPS.use('io-base', 'lp.app.linkchecker', function(Y) {

    if(Y.UA.ie) {
        return;
    }

    Y.on('load', function() {
        Y.lp.app.linkchecker.hello("from onload 1");
    });

    Y.on('domready', function() {
        Y.lp.app.linkchecker.hello("from domready");
    });

    });
    -->
    <tal:script replace="structure string:&lt;/script&gt;" />

  </metal:load-javascript>

</div>