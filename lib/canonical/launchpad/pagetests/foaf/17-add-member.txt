= Adding members to a team =

Any administrator of a team can add new members to that team.

    >>> browser.addHeader('Authorization', 'Basic foo@baz.com:f')
    >>> browser.open('http://launchpad.dev/~myemail')
    >>> browser.getLink('Add member').click()
    >>> browser.url
    'http://launchpad.dev/~myemail/+addmember'
    >>> browser.getControl('New member').value = 'cprov'
    >>> browser.getControl('Add').click()

    >>> for tag in find_tags_by_class(browser.contents,
    ...                               'informational message'):
    ...     print tag.renderContents()
    Celso Providelo (cprov) was added as a member of my own team.


Let's make sure that 'cprov' is now an Approved member of 'myemail'

    >>> from canonical.launchpad.database import Person, TeamMembership
    >>> cprov = Person.byName('cprov')
    >>> team = Person.byName('myemail')
    >>> tm = TeamMembership.selectOneBy(personID=cprov.id, teamID=team.id)
    >>> tm.statusname
    'Approved'
    >>> cprov.inTeam(team)
    True

If the new member is already an approved member of that team, we'll say that.

    >>> browser.url
    'http://launchpad.dev/%7Emyemail/+addmember?added=28'
    >>> browser.getControl('New member').value = 'cprov'
    >>> browser.getControl('Add').click()

    >>> for tag in find_tags_by_class(browser.contents, 'error message'):
    ...     print tag.renderContents()
    Celso Providelo (cprov) is already a member of my own team.


On the other hand, if the member is among the inactive/proposed members of
the team, we'll simply change the membership's status and say that it was
successfully added.

    # Ideally we should do this using the web UI, but doing it this way is a
    # lot simpler.
    >>> from canonical.lp.dbschema import TeamMembershipStatus
    >>> tm = TeamMembership.selectOneBy(personID=cprov.id, teamID=team.id)
    >>> tm.setStatus(TeamMembershipStatus.DEACTIVATED, team.teamowner)
    >>> tm.syncUpdate()

    >>> browser.url
    'http://launchpad.dev/%7Emyemail/+addmember?notadded=28'
    >>> browser.getControl('New member').value = 'cprov'
    >>> browser.getControl('Add').click()

    >>> for tag in find_tags_by_class(browser.contents,
    ...                               'informational message'):
    ...     print tag.renderContents()
    Celso Providelo (cprov) was added as a member of my own team.

