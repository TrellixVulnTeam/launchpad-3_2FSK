<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="context/@@main_template/master"
      i18n:domain="launchpad"
>

<body>

<metal:leftportlets fill-slot="portlets_one">
  <div tal:replace="structure context/distribution/@@+portlet-details" />
</metal:leftportlets>

<metal:rightportlets fill-slot="portlets_two">
  <div tal:replace="structure context/@@+portlet-details" />
</metal:rightportlets>

<metal:heading fill-slot="pageheading">
  <h1>
    <tal:distro replace="context/distribution/displayname">Ubuntu
    Linux</tal:distro>
    mirror "<tal:mirror replace="context/name">foobar</tal:mirror>"
  </h1>
</metal:heading>

<div metal:fill-slot="main">

    <div class="highlighted" style="font-size: 80%;"
         tal:condition="context/description">
      <p tal:replace="structure context/description/fmt:text-to-html">
          Distribution Mirror Description
      </p>
    </div>

    <h2>Mirror URLs</h2>

    <ul class="webref">
      <li tal:condition="context/http_base_url" >
        Web: <a tal:content="context/http_base_url"
                 tal:attributes="href context/http_base_url">http://url/</a>
      </li>
      <li tal:condition="context/ftp_base_url" >
        FTP: <a tal:content="context/ftp_base_url"
                tal:attributes="href context/ftp_base_url">ftp://url/</a>
      </li>
      <li tal:condition="context/rsync_base_url" >
        Rsync: <a tal:content="context/rsync_base_url"
                  tal:attributes="href context/rsync_base_url">
                  rsync://url/</a>
      </li>
    </ul>

    <tal:last-probe define="probe context/last_probe_record">
      <h2>Last probe</h2>

      <tal:no-last-probe condition="not: probe">
        <p tal:condition="context/isOfficial">
          <span tal:condition="context/http_base_url">
            This mirror has never been verified.
          </span>
          <span tal:condition="not: context/http_base_url"
                class="informational message">
            This mirror can't be verified because it doesn't have an HTTP base
            URL.
          </span>
        </p>

        <p tal:condition="not: context/isOfficial">
          This mirror is an unofficial 
          <span tal:replace="context/distribution/title">Ubuntu</span> mirror,
          and will not be verified.
        </p>
      </tal:no-last-probe>

      <tal:has-last-probe condition="probe">
        <p>This mirror was last probed in 
          <span tal:replace="probe/date_created/fmt:date" />.

          <tal:is-owner condition="context/required:launchpad.Edit">
            You can see the 
            <a tal:attributes="href probe/log_file/url">log file</a> of the
            probe.
          </tal:is-owner>
        </p>
      </tal:has-last-probe>
    </tal:last-probe>

    <tal:has-last-probe condition="context/last_probe_record">
      <tal:comment condition="nothing">
        XXX: This use of "python:" here is to workaround
        https://launchpad.net/products/launchpad/+bug/5768
      </tal:comment>
      <tal:archive-mirror condition="python: context.content.name == 'ARCHIVE'"
        define="arch_releases view/getSummarizedMirroredArchReleases;
                source_releases view/getSummarizedMirroredSourceReleases">
        <metal:mirror-content
          use-macro="context/@@+distributionmirror-macros/archive-mirror-content" />
      </tal:archive-mirror>

      <tal:release-mirror condition="python: context.content.name == 'RELEASE'"
        define="flavours_by_releases view/getCDImageMirroredFlavoursByRelease">
        <metal:mirror-content
          use-macro="context/@@+distributionmirror-macros/release-mirror-content" />
      </tal:release-mirror>
    </tal:has-last-probe>

</div>

</body>
</html>

