= Code import results =

Information about the last ten import runs for a code import are shown
on the branch index page with the other code import details.

    >>> login(ANONYMOUS)
    >>> from canonical.launchpad.testing.codeimporthelpers import (
    ...     make_all_result_types)
    >>> code_import = factory.makeCodeImport()

The make_all_result_types helper method adds a code import result of
each possible status value.

    >>> make_all_result_types(code_import, factory)
    >>> branch_url = canonical_url(code_import.branch)
    >>> logout()

For each import result, the start date and finish date is shown along
with the duration.  A link to the log file is shown if there was a log
file stored with the result.

    >>> browser.open(branch_url)
    >>> import_results = find_tag_by_id(browser.contents, 'import-results')
    >>> print extract_text(import_results).replace('&mdash;', '--')
    Import started on 2007-12-09 on machine-... and finished on 2007-12-09
      taking nine hours -- see the log
    Import started on 2007-12-08 on machine-... and finished on 2007-12-08
      taking eight hours -- see the log
    Import started on 2007-12-07 on machine-... and finished on 2007-12-07
      taking seven hours -- see the log
    Import started on 2007-12-06 on machine-... and finished on 2007-12-06
      taking six hours -- see the log
    Import started on 2007-12-05 on machine-... and finished on 2007-12-05
      taking five hours -- see the log
    Import started on 2007-12-04 on machine-... and finished on 2007-12-04
      taking four hours -- see the log
    Import started on 2007-12-03 on machine-... and finished on 2007-12-03
      taking three hours -- see the log
    Import started on 2007-12-02 on machine-... and finished on 2007-12-02
      taking two hours -- see the log
    Import started on 2007-12-01 on machine-... and finished on 2007-12-01
      taking an hour -- see the log

Each of the lines is prefixed with a tick if the result status was
success, or a cross if the status was a failure.  The title of the image
is the text of the failure type.

    >>> for img in import_results.fetch('img'):
    ...     print img
    <img src="/@@/no" title="Job killed" />
    <img src="/@@/no" title="Job reclaimed" />
    <img src="/@@/no" title="Bazaar Update Failed" />
    <img src="/@@/no" title="Source Update Failed" />
    <img src="/@@/no" title="Bazaar Import Failed" />
    <img src="/@@/no" title="Source Checkout Failed" />
    <img src="/@@/no" title="Internal Failure" />
    <img src="/@@/no" title="Failure" />
    <img src="/@@/yes" title="Success" />
