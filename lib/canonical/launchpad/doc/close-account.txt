We have a command line script that can be used to close accounts.

Unfortunately, we have no way of detecting schema updates containing new
information that needs to be removed or sanitized on account closure apart
from reviewers noticing and prompting developers to update this script.

See Bug #120506 for more details.


>>> import os.path, subprocess
>>> from canonical.config import config
>>> script = os.path.join(config.root, 'scripts', 'close-account.py')
>>> proc = subprocess.Popen(
...     [script, 'mark@hbd.com'],
...     stdout=subprocess.PIPE, stderr=subprocess.STDOUT)
>>> out, err = proc.communicate()
>>> print out
INFO...Closing sabdfl's account

>>> from canonical.testing import DatabaseLayer
>>> DatabaseLayer.force_dirty_database()

