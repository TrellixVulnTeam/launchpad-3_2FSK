<tal:root
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  omit-tag="">

<metal:commit-text define-macro="commit-text">

  <tal:comment condition="nothing">
    This macro requires the following defined variable:
      commit_info - a dict of the commit information (sha1, author,
                    author_date, commit_message) to be displayed.

    It is expected that this macro is called from within a definition list
    (<dl></dl>).
  </tal:comment>
  <dt class="commit-details"
      tal:define="
        sha1 python:commit_info['sha1'];
        author python:commit_info['author'];
        author_date python:commit_info['author_date']">
   <a tal:attributes="href string:${context/repository/getCodebrowseUrl}/commit/?id=${sha1}">
     <tal:sha1 replace="sha1/fmt:shorten/10" />
   </a>
    by
    <tal:known-person condition="author/person">
      <tal:person-link replace="structure author/person/fmt:link" />
    </tal:known-person>
    <tal:unknown-person condition="not: author/person">
      <strong tal:content="author/name/fmt:obfuscate-email" />
    </tal:unknown-person>
    <span tal:attributes="title author_date/fmt:datetime"
          tal:content="author_date/fmt:displaydate" />
  </dt>
  <dd class="subordinate commit-message"
      tal:define="commit_message python:commit_info['commit_message']">
    <tal:commit-message
      replace="structure commit_message/fmt:obfuscate-email/fmt:text-to-html" />
  </dd>

</metal:commit-text>

<metal:no-commit-message define-macro="no-commit-message">
  This branch has not been scanned yet.
</metal:no-commit-message>

</tal:root>
