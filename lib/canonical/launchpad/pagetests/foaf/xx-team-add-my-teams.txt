= Propose/add your teams as member of another one =

Any team administrator is allowed to propose/add (depending on the
subscription policy) their teams as members of another team.

This is done from the +add-my-teams page, which is linked from a team's
home page.

    >>> browser = setupBrowser(auth='Basic salgado@ubuntu.com:zeca')
    >>> browser.open('http://launchpad.dev/~ubuntu-team')
    >>> browser.getLink('Add one of my teams').click()
    >>> browser.title
    'Propose/add one of your teams to another one'

For moderated teams, it's only possible to propose another team as a member.
The proposal will have to be reviewed by a team administrator.

    >>> print extract_text(find_tag_by_id(browser.contents, 'maincontent'))
    Propose these teams as members
    This is a moderated team, so one of its administrators will have
    to review any memberships you propose.
    Launchpad Administrators
    Mailing List Experts
    Rosetta Administrators
    ...

We'll now propose Launchpad Administrators as a member of Ubuntu Team.

    >>> browser.getControl(name='field.teams').value = ['admins']
    >>> browser.getControl('Continue').click()
    >>> browser.title
    'Ubuntu Team in Launchpad'
    >>> print get_feedback_messages(browser.contents)
    [u'Launchpad Administrators has been proposed to this team.']
    >>> print extract_text(
    ...     find_tag_by_id(browser.contents, 'recently-applied'))
    Recently applied:
    Launchpad Administrators (admins)
    ...

If it were an OPEN team, we'd be able to directly add any of our teams as
members.

    >>> admin_browser.open('http://launchpad.dev/~ubuntu-team/+edit')
    >>> admin_browser.getControl(
    ...     name='field.subscriptionpolicy').displayValue = ['Open Team']
    >>> admin_browser.getControl('Save').click()
    >>> admin_browser.title
    'Ubuntu Team in Launchpad'

    >>> browser.open('http://launchpad.dev/~ubuntu-team/+add-my-teams')
    >>> browser.getControl(name='field.teams').value = ['rosetta-admins']
    >>> browser.getControl('Continue').click()
    >>> browser.title
    'Ubuntu Team in Launchpad'
    >>> print get_feedback_messages(browser.contents)
    [u'Rosetta Administrators has been added to this team.']
    >>> print extract_text(
    ...     find_tag_by_id(browser.contents, 'recently-approved'))
    Recently approved:
    Rosetta Administrators (rosetta-admins)
    ...

In the case of restricted teams, though, there is no way to propose any of
your teams as members.

    >>> admin_browser.open('http://launchpad.dev/~ubuntu-team/+edit')
    >>> admin_browser.getControl(
    ...     name='field.subscriptionpolicy').displayValue = ['Restricted Team']
    >>> admin_browser.getControl('Save').click()
    >>> admin_browser.title
    'Ubuntu Team in Launchpad'

    >>> browser.open('http://launchpad.dev/~ubuntu-team/+add-my-teams')
    >>> print extract_text(find_tag_by_id(browser.contents, 'maincontent'))
    This is a restricted team
    New members can not be proposed&mdash;they can only be added by one
    of the team's administrators.

The page is restricted to logged in users.

    >>> anon_browser.open('http://launchpad.dev/~ubuntu-team/+add-my-teams')
    Traceback (most recent call last):
    Unauthorized:...

You also can't propose a team to itself. Here although Salgado is usually
allowed to propose Launchpad Administrators in other team, it doesn't
appear in the list when proposing a team for the Launchpad
Administrators team. Likewise Mailing List Experts isn't shown because
the Launchpad Administrators are a member of Mailing List Experts.
Adding Mailing List Experts would create a cycle.

    >>> browser.open('http://launchpad.dev/~admins/+add-my-teams')
    >>> browser.getControl(name='field.teams').options
    ['rosetta-admins']

Teams that are already member of the team can't be proposed or added.
For example, Rosetta Administrators is not in the list of choices
anymore of the Ubuntu Team:

    >>> admin_browser.open('http://launchpad.dev/~ubuntu-team/+edit')
    >>> admin_browser.getControl(
    ...     name='field.subscriptionpolicy').displayValue = ['Open']
    >>> admin_browser.getControl('Save').click()

    >>> browser.open('http://launchpad.dev/~ubuntu-team/+add-my-teams')
    >>> browser.getControl(name='field.teams').options
    ['admins', 'mailing-list-experts']
    >>> browser.getControl(name='field.teams').value = [
    ...     'admins', 'mailing-list-experts']
    >>> browser.getControl('Continue').click()
    >>> print "\n".join(get_feedback_messages(browser.contents))
    Launchpad Administrators, Mailing List Experts have been added to this
    team.

And when no teams can be added, a message is displayed:

    >>> browser.open('http://launchpad.dev/~ubuntu-team/+add-my-teams')
    >>> print extract_text(find_main_content(browser.contents))
    None of the teams you administer can be added to this team.

