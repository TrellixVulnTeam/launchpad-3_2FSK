When filing a private security bug upstream, with no upstream bug
contact, the maintainer will be subscribed to the bug instead.

    >>> browser.addHeader("Authorization", "Basic foo.bar@canonical.com:test")
    >>> browser.open("http://localhost:9000/products/firefox/+filebug")

    >>> print browser.contents
    <!DOCTYPE...
    ...The maintainer of...Mozilla Firefox...Sample Person...will be notified...
    ...

    >>> browser.getControl(name="field.title").value = (
    ...     "this is a private bug")
    >>> browser.getControl(name="field.comment").value = (
    ...     "very secret info here")
    >>> browser.getControl(
    ...     "This bug is a security vulnerability").selected = True

    >>> browser.getControl("Submit Bug Report").click()

    >>> print browser.url
    http://localhost:9000/products/firefox/+bug/11

Now the reporter and the maintainer are subscribed.

    >>> from zope.component import getUtility

    >>> from canonical.launchpad.ftests import login, logout
    >>> from canonical.launchpad.interfaces import IBugSet

    >>> login("foo.bar@canonical.com")

    >>> bug = getUtility(IBugSet).get(11)

    >>> sorted(subscriber.name for subscriber in bug.getDirectSubscribers())
    [u'name12', u'name16']

    >>> logout()

Of course, we're able to see the private bug we've just filed in the
bug listing.

    >>> browser.open("http://localhost:9000/products/firefox/+bugs")
    >>> print browser.contents
    <!DOCTYPE...
    ...
    ...Mozilla Firefox...
    ...
    ...4 results...
    ...
    ...5...
    ...Critical...
    ...
    ...4...
    ...Medium...
    ...
    ...1...
    ...Low...
    ...
    ...11...
    ...Undecided...

When the upstream has a security contact, the upstream will be
subscribed instead.

    >>> browser.open("http://launchpad.dev/products/firefox/+securitycontact")

    >>> browser.getControl("Security Contact").value = "sabdfl"
    >>> browser.getControl("Change").click()

    >>> browser.open("http://localhost:9000/products/firefox/+filebug")

    >>> print browser.contents
    <!DOCTYPE...
    ...The security contact for...Mozilla Firefox...Mark Shuttleworth...will be notified...
    ...

    >>> browser.getControl(name="field.title").value = (
    ...     "this is a private bug")
    >>> browser.getControl(name="field.comment").value = (
    ...     "very secret info here")
    >>> browser.getControl(
    ...     "This bug is a security vulnerability").selected = True

    >>> browser.getControl("Submit Bug Report").click()

    >>> print browser.url
    http://localhost:9000/products/firefox/+bug/12

    >>> login("foo.bar@canonical.com")

    >>> bug = getUtility(IBugSet).get(12)

    >>> sorted(subscriber.name for subscriber in bug.getDirectSubscribers())
    [u'name16', u'sabdfl']

    >>> logout()
