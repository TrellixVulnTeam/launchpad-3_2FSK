<metal:block define-macro="sortwidget_label">
  <label for="orderby">Sorted by:</label>
</metal:block>

<metal:block define-macro="sortwidget">
  <tal:comment condition="nothing">
    This macro expects that the callsite's view class has a shouldShowTargetName
    method.
  </tal:comment>
  <select name="orderby" id="orderby" size="1"
          tal:define="orderby request/orderby|string:-importance">
    <option
      value="-importance"
      tal:attributes="selected python:orderby == '-importance'"
    >by importance</option>
    <option
      value="status"
      tal:attributes="selected python:orderby == 'status'"
    >by status</option>
    <option
      value="milestone"
      tal:attributes="selected python:orderby == 'milestone'"
    >by milestone</option>
    <option
      tal:condition="view/shouldShowTargetName|nothing"
      tal:attributes="selected python:orderby == 'targetname'"
      value="targetname"
    >by location</option>
    <option
      value="datecreated"
      tal:attributes="selected python:orderby == 'datecreated'"
    >oldest first</option>
    <option
      value="-datecreated"
      tal:attributes="selected python:orderby == '-datecreated'"
    >newest first</option>
    <option
      value="-date_last_updated"
      tal:attributes="selected python:orderby == '-date_last_updated'"
    >recently changed</option>
  </select>

</metal:block>

<metal:block define-macro="simple-search-form">
<form method="get" name="search" class="primary search" action=""
      tal:attributes="action search_url|string:">
  <tal:searchbox replace="structure view/searchtext_widget" />
  <metal:widget use-macro="context/@@+bugtarget-macros-search/sortwidget" />
  <input type="submit" name="search" value="Search" />
  <tal:widget replace="structure view/status_widget/hidden" />
  <tal:widget replace="structure view/importance_widget/hidden" />
  <tal:widget replace="structure view/assignee_widget/hidden" />
  <tal:widget replace="structure view/bug_reporter_widget/hidden" />
  <tal:widget replace="structure view/milestone_widget/hidden" />
  <tal:widget replace="structure view/omit_dupes_widget/hidden" />
  <tal:widget replace="structure view/has_patch_widget/hidden" />
  <tal:widget replace="structure view/component_widget/hidden" />
  <tal:widget replace="structure view/has_no_package_widget/hidden" />
  <a href="#"
     tal:attributes="href advanced_search_url|string:?advanced=1">
    <small>Advanced search</small>
  </a>
  <div metal:define-slot="extra-search-widgets">
  </div>
</form>
<script type="text/javascript">
  <!--
      document.forms["search"].elements['field.searchtext'].focus();
    -->
</script>
</metal:block>
