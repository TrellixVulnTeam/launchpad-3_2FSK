= Code Review Messages =

Let's get us a code review message and canonical_url

    >>> from canonical.launchpad.interfaces import CodeReviewVote
    >>> # We need to be admin to add a landing target to a random branch
    >>> login('foo.bar@canonical.com')
    >>> message = factory.makeCodeReviewMessage(
    ...     'my subject', 'my body', CodeReviewVote.APPROVE)
    >>> message_url = canonical_url(message)
    >>> merge_proposal_url = canonical_url(message.branch_merge_proposal)
    >>> print message.message.text_contents
    my body
    >>> logout()

Now, open its home page.

    >>> anon_browser.open(message_url)
    >>> def print_tag(tag_id):
    ...     tag = find_tag_by_id(anon_browser.contents, tag_id)
    ...     print extract_text(tag)
    >>> print anon_browser.title
    Code review comment
    >>> print_tag('comment-body')
    my body
    >>> print_tag('comment-subject')
    my subject
    >>> print_tag('comment-from')
    Person-name21
    >>> print_tag('comment-vote')
    Approve

The comment's view page has a link that takes us back to the merge proposal.

    >>> anon_browser.getLink('Back to merge proposal').click()
    >>> bool(anon_browser.url == merge_proposal_url)
    True
