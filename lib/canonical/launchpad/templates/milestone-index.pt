<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  xml:lang="en"
  lang="en"
  dir="ltr"
  metal:use-macro="context/@@main_template/master"
  i18n:domain="launchpad"
>
<body>

<metal:leftportlets fill-slot="portlets_one">
  <div tal:replace="structure context/@@+portlet-details" />
  <div tal:replace="structure context/target/@@+portlet-milestones" />
</metal:leftportlets>

<div metal:fill-slot="main" tal:define="
    specs view/specifications;
    bugtasks view/bugtasks">

      <h1 tal:content="context/displayname" />
      <p tal:condition="context/dateexpected">
        Due <tal:date replace="context/dateexpected/fmt:approximatedate" />
      </p>

  <p class="informational message" tal:condition="not: context/visible">
    This is an inactive milestone.
  </p>

  <div class="description"
       tal:condition="context/description"
       tal:content="structure context/description/fmt:text-to-html">
    Description of milestone goes here.
  </div>

  <tal:has_specs condition="specs">

    <h2 id="specification-count" tal:content="view/specification_count_text" />

    <table class="listing sortable" id="milestone_specs">
      <thead>
        <tr>
          <th>Specification</th>
          <th tal:condition="view/is_project_milestone">
            Product
          </th>
          <th>Priority</th>
          <th>Assignee</th>
          <th>Delivery</th>
        </tr>
      </thead>
      <tbody>
        <tr tal:repeat="spec specs">
          <td>
            <a tal:content="spec/title/fmt:shorten/60"
               tal:attributes="
                   href spec/fmt:url;
                   title spec/name">Foo Bar Baz</a>
            <img src="/@@/info" alt="Informational"
                 tal:condition="spec/informational" />
          </td>
          <td tal:condition="view/is_project_milestone">
              <span class="sortkey" tal:content="spec/product/displayname" />
              <a tal:attributes="href spec/milestone/fmt:url"
                 tal:content="spec/product/displayname" />
          </td>
          <td>
            <span class="sortkey" tal:content="spec/priority/sortkey" />
            <span tal:content="spec/priority/title"
                  tal:attributes="
                  class string:specpriority${spec/priority/name}">High</span>
          </td>
          <td>
            <a tal:condition="spec/assignee"
               tal:replace="structure spec/assignee/fmt:link" />&nbsp;
          </td>
          <td>
            <span class="sortkey"
                  tal:content="spec/implementation_status/sortkey" />
            <span tal:content="spec/implementation_status/title"
                  tal:attributes="
                  class string:specdelivery${spec/implementation_status/name}">
              Deployment
            </span>
          </td>
        </tr>
      </tbody>
    </table>

  </tal:has_specs>

  <tal:has_bugtasks condition="bugtasks">

    <h2 id="bug-count" tal:content="view/bugtask_count_text" />

    <table class="listing sortable" id="milestone_bugtasks">
      <thead>
        <tr>
          <th colspan="3">Report</th>
          <th tal:condition="view/is_project_milestone">
            Product
          </th>
          <th>Importance</th>
          <th>Assignee</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <tr tal:repeat="bugtask bugtasks">
          <td class="icon left">
            <span class="sortkey" tal:content="bugtask/bug/id" />
            <span tal:content="structure bugtask/image:icon" />
          </td>
          <td tal:content="bugtask/bug/id" class="amount">12345</td>
          <td>
            <a tal:attributes="href bugtask/bug/fmt:url"
               tal:content="bugtask/bug/title/fmt:shorten/65">
               Bug Title Here
            </a>
          </td>
          <td tal:condition="view/is_project_milestone">
            <span class="sortkey" tal:content="bugtask/target/displayname" />
            <a tal:attributes="href bugtask/milestone/fmt:url"
               tal:content="bugtask/target/displayname" />
          </td>
          <td>
            <span class="sortkey" tal:content="bugtask/importance/sortkey" />
            <span tal:replace="bugtask/importance/title">High</span>
          </td>
          <td>
            <a tal:condition="bugtask/assignee"
               tal:replace="structure bugtask/assignee/fmt:link" />&nbsp;
          </td>
          <td>
            <span class="sortkey" tal:content="bugtask/status/sortkey" />
            <span
                tal:content="bugtask/status/title"
                tal:attributes="
                class string:status${bugtask/status/name}">High</span>
          </td>
        </tr>
      </tbody>
    </table>

  </tal:has_bugtasks>

  <tal:neither_bugs_nor_specs condition="not: view/has_bugs_or_specs">
    <h2>No blueprints or bugs targeted</h2>
    <p>
      You do not have any feature specifications or bug tasks targeted
      to this milestone. For any given specification or bug task, you
      can target it to a milestone to keep a handy listing of things you
      want to get done in that milestone.
    </p>
  </tal:neither_bugs_nor_specs>

</div> 
</body>
</html>
