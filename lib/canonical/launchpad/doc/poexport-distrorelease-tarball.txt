
  >>> from canonical.librarian.ftests.harness import LibrarianTestSetup
  >>> LibrarianTestSetup().setUp()

Get a tarball representation of a release's translations.

Get hold of our distribution release.

  >>> from canonical.launchpad.database import DistroRelease
  >>> release = DistroRelease.get(3)
  >>> release.name
  u'hoary'

Now get hold of a tarball for the release.

  >>> from canonical.launchpad.components.poexport import \
  ...     DistroReleasePOExporter
  >>> exporter = DistroReleasePOExporter(release)
  >>> tarfile_string = exporter.export_tarball()

Check the tarball has the right members.

  >>> from canonical.launchpad.helpers import string_to_tarfile
  >>> tarfile = string_to_tarfile(tarfile_string)
  >>> for name in tarfile.getnames():
  ...     print name
  rosetta-hoary/
  ...
  rosetta-hoary/es/
  rosetta-hoary/es/LC_MESSAGES/
  rosetta-hoary/es/LC_MESSAGES/pmount.po
  ...
  rosetta-hoary/timestamp.txt

Check the directory permissions (493 == 0775)

  >>> directory = tarfile.getmember('rosetta-hoary/')
  >>> directory.mode == 0755
  True

Check the PO file looks like what we expected.

  >>> fh = tarfile.extractfile('rosetta-hoary/es/LC_MESSAGES/evolution-2.2.po')
  >>> fh.readline()
  '# traducci\xc3\xb3n de es.po al Spanish\n'

  >>> LibrarianTestSetup().tearDown()

