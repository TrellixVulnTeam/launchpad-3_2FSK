#!/bin/sh

set -e

rm -rf build/js
mkdir -p build/js
for yuitar in download-cache/dist/yui*.tar.gz ; do
    ver=$(echo $yuitar | sed -e 's/.*yui-\(.*\).tar.gz/\1/')
    mkdir -p build/js/yui/$ver
    tar zxf $yuitar -C build/js/yui/$ver
done
mkdir build/js/lp
for jsdir in lib/lp/*/javascript ; do
    app=$(echo $jsdir | sed -e 's,lib/lp/\(.*\)/javascript,\1,')
    cp -a $jsdir build/js/lp/$app
done
utilities/js-deps -n LP_MODULES -s build/js/lp -o build/js/lp/meta.js >/dev/null
#for jsfile in $(find build/js/lp -name '*.js') ; do
#    outfile=$(echo $jsfile | sed -e 's/.js$/-min.js/')
#	bin/py -m lp.scripts.utilities.js.jsmin < $jsfile > $outfile
#done
