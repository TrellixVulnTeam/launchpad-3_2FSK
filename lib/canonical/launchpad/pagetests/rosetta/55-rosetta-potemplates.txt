Legend and headers display
--------------------------

On template overview page, when user is not logged in (and there is no
sufficient GeoIP data), or user has not set his preferred languages,
legend should be hidden from him since he's looking only at the list
of templates.

  >>> anon_browser.addHeader('X-Forwarded-For', '192.168.0.1')
  >>> anon_browser.open('http://launchpad.dev/evolution/trunk/+translations')
  >>> anon_browser.url
  'http://launchpad.dev/evolution/trunk/+translations'
  >>> 'Newly translated in Rosetta' in anon_browser.contents
  False

When looking at a specific template with at least one translation, he
will again see the legend.

  >>> anon_browser.open(
  ...    'http://launchpad.dev/evolution/trunk/+pots/evolution-2.2')
  >>> anon_browser.url
  'http://launchpad.dev/evolution/trunk/+pots/evolution-2.2'
  >>> 'Newly translated in Rosetta' in anon_browser.contents
  True

The same happens for template overview page for packages.

  >>> anon_browser.open(
  ...    'http://launchpad.dev/ubuntu/hoary/+source/evolution/+translations')
  >>> anon_browser.url
  'http://launchpad.dev/ubuntu/hoary/+source/evolution/+translations'
  >>> 'Newly translated in Rosetta' in anon_browser.contents
  False

And with at least one translation, legend is shown.

  >>> anon_browser.open(
  ...    'http://launchpad.dev/ubuntu/hoary/+source/evolution/+pots/man')
  >>> anon_browser.url
  'http://launchpad.dev/ubuntu/hoary/+source/evolution/+pots/man'
  >>> 'Newly translated in Rosetta' in anon_browser.contents
  True


When there are no translations in a single template, legend and
headers should not be shown.

  >>> anon_browser.open(
  ...    'http://launchpad.dev/netapplet/trunk/+pots/netapplet')
  >>> anon_browser.url
  'http://launchpad.dev/netapplet/trunk/+pots/netapplet'
  >>> 'Newly translated in Rosetta' in anon_browser.contents
  False

And likewise for package templates (which use a different template).

  >>> anon_browser.open(
  ...    'http://launchpad.dev/ubuntu/hoary/+source/pmount/+pots/man')
  >>> anon_browser.url
  'http://launchpad.dev/ubuntu/hoary/+source/pmount/+pots/man'
  >>> 'Newly translated in Rosetta' in anon_browser.contents
  False


The PO Template Views
---------------------

Carlos is a translator who translates things into Spanish and Catalan.
When he looks at available translations for Evolution in Hoary, he
should see Catalan in the list.

  >>> browser.addHeader('Authorization', 'Basic carlos@canonical.com:test')
  >>> browser.open('http://launchpad.dev/ubuntu/hoary/+source/evolution/+translations')
  >>> browser.url
  'http://launchpad.dev/ubuntu/hoary/+source/evolution/+translations'
  >>> 'Catalan' in browser.contents
  True

But also, he doesn't want to see other languages in the list.  So, he
shouldn't see eg. Japanese.

  >>> 'Japanese' in browser.contents
  False

Next, if he chooses to view all the languages, he should see Japanese
among the languages on the page.

  >>> browser.getLink('View Template & All Languages...').click()
  >>> browser.url
  'http://launchpad.dev/ubuntu/hoary/+source/evolution/+pots/evolution-2.2'
  >>> 'Japanese' in browser.contents
  True

So, everything is fine, and Carlos can sleep calmly.
