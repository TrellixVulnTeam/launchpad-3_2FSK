Testing the deactivation of membership for 'name16' on team 'myemail'.

We want to test concurrency here, so keep two browsers around:

  >>> from zope.testbrowser.testing import Browser
  >>> browser2 = Browser()
  >>> browser2.addHeader("Authorization", "Basic foo@baz.com:f")
  >>> browser2.open("http://launchpad.dev/~myemail/+member/name16")

XXX: As per bug 68655, it would be nice to be able to clone the browser
and not do the manual copy.

Deactivate the member:

  >>> browser.addHeader("Authorization", "Basic foo@baz.com:f")
  >>> browser.open("http://launchpad.dev/~myemail/+member/name16")
  >>> browser.getControl('Deactivate').click()
  >>> browser.url
  'http://launchpad.dev/~myemail/+members'

And see how it went:

  >>> print browser.contents
  <...
  <BLANKLINE>
  ...
  ...Inactive members...
  ...
  ...Foo Bar...
  ...Deactivated...
  ...

Attempt to deactivate the user again using our original browser2
instance. No crashes in sight:

  >>> browser2.handleErrors = False
  >>> browser2.getControl('Deactivate').click()
  >>> browser2.url
  'http://launchpad.dev/~myemail/+members'

Let's make sure that 'name16' is now a DEACTIVATED member of this team.

  >>> from canonical.launchpad.database import Person, TeamMembership
  >>> foobar = Person.byName('name16')
  >>> team = Person.byName('myemail')
  >>> tm = TeamMembership.selectOneBy(person=foobar, team=team)
  >>> tm.statusname
  'Deactivated'
  >>> foobar.inTeam(team)
  False

