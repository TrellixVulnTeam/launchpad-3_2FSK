We will test that we can add a distro release.

  >>> from mechanize import LinkNotFoundError

First, we test that the link to add distro releases is not there
when we are not logged in.

  >>> anon_browser.open("http://localhost/distros/ubuntu")
  >>> anon_browser.handleErrors = True
  >>> try:
  ...     anon_browser.getLink("Add Release")
  ... except LinkNotFoundError:
  ...     print "LinkNotFoundError"
  LinkNotFoundError
  
and that going directly to the page redirects to login

  >>> anon_browser.open("http://localhost/distros/ubuntu/+addrelease")
  >>> anon_browser.url
  'http://localhost/distros/ubuntu/+addrelease/+login'

Now we will try as Mark Shuttleworth on Debian, where he is the owner.
This time we expect to be able to see the link and the page.

  >>> browser.addHeader("Authorization", "Basic mark@hbd.com:test")

  >>> browser.open("http://localhost/distros/debian")
  >>> browser.getLink("Add Release").click()
  >>> browser.url
  'http://localhost/distros/debian/+addrelease'  

OK, let's test as Foo Bar, who is an administrator.

  >>> admin_browser.open("http://localhost/distros/ubuntu")
  >>> admin_browser.getLink("Add Release").click()
  >>> admin_browser.url
  'http://localhost/distros/ubuntu/+addrelease'  

Now, lets fill out this form and add a release.

  >>> admin_browser.getControl(name="field.name").value = 'fidgety'
  >>> admin_browser.getControl("Display name").value = 'Fidgety'
  >>> admin_browser.getControl("Title").value = 'Fidgety Fairy'
  >>> admin_browser.getControl("Summary").value = 'The Fidgety Fairy release'
  >>> admin_browser.getControl("Description").value = 'Fidgety Fairy desc'
  >>> admin_browser.getControl("Version").value = '5.12'
  >>> admin_browser.getControl("Parent Release").value = ['ubuntu/hoary']
  >>> admin_browser.getControl("Add").click()
  >>> admin_browser.url
  'http://localhost/distros/ubuntu/fidgety'

