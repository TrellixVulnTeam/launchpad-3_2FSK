<tal:layout define="columns1 default">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
  lang="en"
  metal:use-macro="context/@@main_template_2col/master"
  i18n:domain="rosetta"
>
<body>

<metal:leftportlets fill-slot="portlets_one">
  <div tal:replace="structure context/@@+portlet-details" />
  <div tal:replace="structure context/product/@@+portlet-details" />
</metal:leftportlets>

<metal:rightportlets fill-slot="portlets_two">
</metal:rightportlets>

<metal:heading fill-slot="pageheading">
  <h3 tal:content="context/title">Foo Series: main</h3>
  <h1>Upstream source import</h1>
</metal:heading>

<div metal:fill-slot="main">

  <div metal:use-macro="context/@@launchpad_form/form">
    <p metal:fill-slot="extra_info" tal:condition="not:view/errors">
      Once you enter the details of the <abbr title="revision control
      system">RCS</abbr> you use for this product series, Launchpad can
      attempt to import that code and publish it as a Bazaar branch.  This
      lets distributors share code with you more efficiently, and also allows
      distributed upstream development.
    </p>

    <metal:formbody fill-slot="widgets">

      <div class="formHelp">
        Enter details below for only the selected Repository type.
      </div>

      <fieldset>
        <legend>
          <label>
            <input tal:replace="structure view/rcstype_none" />
            No revision control system, or Bazaar
          </label>
        </legend>
        <tal:widget define="widget nocall:view/widgets/user_branch">
          <metal:block use-macro="context/@@launchpad_widget_macros/launchpad_widget_row" />
        </tal:widget>
      </fieldset>

      <fieldset>
        <legend>
          <label>
            <input tal:replace="structure view/rcstype_cvs" />
            CVS
          </label>
        </legend>
        <tal:widget define="widget nocall:view/widgets/cvsroot">
          <metal:block use-macro="context/@@launchpad_widget_macros/launchpad_widget_row" />
        </tal:widget>
        <tal:widget define="widget nocall:view/widgets/cvsmodule">
          <metal:block use-macro="context/@@launchpad_widget_macros/launchpad_widget_row" />
        </tal:widget>
        <tal:widget define="widget nocall:view/widgets/cvsbranch">
          <metal:block use-macro="context/@@launchpad_widget_macros/launchpad_widget_row" />
        </tal:widget>
      </fieldset>

      <fieldset>
        <legend>
          <label>
            <input tal:replace="structure view/rcstype_svn" />
            Subversion
          </label>
        </legend>

        <tal:widget define="widget nocall:view/widgets/svnrepository">
          <metal:block use-macro="context/@@launchpad_widget_macros/launchpad_widget_row" />
        </tal:widget>
      </fieldset>

      <input tal:replace="structure view/rcstype_emptymarker" />

      <tal:has-import-status condition="context/importstatus">
        <h2>Import Status</h2>

        <p>The current import status is:
          <b tal:content="context/importstatus/title">$title</b>. </p>
      </tal:has-import-status>

      <fieldset>
        <legend>FTP Details</legend>

        <tal:widget define="widget nocall:view/widgets/releaseroot">
          <metal:block use-macro="context/@@launchpad_widget_macros/launchpad_widget_row" />
        </tal:widget>
        <tal:widget define="widget nocall:view/widgets/releasefileglob">
          <metal:block use-macro="context/@@launchpad_widget_macros/launchpad_widget_row" />
        </tal:widget>
      </fieldset>

      <script type="text/javascript">
        function updateWidgets() {
          /* which rcs type radio button has been selected? */
          var rcstypes = document.getElementsByName('field.rcstype');
          var form = rcstypes[0].form;
          var rcstype = 'None';
          for (var i = 0; i < rcstypes.length; i++) {
            if (rcstypes[i].checked) {
              rcstype = rcstypes[i].value;
              break;
            }
          }
          form['field.cvsroot'].disabled = (rcstype != 'CVS');
          form['field.cvsbranch'].disabled = (rcstype != 'CVS');
          form['field.cvsmodule'].disabled = (rcstype != 'CVS');
          form['field.svnrepository'].disabled = (rcstype != 'Subversion');
        }
        updateWidgets();
      </script>

    </metal:formbody>
  </div>

</div>
</body>
</html>
</tal:layout>
