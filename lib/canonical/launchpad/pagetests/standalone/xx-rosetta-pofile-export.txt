Exporting Single PO Files through the Web
-----------------------------------------

  >>> browser.addHeader('Authorization', 'Basic carlos@canonical.com:test')
  >>> browser.open(
  ...     'http://launchpad.dev/distros/ubuntu/hoary'
  ...     '/+source/evolution/+pots/evolution-2.2/es')
  >>> browser.getLink('Download').click()

  >>> browser.url
  'http://launchpad.dev/distros/ubuntu/hoary/+source/evolution/+pots/evolution-2.2/es/+export'

  >>> browser.title
  'Spanish (es) translation of evolution-2.2 in Ubuntu Hoary package "evolution" file exports'

  >>> 'PO file export' in browser.contents
  True
  >>> 'carlos@canonical.com' in browser.contents
  True

If we POST the page, it should add the request to the queue.

  >>> browser.getControl('Format').value = ['PO']
  >>> browser.getControl('Confirm Export').click()

  >>> browser.url
  'http://launchpad.dev/distros/ubuntu/hoary/+source/evolution/+pots/evolution-2.2/es'

  >>> for tag in find_tags_by_class(browser.contents, 'informational'):
  ...     print tag
  <div class="informational message">Your request has been received. Expect to receive an email shortly.</div>

Let's be sure that we can request po files without translations as the
No Privileges Person.

  >>> from zope.testbrowser.testing import Browser
  >>> no_priv_browser = Browser()
  >>> no_priv_browser.handleErrors = False
  >>> no_priv_browser.addHeader(
  ...     'Authorization', 'Basic no-priv@canonical.com:test')

  >>> no_priv_browser.open(
  ...    'http://launchpad.dev/products/evolution/trunk/+pots/evolution-2.2/cy/')

  >>> no_priv_browser.getLink('Download').click()
  >>> no_priv_browser.url
  'http://launchpad.dev/products/evolution/trunk/+pots/evolution-2.2/cy/+export'

  >>> no_priv_browser.getControl('Format').value = ['PO']
  >>> no_priv_browser.getControl('Confirm Export').click()

  >>> no_priv_browser.url
  'http://launchpad.dev/products/evolution/trunk/+pots/evolution-2.2/cy'

  >>> for tag in find_tags_by_class(browser.contents, 'informational'):
  ...     print tag
  <div class="informational message">Your request has been received. Expect to receive an email shortly.</div>

Since no-privileges person isn't a valid translator for that language, the
ownership of the newly created pofile is set to Rosetta Admins.

  >>> browser.open(
  ...     'http://launchpad.dev/products/evolution'
  ...     '/trunk/+pots/evolution-2.2/cy')
  >>> translation_portlet = find_portlet(
  ...     browser.contents, 'Translation file details:')
  >>> translation_portlet.firstText('Creator:').findNext('a').string
  u'Rosetta Administrators'

But if we request an export from a valid translator, he gets the ownership.

  >>> browser.open(
  ...     'http://launchpad.dev/products/evolution/trunk/+pots/evolution-2.2/sv')
  >>> browser.getLink('Download').click()

  >>> browser.getControl('Format').value = ['PO']
  >>> browser.getControl('Confirm Export').click()

  >>> browser.url
  'http://launchpad.dev/products/evolution/trunk/+pots/evolution-2.2/sv'

  >>> for tag in find_tags_by_class(browser.contents, 'informational'):
  ...     print tag
  <div class="informational message">Your request has been received. Expect to receive an email shortly.</div>
  ...

  >>> translation_portlet = find_portlet(
  ...     browser.contents, 'Translation file details:')
  >>> translation_portlet.firstText('Creator:').findNext('a').string
  u'Carlos Perell\xf3 Mar\xedn'
