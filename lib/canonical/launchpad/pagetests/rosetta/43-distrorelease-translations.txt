= Translations for DistroSeries =

First, we need to ensure that we can see the distroseries translations
page, and that it has all the data we are expecting, in terms of languages.

  >>> browser.open('http://launchpad.dev/ubuntu/hoary/+translations')
  >>> browser.url
  'http://launchpad.dev/ubuntu/hoary/+translations'
  >>> 'Translation status by language' in browser.contents
  True
  >>> browser.getLink('Catalan')
  <Link text='Catalan' url='http://launchpad.dev/ubuntu/hoary/+lang/ca'>
  >>> browser.getLink('Xhosa')
  <Link text='Xhosa' url='http://launchpad.dev/ubuntu/hoary/+lang/xh'>
  >>> browser.getLink('Afrihili')
  Traceback (most recent call last):
  ...
  LinkNotFoundError

We also should see any personal language that is not already translated, but
which is in the personal pref list. In this example, we tell the system that
our browser speaks Afrihili, and since the user is anonymous the system will
put Afrihili into the list of "preferred languages".

  >>> browser.addHeader('Accept-Language', 'en-us,en;q=0.7,afh;q=0.3')
  >>> browser.open('http://launchpad.dev/ubuntu/hoary/+translations')
  >>> browser.url
  'http://launchpad.dev/ubuntu/hoary/+translations'
  >>> 'Translation status by language' in browser.contents
  True
  >>> browser.getLink('Catalan')
  <Link text='Catalan' url='http://launchpad.dev/ubuntu/hoary/+lang/ca'>
  >>> browser.getLink('Xhosa')
  <Link text='Xhosa' url='http://launchpad.dev/ubuntu/hoary/+lang/xh'>
  >>> browser.getLink('Afrihili')
  <Link text='Afrihili' url='http://launchpad.dev/ubuntu/hoary/+lang/afh'>

If we select Croatian, we would expect to see the list of source package
templates, and in the sample data we should have a croatian pofile for
pmount. Note that we should also have an empty pofile (really a dummy
pofile) for evolution-2.2

  >>> browser.open('http://launchpad.dev/ubuntu/hoary/+lang/hr?batch=2')
  >>> browser.url
  'http://launchpad.dev/ubuntu/hoary/+lang/hr?batch=2'
  >>> 'Croatian' in browser.contents
  True
  >>> 'Programs you can translate' in browser.contents
  True
  >>> browser.getLink('evolution-2.2')
  <Link text='evolution-2.2' url='http://launchpad.dev/ubuntu/hoary/+source/evolution/+pots/evolution-2.2/hr/+translate'>
  >>> browser.getLink('man')
  <Link text='man' url='http://launchpad.dev/ubuntu/hoary/+source/evolution/+pots/man/hr/+translate'>

pmount and pkgconf-mozilla are not in this page, because it belongs to the next batch.

  >>> browser.getLink('pkgconf-mozilla')
  Traceback (most recent call last):
  ...
  LinkNotFoundError
  >>> browser.getLink('pmount')
  Traceback (most recent call last):
  ...
  LinkNotFoundError

Let's go to next page.

  >>> browser.getLink('Next').click()
  >>> browser.url
  'http://launchpad.dev/ubuntu/hoary/+lang/hr/+index?start=2&batch=2'

Now, we have the other man and pkgconf-mozilla:

  >>> browser.getLink('man')
  <Link text='man' url='http://launchpad.dev/ubuntu/hoary/+source/pmount/+pots/man/hr/+translate'>
  >>> browser.getLink('pkgconf-mozilla')
  <Link text='pkgconf-mozilla' url='http://launchpad.dev/ubuntu/hoary/+source/mozilla/+pots/pkgconf-mozilla/hr/+translate'>

Let's go to next page.

  >>> browser.getLink('Next').click()
  >>> browser.url
  'http://launchpad.dev/ubuntu/hoary/+lang/hr/+index?start=4&batch=2'

And finally, we will get pmount.

  >>> browser.getLink('pmount')
  <Link text='pmount' url='http://launchpad.dev/ubuntu/hoary/+source/pmount/+pots/pmount/hr/+translate'>

With its latest translator.

  >>> 'Edgar Bursic' in browser.contents
  True

== Last translator ==

When there's no reviewer and date of review on a last touched PO message
inside a PO file (for example, when it was uploaded from the package), the
last translator is displayed.

  >>> browser.open('http://translations.launchpad.dev/ubuntu/hoary/+lang/de')
  >>> print extract_text(
  ...     find_tag_by_id(browser.contents, "pkgconf-mozilla-time"))
  2005-05-06 21:12:42 UTC
  2005-05-06
  >>> print extract_text(
  ...     find_tag_by_id(browser.contents, "pkgconf-mozilla-person"))
  Helge Kreutzmann

== DummyPOFile ==

There are no translations yet for pmount into Portuguese. Carlos has
decided to start contributing translations to that package.

  >>> browser.addHeader('Authorization', 'Basic carlos@canonical.com:test')
  >>> browser.open('http://launchpad.dev/ubuntu/hoary/+source/pmount/+pots/pmount/pt_BR/+translate')
  >>> browser.url
  'http://launchpad.dev/ubuntu/hoary/+source/pmount/+pots/pmount/pt_BR/+translate'

Then he decides that he only wants to filter on untranslated entries (he's
not aware that this translation is actually empty, i.e. there is no such PO
file):

  >>> browser.getControl(name='show', index=1).value = ['untranslated']
  >>> browser.getControl('Filter').click()
  >>> browser.url
  'http://launchpad.dev/ubuntu/hoary/+source/pmount/+pots/pmount/pt_BR/+translate?batch=10&show=untranslated'
  >>> '10.' in browser.contents
  True

If everything works out ok, that means that DummyPOFile has actually
returned all untranslated entries.

Now, lets also check that fuzzy entries show up as well.

  >>> browser.getControl(name='show', index=1).value = ['need_review']
  >>> browser.getControl('Filter').click()
  >>> browser.url
  'http://launchpad.dev/ubuntu/hoary/+source/pmount/+pots/pmount/pt_BR/+translate?batch=10&show=need_review'
  >>> "There are no messages that match this filtering." in browser.contents
  True

Finally, lets also check that translated entries show up as well.

  >>> browser.getControl(name='show', index=1).value = ['translated']
  >>> browser.getControl('Filter').click()
  >>> browser.url
  'http://launchpad.dev/ubuntu/hoary/+source/pmount/+pots/pmount/pt_BR/+translate?batch=10&show=translated'
  >>> "There are no messages that match this filtering." in browser.contents
  True

