<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  xml:lang="en"
  lang="en"
  dir="ltr"
  metal:use-macro="context/@@main_template/master"
  i18n:domain="launchpad"
>

<body>

<div metal:fill-slot="main">

  <h1>Code overview for <tal:project-name replace="context/displayname"/></h1>

  <tal:comment condition="nothing">
    Here is where we'd add the branch searching form.
  </tal:comment>
  <p>
    <a href="+branches">List currently active branches</a> for
    <tal:project-name replace="context/displayname"/>.
  </p>

  <div class="left">
    <div class="section portlet" id="official-branches">

      <h2>Official branches</h2>

      <div class="project series"
           tal:repeat="series view/sorted_series_list">
        <div tal:define="is_focus python:context.development_focus == series"
             tal:attributes="class python:is_focus and 'highlighted' or 'unhighlighted'">
          <metal:series use-macro="series/@@+macros/branch_display" />
        </div>

      </div>
    </div>
  </div>

  <div class="right">
    <div class="section portlet">
      <h2>Recent revisions</h2>
      <p>
        These are the branches with the most recent revisions.
      </p>

      <table>
        <tal:branches repeat="rev_no view/recent_revisions">
          <tr tal:define="branch rev_no/branch">
            <td>
              <img src="/@@/branch"/>
            </td>
            <td>
              <div>
                <tal:branch replace="structure branch/fmt:title-link"/>
                <tal:badges replace="structure branch/badges:small"/>
              </div>
              <div class="lesser">
                registered by
                  <a tal:attributes="href branch/owner/fmt:url"
                     tal:content="branch/owner/browsername">Foo Bar</a>
              </div>
              <dl>
                <dd>
                  <tal:revision define="codebrowse string:${view/codebrowse_root}${rev_no/branch/unique_name}">
                    <metal:landing-target use-macro="rev_no/branch/@@+macros/revision-text"/>
                  </tal:revision>
                </dd>
              </dl>
            </td>
          </tr>
        </tal:branches>
      </table>

    </div>

    <div
        tal:condition="view/latest_branches"
        class="sectioon portlet"
        id="portlet-latest-branches">
      <h2>Latest branches</h2>
      <div class="portletBody portletContent">

        <table>
          <tal:branches repeat="branch view/latest_branches">
            <tr>
              <td>
                <img src="/@@/branch"/>
              </td>
              <td>
                <div>
                  <tal:branch replace="structure branch/fmt:title-link"/>
                  <tal:badges replace="structure branch/badges:small"/>
                </div>
                <div class="lesser">
                  registered
                  <span
                      tal:attributes="title branch/date_created/fmt:datetime"
                      tal:content="branch/date_created/fmt:displaydate">2005-10-05</span>
                  by
                  <a tal:attributes="href branch/owner/fmt:url"
                     tal:content="branch/owner/browsername">Foo Bar</a>
                </div>
                <p tal:condition="branch/summary"
                   tal:content="branch/summary"/>
              </td>
            </tr>
          </tal:branches>
        </table>

      </div>
    </div>

  </div>

</div>

</body>
</html>
