Testing archive-override-check behaviour:
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

This script looks for out-of-sync overrides, checking for
discrepancies in overrides between architectures.

It should run daily via cronjob, sending the STDOUT result report via
email to distribution maintainers to ensure that only necessary
discrepancies are present during the development cycle.

See also:
    https://launchpad.net/products/soyuz/+spec/overrides-consistency-check
    https://wiki.ubuntu.com/MilestoneRhythm

XXX cprov 20060714: we need better populate archive/"publishing
history" in the sampledata to test those tools properly.

  >>> import os
  >>> import subprocess
  >>> import sys
  >>> from canonical.config import config

  >>> script = os.path.join(config.root, "scripts", "ftpmaster-tools",
  ...                       "archive-override-check.py")

  >>> process = subprocess.Popen([sys.executable, script, "-vv",
  ...                             "-d", "ubuntu",
  ...                             "-s", "warty"],
  ...                            stdout=subprocess.PIPE,
  ...                            stderr=subprocess.PIPE,)
  >>> stdout, stderr = process.communicate()
  >>> process.returncode
  0
  >>> print stderr
  DEBUG   Acquiring lock
  DEBUG   Initialising connection.
  DEBUG   Considering: ubuntu/warty/RELEASE/CURRENT.
  DEBUG   4 published sources
  DEBUG   Rolling back any remaining transactions.
  DEBUG   Releasing lock
  <BLANKLINE>


Since its data is sane, empty STDOUT is okay.

  >>> print stdout
