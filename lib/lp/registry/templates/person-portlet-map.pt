<!-- Copyright 2009 Canonical Ltd.  This software is licensed under the
     GNU Affero General Public License version 3 (see the file LICENSE).
-->

<tal:root
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  omit-tag="">

<div class="portlet" id="portlet-map"
     tal:define="overview_menu context/menu:overview">

  <h2>Location</h2>

  <div tal:condition="context/time_zone">
    <strong>Time zone:</strong>
    <span tal:replace="context/time_zone">UTC</span>
  </div>

  <tal:show-map condition="view/should_show_map_portlet">
    <div style="width: 400px;" tal:condition="context/latitude">
      <div id="person_map_actions"
        style="position:relative; z-index: 9999;
               float:right; width: 8.5em; margin: 2px;
               background-color: white; padding-bottom:1px;"></div>
      <div id="person_map_div" class="small-map"
        style="height: 200px; border: 1px; margin-top: 4px;"></div>
      <tal:mapscript replace="structure view/map_portlet_html" />
      <div style="margin-top: 0px;">
        <a tal:replace="structure overview_menu/editlocation/fmt:link-icon" />
      </div>
    </div>

    <tal:comment condition="nothing">
      When a person's location is unset we can be sure any user will have
      permission to set it, so we don't need to check that the link is enabled.
    </tal:comment>
    <a tal:condition="not: context/latitude"
       tal:attributes="href overview_menu/editlocation/target"
      ><img src="/+icing/portlet-map-unknown.png" />
    </a>
  </tal:show-map>

</div>
</tal:root>
