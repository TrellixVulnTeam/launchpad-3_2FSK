Distribution Pages
==================

Lists of distribution mirrors
-----------------------------

There are several pages listing the mirrors of a distribution, and they all
share a common base class which is responsible for ordering the mirrors by
country.

    >>> from zope.component import getMultiAdapter, getUtility
    >>> from canonical.launchpad.interfaces import IDistributionSet
    >>> from canonical.launchpad.webapp.servers import LaunchpadTestRequest

    >>> login("foo.bar@canonical.com")

    >>> ubuntu = getUtility(IDistributionSet).getByName("ubuntu")
    >>> ubuntu_cdmirrors = getMultiAdapter(
    ...     (ubuntu, LaunchpadTestRequest()), name="+cdmirrors")

    >>> country_and_mirrors = ubuntu_cdmirrors.getMirrorsGroupedByCountry()
    >>> for country_and_mirror in country_and_mirrors:
    ...     country = country_and_mirror['country']
    ...     mirrors = country_and_mirror['mirrors']
    ...     for mirror in mirrors:
    ...         assert mirror.country.name == country
    ...     print "%s: %d mirror(s)" % (country, len(mirrors))
    France: 2 mirror(s)
    Germany: 1 mirror(s)
    United Kingdom: 1 mirror(s)


== DistributionArchivesView ==

The DistributionArchivesView includes an archive_list property that
returns a list of copy archives only for the given distribution (because
only copy archives are exposed through the distribution/+archives UI):

    >>> distro_archives_view = create_initialized_view(ubuntu,
    ...                                                name="+archives")
    >>> archives = distro_archives_view.archive_list
    >>> archives.count()
    0

And then after creating a copy archive for Ubuntu:

    >>> copy_location = factory.makeCopyArchiveLocation(
    ...     distribution=ubuntu,
    ...     name="intrepid-security-rebuild")
    >>> archives = distro_archives_view.archive_list
    >>> archives.count()
    1


