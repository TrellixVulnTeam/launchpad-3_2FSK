= Distrorelease translations =

This page shows a list of PO templates contained within all source
packages in a particular distibution release.

We are going to work with visible (Spanish) and non visible
(Spanish (Spain)) languages.

Here we can see that Spanish (Spain) is not visible.

    >>> admin_browser.open(
    ...     'http://translations.launchpad.dev/+languages/es_ES/+admin')
    >>> print admin_browser.url
    http://translations.launchpad.dev/+languages/es_ES/+admin
    >>> print admin_browser.getControl('The English name').value
    Spanish (Spain)
    >>> admin_browser.getControl('Visible').selected
    False

But Spanish is visible.

    >>> admin_browser.open(
    ...     'http://translations.launchpad.dev/+languages/es/+admin')
    >>> print admin_browser.url
    http://translations.launchpad.dev/+languages/es/+admin
    >>> print admin_browser.getControl('The English name').value
    Spanish
    >>> admin_browser.getControl('Visible').selected
    True

In this case, we're asking for the translation overview for Hoary.

    >>> anon_browser.open('http://translations.launchpad.dev/ubuntu/hoary')
    >>> anon_browser.url
    'http://translations.launchpad.dev/ubuntu/hoary'

The system is not showing non visible languages:

    >>> anon_browser.getLink('Spanish (Spain)')
    Traceback (most recent call last):
    ...
    LinkNotFoundError

The system will not show English because it is not translatable:

  >>> anon_browser.getLink('English')
  Traceback (most recent call last):
  ...
  LinkNotFoundError

But it shows the ones not hidden:

    >>> print anon_browser.getLink('Spanish').url
    http://translations.launchpad.dev/ubuntu/hoary/+lang/es

The system has an option to hide all translations for a distro release.
The page to set it is not available for anonymous users:

    >>> anon_browser.getLink('Edit translation options')
    Traceback (most recent call last):
    ...
    LinkNotFoundError

But it's for admins:

    >>> admin_browser.open('http://translations.launchpad.dev/ubuntu/hoary')
    >>> print admin_browser.url
    http://translations.launchpad.dev/ubuntu/hoary

    >>> admin_browser.getLink('Edit translation options').click()
    >>> print admin_browser.url
    http://translations.launchpad.dev/ubuntu/hoary/+admin

Let's hide all Hoary translations.

    >>> admin_browser.getControl('Hide all translations').selected = True
    >>> admin_browser.getControl('Change').click()
    >>> print admin_browser.url
    http://translations.launchpad.dev/ubuntu/hoary

Once the system knows that we want to hide all translations, there
are no languages listed anymore.

    >>> admin_browser.getLink('Spanish')
    Traceback (most recent call last):
    ...
    LinkNotFoundError

    >>> main_content = find_main_content(admin_browser.contents)
    >>> 'hoary/+lang/' in main_content
    False

And the page tells the user that the translations are not available.

    >>> user_browser.open('http://translations.launchpad.dev/ubuntu/hoary')
    >>> main_content = find_main_content(user_browser.contents)
    >>> print main_content.findNext('p').renderContents()
    Translations for Hoary is not available due to automatic translation
    updates. You will be able to reach it once the process finish. Try again
    in a few hours.

Also, if the user tries to navigate directly to launchpad pages,
the system tells him that he's not allowed to see those pages.

    >>> user_browser.open(
    ...     'http://translations.launchpad.dev/ubuntu/hoary/+lang/es')
    Traceback (most recent call last):
    ...
    TranslationUnavailableError: ...

Non existing languages are still notified.

    >>> user_browser.open(
    ...     'http://translations.launchpad.dev/ubuntu/hoary/+lang/notexists')
    Traceback (most recent call last):
    ...
    NotFound: ...

Although, an admin can see the same page.

    >>> admin_browser.open(
    ...     'http://translations.launchpad.dev/ubuntu/hoary/+lang/es')
    >>> print admin_browser.url
    http://translations.launchpad.dev/ubuntu/hoary/+lang/es

Translation pages for source packages is also unavailable.

    >>> user_browser.open(
    ...     'http://translations.launchpad.dev/ubuntu/hoary/+sources/'
    ...     'evolution/+pots/evolution-2.2')
    Traceback (most recent call last):
    ...
    TranslationUnavailableError: ...

... which are also available to administrators:

    >>> admin_browser.open(
    ...     'http://translations.launchpad.dev/ubuntu/hoary/'
    ...     '+sources/evolution')
    >>> print admin_browser.url
    http://translations.launchpad.dev/ubuntu/hoary/+sources/evolution
