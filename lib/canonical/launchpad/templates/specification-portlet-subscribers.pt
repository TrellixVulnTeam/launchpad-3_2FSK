<tal:subs define="subscriptions context/subscriptions">
  <div class="portlet" id="portlet-subscribers" tal:condition="subscriptions">
    <h2>Subscribers</h2>
    <div class="portletBody">
      <tal:comment replace="nothing">
        This is messy, but the portlet has to convey both subscribers and
        whether or not they are essential. Also, in the case where a person
        can say if the subscription is essential, that subscription
        essentiality indicator needs to be clickable to edit, otherwise not.
        Hence all the duplication.
      </tal:comment>
      <div tal:repeat="subscription subscriptions">
        <a tal:condition="subscription/required:launchpad.Edit"
           tal:attributes="href subscription/fmt:url">
          <img
            tal:condition="not:subscription/person/is_valid_person"
            alt="(inactive)"
            src="/@@/person-inactive"
          />
          <tal:active condition="subscription/person/is_valid_person">
            <img
              tal:condition="subscription/essential"
              alt="(essential)"
              src="/@@/subscriber-essential"
            />
            <img
              tal:condition="not: subscription/essential"
              alt=""
              src="/@@/subscriber-inessential"
            />
          </tal:active>
        </a>
        <tal:no_edit condition="not: subscription/required:launchpad.Edit">
           <img tal:condition="subscription/essential"
             src="/@@/subscriber-essential" />
           <img tal:condition="not: subscription/essential"
             src="/@@/subscriber-inessential" />
        </tal:no_edit>
        <a
          tal:attributes="href subscription/person/fmt:url"
          tal:content="subscription/person/displayname"
        />
      </div>
    </div>
  </div>
</tal:subs>
