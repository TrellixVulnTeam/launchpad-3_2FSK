= Link Tags for Atom Feeds =

The icon that appears in a browser's address field to indicate the
presence of an RSS or Atom feed is controlled by adding a <link> tag
to the <head> of the document. We want appropriate pages in
launchpad.dev to provide links to corresponding Atom feeds.


== All Announcements on Launchpad ==

The root launchpad.dev url will have a link to the Atom feed which
displays the most recent announcements for all the projects.

    >>> from BeautifulSoup import BeautifulSoup
    >>> browser.open('http://launchpad.dev/')
    >>> soup = BeautifulSoup(browser.contents)
    >>> soup.head.findAll('link', type='application/atom+xml')
    [<link rel="alternate" type="application/atom+xml"
        title="All Announcements"
        href="http://feeds.launchpad.dev/announcements.atom" />]

The http://launchpad.dev/+announcements page also displays recent
announcements for all the projects so it should have a link to the same
feed.

    >>> browser.open('http://launchpad.dev/+announcements')
    >>> soup = BeautifulSoup(browser.contents)
    >>> soup.head.findAll('link', type='application/atom+xml')
    [<link rel="alternate" type="application/atom+xml"
        title="All Announcements"
        href="http://feeds.launchpad.dev/announcements.atom" />]

== Single Bug Feed ==

On the page which displays a single bug, there should be a link to the
atom feed for that one bug.

    >>> browser.open('http://bugs.launchpad.dev/firefox/+bug/1')
    >>> soup = BeautifulSoup(browser.contents)
    >>> soup.head.findAll('link', type='application/atom+xml')
    [<link rel="alternate" type="application/atom+xml"
        title="Bug 1 Feed"
        href="http://feeds.launchpad.dev/bugs/1/bug.atom" />]


== Latest Bugs and Branches for a Person ==

On the person page on launchpad.dev and bugs.launchpad.dev, we should
show a link to the atom feed for that person's latest bugs and
branches.

    >>> browser.open('http://launchpad.dev/~stevea')
    >>> soup = BeautifulSoup(browser.contents)
    >>> soup.head.findAll('link', type='application/atom+xml')
    [<link rel="alternate" type="application/atom+xml"
        title="Latest Bugs for Steve Alexander"
        href="http://feeds.launchpad.dev/~stevea/latest-bugs.atom" />,
    <link rel="alternate" type="application/atom+xml"
        title="Latest Branches for Steve Alexander"
        href="http://feeds.launchpad.dev/~stevea/branches.atom" />]

On the bugs subdomain, only a link to the bugs feed will be included,
not the branches link.

    >>> browser.open('http://bugs.launchpad.dev/~stevea')
    >>> soup = BeautifulSoup(browser.contents)
    >>> soup.head.findAll('link', type='application/atom+xml')
    [<link rel="alternate" type="application/atom+xml"
        title="Latest Bugs for Steve Alexander"
        href="http://feeds.launchpad.dev/~stevea/latest-bugs.atom" />]


== Latest Bugs, Branches, and Announcements for a Product ==

On the product page on launchpad.dev and bugs.launchpad.dev, we should
show a link to the atom feed for that product's latest bugs.

Feed links for announcements and branches should also be shown on the
main product page.

    >>> browser.open('http://launchpad.dev/jokosher')
    >>> soup = BeautifulSoup(browser.contents)
    >>> soup.head.findAll('link', type='application/atom+xml')
    [<link rel="alternate" type="application/atom+xml"
        title="Announcements for Jokosher"
        href="http://feeds.launchpad.dev/jokosher/announcements.atom" />,
     <link rel="alternate" type="application/atom+xml"
        title="Latest Bugs for Jokosher"
        href="http://feeds.launchpad.dev/jokosher/latest-bugs.atom" />,
     <link rel="alternate" type="application/atom+xml"
        title="Latest Branches for Jokosher"
        href="http://feeds.launchpad.dev/jokosher/branches.atom" />]

Only bug feeds should be linked to on bugs.launchpad.dev.

    >>> browser.open('http://bugs.launchpad.dev/jokosher')
    >>> soup = BeautifulSoup(browser.contents)
    >>> soup.head.findAll('link', type='application/atom+xml')
    [<link rel="alternate" type="application/atom+xml"
        title="Latest Bugs for Jokosher"
        href="http://feeds.launchpad.dev/jokosher/latest-bugs.atom" />]


== Latest Bugs for a Project ==

On the project page on launchpad.dev and bugs.launchpad.dev, we should
show a link to the atom feed for that project's latest bugs.

Feed links for announcements and branches should also be shown
on the main project page.

    >>> browser.open('http://launchpad.dev/gnome')
    >>> soup = BeautifulSoup(browser.contents)
    >>> soup.head.findAll('link', type='application/atom+xml')
    [<link rel="alternate" type="application/atom+xml"
        title="Announcements for GNOME"
        href="http://feeds.launchpad.dev/gnome/announcements.atom" />,
     <link rel="alternate" type="application/atom+xml"
        title="Latest Bugs for GNOME"
        href="http://feeds.launchpad.dev/gnome/latest-bugs.atom" />,
     <link rel="alternate" type="application/atom+xml"
        title="Latest Branches for GNOME"
        href="http://feeds.launchpad.dev/gnome/branches.atom" />]

Only bug feeds should be linked to on bugs.launchpad.dev.

    >>> browser.open('http://bugs.launchpad.dev/gnome')
    >>> soup = BeautifulSoup(browser.contents)
    >>> soup.head.findAll('link', type='application/atom+xml')
    [<link rel="alternate" type="application/atom+xml"
        title="Latest Bugs for GNOME"
        href="http://feeds.launchpad.dev/gnome/latest-bugs.atom" />]

The default view for a project on bugs.launchpad.dev is +bugs. The
default bug listing matches the latest-bugs atom feed, but any search
parameters to this view class may cause them to differ. Since the
project uses the same view class for both tasks, we should check
that the code does not display the atom feed link here inappropriately.

    >>> browser.open('http://bugs.launchpad.dev/gnome/+bugs?'
    ...     'search=Search&field.status=New&field.status=Incomplete'
    ...     '&field.status=Confirmed&field.status=Triaged'
    ...     '&field.status=In+Progress&field.status=Fix+Committed')
    >>> soup = BeautifulSoup(browser.contents)
    >>> soup.head.findAll('link', type='application/atom+xml')
    []


== Latest Bugs for a Distro ==

On the distro page on launchpad.dev and bugs.launchpad.dev, we should
show a link to the atom feed for that distro's latest bugs.

An announcements feed link should also be shown on the main distro page.

    >>> browser.open('http://launchpad.dev/ubuntu')
    >>> soup = BeautifulSoup(browser.contents)
    >>> soup.head.findAll('link', type='application/atom+xml')
    [<link rel="alternate" type="application/atom+xml"
        title="Announcements for Ubuntu"
        href="http://feeds.launchpad.dev/ubuntu/announcements.atom" />,
     <link rel="alternate" type="application/atom+xml"
        title="Latest Bugs for Ubuntu"
        href="http://feeds.launchpad.dev/ubuntu/latest-bugs.atom" />]

Only bug feeds should be linked to on bugs.launchpad.dev.

    >>> browser.open('http://bugs.launchpad.dev/ubuntu')
    >>> soup = BeautifulSoup(browser.contents)
    >>> soup.head.findAll('link', type='application/atom+xml')
    [<link rel="alternate" type="application/atom+xml"
        title="Latest Bugs for Ubuntu"
        href="http://feeds.launchpad.dev/ubuntu/latest-bugs.atom" />]


== Latest Bugs for a Distroseries ==

On the distroseries page on bugs.launchpad.dev, we should
show a link to the atom feed for that distroseries' latest bugs.

    >>> browser.open('http://bugs.launchpad.dev/ubuntu/hoary')
    >>> soup = BeautifulSoup(browser.contents)
    >>> soup.head.findAll('link', type='application/atom+xml')
    [<link rel="alternate" type="application/atom+xml"
        title="Latest Bugs for Hoary"
        href="http://feeds.launchpad.dev/ubuntu/hoary/latest-bugs.atom" />]


== Latest Bugs for a Product Series ==

On the product series page on bugs.launchpad.dev, we should
show a link to the atom feed for that product series' latest bugs.

    >>> browser.open('http://bugs.launchpad.dev/firefox/1.0')
    >>> soup = BeautifulSoup(browser.contents)
    >>> soup.head.findAll('link', type='application/atom+xml')
    [<link rel="alternate" type="application/atom+xml"
        title="Latest Bugs for 1.0"
        href="http://feeds.launchpad.dev/firefox/1.0/latest-bugs.atom" />]


== Latest Bugs for a Source Package ==

On the source package page on bugs.launchpad.dev, we should
show a link to the atom feed for that source package's latest bugs.

    >>> browser.open('http://bugs.launchpad.dev/ubuntu/+source/cnews')
    >>> soup = BeautifulSoup(browser.contents)
    >>> soup.head.findAll('link', type='application/atom+xml')
    [<link rel="alternate" type="application/atom+xml"
        title="Latest Bugs for cnews in ubuntu"
        href="http://feeds.launchpad.dev/ubuntu/+source/cnews/latest-bugs.atom" />]


== Latest Branches for a Project ==

On the project code page on code.launchpad.dev, we should show a link
to the atom feed for that project's latest branches.

    >>> browser.open('http://code.launchpad.dev/mozilla')
    >>> soup = BeautifulSoup(browser.contents)
    >>> soup.head.findAll('link', type='application/atom+xml')
    [<link rel="alternate" type="application/atom+xml"
        title="Latest Branches for the Mozilla Project"
        href="http://feeds.launchpad.dev/mozilla/branches.atom" />]


== Latest Branches for a Product ==

On the project code page on code.launchpad.dev, we should show a link
to the atom feed for that product's latest branches.

    >>> browser.open('http://code.launchpad.dev/firefox')
    >>> soup = BeautifulSoup(browser.contents)
    >>> soup.head.findAll('link', type='application/atom+xml')
    [<link rel="alternate" type="application/atom+xml"
        title="Latest Branches for Mozilla Firefox"
        href="http://feeds.launchpad.dev/firefox/branches.atom" />]


== Latest Branches for a Person ==

On a person's code page on code.launchpad.dev, we should show a link
to the atom feed for that person's latest branches.

    >>> browser.open('http://code.launchpad.dev/~sabdfl')
    >>> soup = BeautifulSoup(browser.contents)
    >>> soup.head.findAll('link', type='application/atom+xml')
    [<link rel="alternate" type="application/atom+xml"
        title="Latest Branches for Mark Shuttleworth"
        href="http://feeds.launchpad.dev/~sabdfl/branches.atom" />]
