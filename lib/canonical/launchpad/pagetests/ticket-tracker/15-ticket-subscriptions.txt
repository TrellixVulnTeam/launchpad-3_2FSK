
Ticket Subscriptions
====================

Users can subscribe to specific tickets. When they are subscribed they
will receive notifications for any changes to the ticket.

To subscribe, users use the 'Subscribe' link and then confirm that
they want to subscribe by clicking on the 'Subscribe' button.

    >>> user_browser.open(
    ...     'http://launchpad.dev/products/firefox/+ticket/2')
    >>> link = user_browser.getLink('Subscribe')
    >>> link.url
    '.../+ticket/2/+subscribe'
    >>> link.click()
    >>> print user_browser.title
    Subscription to request #2

    >>> from BeautifulSoup import BeautifulSoup
    >>> soup = BeautifulSoup(user_browser.contents)
    >>> soup.first('h1')
    <h1>Subscribe to request</h1>
    >>> user_browser.getControl('Subscribe').click()

A message confirming that he was subscribed is displayed and the user
name appears in the 'Subscribers' portlet:

    >>> soup = BeautifulSoup(user_browser.contents)
    >>> soup.first('p', 'informational message')
    <p class="informational message">You have subscribed to
    this request.</p>

    >>> portlet = soup.first('div', id='ticket-subscribers')
    >>> portlet.first('h4')
    <h4>Subscribers to request #2:</h4>
    >>> portlet.first('ul')
    <ul class="people">
      <li>
        <a href="http://launchpad.dev/people/name12">Sample Person</a>
      </li>
    </ul>

When the user is subscribed to the ticket, the 'Subscribe' link becomes
an 'Unsubscribe' link. To unsubscribe, the user follows that link and
then click on the 'Unsubscribe' button.

    >>> link = user_browser.getLink('Unsubscribe')
    >>> link.url
    '.../+ticket/2/+subscribe'
    >>> link.click()

    >>> soup = BeautifulSoup(user_browser.contents)
    >>> soup.first('h1')
    <h1>Unsubscribe from request</h1>
    >>> user_browser.getControl('Unsubscribe').click()

A confirmation is displayed and the user, which was unsubscribed from
the ticket, doesn't appear anymore in the subscribers portlet:

    >>> soup = BeautifulSoup(user_browser.contents)
    >>> soup.first('p', 'informational message')
    <p class="informational message">You have unsubscribed from
    this request.</p>

    >>> portlet = soup.first('div', id='ticket-subscribers')
    >>> portlet.first('p')
    <p>
      <i>No subscribers.</i>
    </p>

