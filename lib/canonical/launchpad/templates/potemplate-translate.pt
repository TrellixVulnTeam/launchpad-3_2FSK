<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="context/@@main_template/master"
      i18n:domain="rosetta">

<head>
    <title metal:fill-slot="title">Rosetta: Translating
        <span tal:replace="context/product/displayname">product displayname</span>
        Template <span tal:replace="context/title">template titleM</span></title>
    <!-- Plone style sheet -->
    <style type="text/css" media="screen">@import url(plone.css);</style>
    <!-- Rosetta style sheet -->
    <style type="text/css" media="screen">@import url(rosetta.css);</style>
</head>

<body>

<div metal:fill-slot="portlets_one">
    <label>Quick Reference</label>

    <ul>
    <li><span class="po-message-special" style="padding: 0.2em">&#x21b5;</span>
        &ndash; a new line</li>
    <li><span class="po-message-special" style="padding: 0.2em">&#x2022;</span>
        &ndash; a space character</li>
    </ul>

    <p>
    Check the "needs review" button if you are not sure a translation is
    correct.
    </p>
</div>

<div metal:fill-slot="main">

    <div tal:content="structure view/submitTranslations" />

    <h1>Translating <span tal:replace="context/product/displayname">product
        displayname</span>:  <span tal:replace="context/title">POT file
        title</span></h1>

    <p class="discreet">
      You are translating <a href=".."><span
      tal:replace="context/product/displayname">product
      displayname</span></a> using the Rosetta Translation portal. You can
      read <a href="/rosetta/+about">more about Rosetta</a> or start
      translating <span
      tal:replace="context/product/displayname">product</span> immediately.
    </p>

    <p tal:content="context/product/shortdesc">
        product summary
    </p>

    <p tal:content="context/description">
        template description
    </p>

    <!-- Plural form error message. -->

    <div tal:condition="view/badLanguages">

        <p class="portalMessage">
        This template contains plural messages. To be able to translate these
        messages, we need to have special information for each language.
        However, we do not have this information for
            <span tal:repeat="language view/badLanguages" tal:omit-tag>
               <span tal:replace="language/englishname">language</span>,
            </span>
        please contact the <a
        href="mailto:rosetta-users@lists.ubuntu.com">Rosetta users
        mailing list</a> to resolve this. This procedure only ever needs to be
        done once per language. Once we have the information, you can
        translate into these languages.
        </p>

    </div>

    <!-- No plural form error. -->

    <div tal:condition="not: view/badLanguages">

    <div class="documentDescription">
    Hint: use the <code>Tab</code> key to move quickly between translation fields.
    </div>

    <!-- Display settings. -->

    <form method="post" tal:attributes="action request/URL">
        <fieldset>
        <legend>Display Settings</legend>
            <div class="field">
                <label>Show</label>
                <br/>
                <!--
                Yes, I know, the logic for the 'checked' attributes is
                somewhat evil.
                 - Dafydd Harries, 21/10/2004
                -->
                <label><input name="show" type="radio" value="translated"
                    tal:attributes="checked
                        python:('', 'checked')[view.show == 'translated']" />
                    translated messages</label>
                <br/>
                <label><input name="show" type="radio" value="untranslated"
                    tal:attributes="checked
                        python:('', 'checked')[view.show == 'untranslated']" />
                    untranslated messages</label>
                <br/>
                <label><input name="show" type="radio" value="all"
                    tal:attributes="checked
                        python:('', 'checked')[view.show == 'all']" />
                    all messages</label>
            </div>

            <input type="hidden" name="languages"
                tal:condition="view/codes"
                tal:attributes="value view/codes" />
            <input type="submit" value="Change" />
        </fieldset>
    </form>

    <!-- Show which messages are displayed. -->

    <div tal:condition="view/atBeginning">
        <div tal:condition="view/atEnd">
            Showing all
            <span tal:replace="context/__len__">23</span>
            messages.
        </div>
    </div>

    <div tal:condition="python:
            (not view.atBeginning()) or (not view.atEnd())">
        Showing messages
        <span tal:replace="python: view.offset + 1"
            >5</span>
        &ndash;
        <span tal:replace="python:
            min(len(context), view.offset + view.count)">10</span>
        of
        <span tal:replace="context/__len__">23</span>.
        <span tal:repeat="language view/languages">
            <br />
            <label class="language-code"
                   tal:content="language/englishname">pt_BR</label>:
            <span tal:replace="python:
                view.completeness[language.code]">0</span>%
        </span>
    </div>

    <!-- Navigation doodads. -->

    <div class="listingBar">
        <!-- Link to previous page and beginning, if this is not the beginning page. -->
        <span class="previous" tal:condition="not:view/atBeginning">
            <a tal:attributes="href view/beginningURL">&laquo; Beginning</a>

            <a tal:attributes="href view/previousURL">&laquo; Previous
                <span tal:replace="view/count">5</span> messages</a>
        </span>

        <!-- Link to next page and end, if tis is not the end page. -->
        <span class="next" tal:condition="not:view/atEnd">
            <a tal:attributes="href view/nextURL">Next
                <span tal:replace="view/count">5</span> messages &raquo;</a>

            <a tal:attributes="href view/endURL">End &raquo;</a>
        </span>
        &nbsp;
    </div>

    <!-- The translation form. -->

    <form method="post" tal:attributes="action request/URL">
        <fieldset class="message-strings" tal:repeat="set view/messageSets">
            <input type="hidden"
                tal:attributes="
                    name string:set_${set/id}_msgid;
                    value set/messageID/text
                    " />

            <legend>Message #<span tal:replace="set/sequence">120</span></legend>

            <div class="po-comment" tal:condition="set/sourceComment">
                <label>Developer Note</label>
                <div tal:content="set/sourceComment">This refers to the content type.</div>
            </div>

            <!-- Simple message. -->
            <tal:simple-message condition="not:set/isPlural">
                <label class="language-code">English (Source)</label>:
                <div class="messageSourceString"
                     tal:content="structure set/messageID/displayText">text</div>

                <div tal:repeat="language view/languages">
                    <span class="language-label">
                    <label class="language-code"
                        tal:content="language/englishname">Welsh</label>:
                    </span>

                    <label class="fuzzy-checkbox">
                        Needs review
                        <input type="checkbox" value="fuzzy" tal:attributes="
                            checked python:set['fuzzy'][language];
                            name string:set_${set/id}_fuzzy_${language/code};
                            tabindex: view/makeTabIndex"
                            />
                    </label>

                    <br/>

                    <div class="po-comment"
                        tal:condition="python: set['comments'][language]">
                        <label>Translator Note</label>

                        <div tal:content="python: set['comments'][language]">
                        Translator comment.
                        </div>
                    </div>

                    <input type="text"
                        tal:condition="not:set/messageID/isMultiline"
                        tal:attributes="
                            name string:set_${set/id}_translation_${language/code};
                            value python:set['translations'][language][0];
                            tabindex view/makeTabIndex;
                            " />
                    <textarea
                        tal:condition="set/messageID/isMultiline"
                        tal:attributes="
                            name string:set_${set/id}_translation_${language/code};
                            rows set/messageID/lines;
                            tabindex view/makeTabIndex;
                            "
                        tal:content="python:set['translations'][language][0]
                        "></textarea>
                </div>
            </tal:simple-message>

            <!-- Plural message. -->
            <tal:plural-message condition="set/isPlural">
                <div class="field">
                    <label class="language-code">English Singular</label>:
                    <div class="messageSourceString"
                        tal:content="structure set/messageID/displayText">singular</div>
                </div>

                <div class="field">
                    <label class="language-code">English Plural</label>:
                    <div class="messageSourceString"
                        tal:content="structure set/messageIDPlural/displayText">plural</div>
                </div>

                <div tal:repeat="language view/languages">
                        <label class="language-code"
                            tal:content="language/englishname">pt_BR[0]</label>:

                    <div class="field" tal:repeat="i python:
                            range(view.pluralforms[language.code])">

                        <input type="text"
                            tal:condition="not:set/messageID/isMultiline"
                            tal:attributes="
                                name string:set_${set/id}_translation_${language/code}_${i};
                                value python:set['translations'][language][i];
                                tabindex view/makeTabIndex;
                                " />
                        <textarea
                            tal:condition="set/messageID/isMultiline"
                            tal:attributes="
                                name string:set_${set/id}_translation_${language/code}_${i};
                                rows set/messageID/lines;
                                tabindex view/makeTabIndex;
                                "
                            tal:content="python:set['translations'][language][i]"
                            ></textarea>
                        <!--
                        <img src="/++resource++info.gif" title="Example: 1 dead horse." />
                        -->
                    </div>

                </div>
            </tal:plural-message>

            <fieldset class="collapsible collapsed">
                <legend>Located in</legend>
                <pre tal:content="set/fileReferences"
                    >./plone_forms/discussion_reply_form.pt</pre>
            </fieldset>

        </fieldset>

        <!-- Offset of next page, if not at end. -->
        <input type="hidden" name="offset"
            tal:condition="not: view/atEnd"
            tal:attributes="value python: view.offset + view.count" />
        <input type="hidden" name="languages"
            tal:condition="view/codes"
            tal:attributes="value view/codes" />
        <input type="submit" name="SUBMIT" value="Save"
            tal:attributes="tabindex: view/makeTabIndex" />
    </form>

    </div> <!-- tal:condition="not: view/badLanguages" -->
</div>

</body>
</html>
