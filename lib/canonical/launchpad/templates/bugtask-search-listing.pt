<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="context/@@main_template/master"
      i18n:domain="launchpad">

<body>

<metal:leftportlets fill-slot="portlets_one">
  <div tal:content="structure context/@@+portlet-details" />
  <div tal:content="structure context/distribution/@@+portlet-details|nothing" />
</metal:leftportlets>

<metal:rightportlets fill-slot="portlets_two">
    <tal:block content="structure context/@@+portlet-bugtasklist-mybugs" />
    <tal:releasebugs
        tal:condition="context/@@+portlet-bugtasklist-releasebugs|nothing"
        tal:content="structure context/@@+portlet-bugtasklist-releasebugs" />
</metal:rightportlets>

<div metal:fill-slot="main">

<metal:page
    define-macro="buglisting"
    tal:define="listing_columns view/task_columns;
                task_batch_navigator view/search">

  <tal:tag condition="view/assign_to_milestones|nothing"/>

  <h1>Bugs in <span tal:replace="context/title">Title</span></h1>

  <form name="bugtask_search" action="" method="GET">

    <p>
      <label tal:content="view/searchtext_widget/label">
        Bug id or text:
      </label>
      <tal:searchtext content="structure view/searchtext_widget" />
      <input type="submit" name="search" value="Search" />
      <input type="hidden"
          name="advanced" tal:attributes="value request/advanced|nothing" />
    </p>

    <tal:table_view tal:condition="view/showTableView">
      <table
          metal:use-macro="context/@@+bugtask-macros-tableview/batched-table" />
    </tal:table_view>
    <tal:list_view tal:condition="view/showListView">
      <tal:navigation
          tal:replace="structure task_batch_navigator/@@+navigation-links" />
      <table class="listing" width="67%">
        <thead>
          <tr metal:use-macro="context/@@+bugtask-macros-tableview/sortable-header">
            ID
          </tr>
        </thead>
      </table>

      <table>
        <tr tal:condition="view/showListView"
            tal:repeat="task task_batch_navigator/batch"
            tal:define="show_packagename view/shouldShowPackageName">
          <td tal:condition="view/mass_edit_allowed">
            <input type="checkbox" name="task" tal:attributes="value task/id" />
          </td>
          <metal:taskrow use-macro="task/@@+bugtask-macros-listview/item" />
        </tr>
      </table>
    </tal:list_view>

    <tal:edit tal:condition="view/mass_edit_allowed">
      <tal:block content="structure view/milestone_assignment_widget" />
      <input type="submit" name="assign_to_milestone"
             value="Assign to Milestone" />
    </tal:edit>

    <tal:search-defaults condition="not:view/advanced">
        <input type="hidden" name="status" value="10" />
        <input type="hidden" name="status" value="20" />
        <input type="hidden" name="assignee" value="all" />
    </tal:search-defaults>

    <tal:block condition="view/advanced">
      <h2>Advanced Search Criteria</h2>
      <div class="row">
        <div class="field">
          <table width="67%">

            <tr>
              <td tal:condition="view/status_widget|nothing">
                <label tal:attributes="for view/status_widget/name"
                       tal:content="view/status_widget/label">
                  Status:
                </label>
              </td>
              <td tal:condition="view/severity_widget|nothing">
                <label tal:attributes="for view/severity_widget/name"
                       tal:content="view/severity_widget/label">
                  Severity:
                </label>
              </td>
              <td tal:condition="view/attachmenttype_widget|nothing">
                <label tal:attributes="for view/attachmenttype_widget/name"
                       tal:content="view/attachmenttype_widget/label">
                  Attachment:
                </label>
              </td>
              <td tal:condition="python: view.assignee_widget or
                                         view.statusexplanation_widget">
                <label tal:attributes="for view/assignee_widget/name"
                       tal:condition="view/assignee_widget|nothing"
                       tal:content="view/assignee_widget/label">
                  Assignee:
                </label>
              </td>
            </tr>

            <tr>
              <td tal:condition="view/status_widget"
                  tal:content="structure view/status_widget" />
              <td tal:condition="view/severity_widget"
                  tal:content="structure view/severity_widget" />
              <td tal:condition="view/attachmenttype_widget"
                  tal:content="structure view/attachmenttype_widget" />
              <td tal:condition="python: view.assignee_widget or
                                         view.statusexplanation_widget">

                <tal:block condition="view/assignee_widget">
                  <tal:block content="structure view/assignee_widget" /><br />
                  <tal:block content="structure view/unassigned_widget" />
                  <label style="font-weight: normal;"
                      tal:attributes="for view/unassigned_widget/name"
                      tal:content="structure view/unassigned_widget/label">
                    show only unassigned bugs
                  </label>
                  <br />
                  <tal:block content="structure view/include_dupes_widget" />
                  <label style="font-weight: normal;"
                      tal:attributes="for view/include_dupes_widget/name"
                      tal:content="structure view/include_dupes_widget/label">
                    include duplicate bugs
                  </label>
                  <br /><br />
                </tal:block>

                <tal:block condition="view/statusexplanation_widget">
                  <label
                      tal:attributes="for view/statusexplanation_widget/name"
                      tal:content="view/statusexplanation_widget/label">
                    Status notes:
                  </label>
                  <br />
                  <tal:block content="structure view/statusexplanation_widget" />
                </tal:block>

              </td>
              <td tal:condition="view/milestone_widget|nothing"
                  tal:content="structure view/milestone_widget" />
            </tr>

            <tr>
              <td>
              <input type="submit" name="search" value="Search" />
              </td>
            </tr>

          </table>
        </div>
      </div>
    </tal:block>
  </form>
  <script>
  <!--
  document.forms[0].elements['field.searchtext'].focus();
  //-->
  </script>

</metal:page>

</div>


</body>

</html>
