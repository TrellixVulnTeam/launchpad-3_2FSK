= Adding new projects =

Normal users should not be able to do this:

  >>> user_browser.open("http://launchpad.dev/projectgroups/+new")
  Traceback (most recent call last):
    ...
  Unauthorized:...

But an admin user should be able to do it:

  >>> admin_browser.open('http://launchpad.dev/projectgroups')
  >>> admin_browser.getLink('Register a project').click()
  >>> admin_browser.url
  'http://launchpad.dev/projectgroups/+new'

Testing if the validator is working for the URL field.
Add a new project without the http://

  >>> admin_browser.getControl('Name', index=0).value = 'kde'
  >>> admin_browser.getControl('Display Name').value = 'K Desktop Environment'
  >>> admin_browser.getControl('Title').value = 'K Desktop Environment'
  >>> admin_browser.getControl('Project Summary').value = 'KDE'
  >>> admin_browser.getControl('Description').value = 'K Desktop Environment'
  >>> admin_browser.getControl('Homepage URL').value = 'www.kde.org'
  >>> admin_browser.getControl('Add').click()
  >>> '<p class="error message">There is 1 error.</p>' in admin_browser.contents
  True
  >>> '"www.kde.org" is not a valid URI' in admin_browser.contents
  True


Testing if the validator is working for the name field.

  >>> admin_browser.open('http://launchpad.dev/projectgroups/+new')
  >>> admin_browser.getControl('Name', index=0).value = 'KDE'
  >>> admin_browser.getControl('Display Name').value = 'K Desktop Environment'
  >>> admin_browser.getControl('Title').value = 'K Desktop Environment'
  >>> admin_browser.getControl('Project Summary').value = 'KDE'
  >>> admin_browser.getControl('Description').value = 'K Desktop Environment'
  >>> admin_browser.getControl('Homepage URL').value = 'http://kde.org/'
  >>> admin_browser.getControl('Add').click()
  >>> "Invalid name 'KDE'" in admin_browser.contents
  True

  >>> admin_browser.getControl('Name', index=0).value = 'apache'
  >>> admin_browser.getControl('Add').click()
  >>> ("apache is already in use by another project"
  ... in admin_browser.contents)
  True

Now we add a new project.

  >>> admin_browser.getControl('Name', index=0).value = 'kde'
  >>> admin_browser.getControl('Add').click()
  >>> admin_browser.url
  'http://launchpad.dev/kde'

  >>> anon_browser.open(admin_browser.url)
  >>> 'K Desktop Environment' in anon_browser.contents
  True


