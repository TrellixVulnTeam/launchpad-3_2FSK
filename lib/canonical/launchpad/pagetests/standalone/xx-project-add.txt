Let's test adding a project.

Normal users should not be able to do this:

  >>> user_browser.open("http://launchpad.dev/projects/+new")
  Traceback (most recent call last):
    ...
  Unauthorized:...

But an admin user should be able to do it:

  >>> admin_browser.open('http://launchpad.dev/projects')
  >>> admin_browser.getLink('Register a Project').click()
  >>> admin_browser.url
  'http://launchpad.dev/projects/+new'

Testing if the validator is working for the URL field.
Add a new project without the http://

  >>> admin_browser.getControl('Name', index=0).value = 'apache'
  >>> admin_browser.getControl('Display Name').value = 'the Apache Project'
  >>> admin_browser.getControl('Title').value = 'The Apache Project'
  >>> admin_browser.getControl('Project Summary').value = 'The Apache Project'
  >>> admin_browser.getControl('Description').value = 'The Apache Project'
  >>> admin_browser.getControl('Homepage URL').value = 'www.apache.org'
  >>> admin_browser.getControl('Add').click()
  >>> '<p class="error message">There is 1 error.</p>' in admin_browser.contents
  True
  >>> '"www.apache.org" is not a valid URI' in admin_browser.contents
  True


Testing if the validator is working for the name field.

  >>> admin_browser.open('http://launchpad.dev/projects/+new')
  >>> admin_browser.getControl('Name', index=0).value = 'APACHE'
  >>> admin_browser.getControl('Display Name').value = 'the Apache Project'
  >>> admin_browser.getControl('Title').value = 'The Apache Project'
  >>> admin_browser.getControl('Project Summary').value = 'The Apache Project'
  >>> admin_browser.getControl('Description').value = 'The Apache Project'
  >>> admin_browser.getControl('Homepage URL').value = 'http://www.apache.org'
  >>> admin_browser.getControl('Add').click()
  >>> "Invalid name 'APACHE'" in admin_browser.contents
  True

  >>> admin_browser.getControl('Name', index=0).value = 'ubuntu'
  >>> admin_browser.getControl('Add').click()
  >>> ("ubuntu is already in use by another product, project or distribution"
  ... in admin_browser.contents)
  True

Now we add a new project.

  >>> admin_browser.getControl('Name', index=0).value = 'apache'
  >>> admin_browser.getControl('Add').click()
  >>> admin_browser.url
  'http://launchpad.dev/apache'

  >>> anon_browser.open(admin_browser.url)
  >>> 'The Apache Project' in anon_browser.contents
  True
