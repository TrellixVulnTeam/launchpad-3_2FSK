Filing a public bug on a distribution source package subscribes the bug
reporter, the distribution bug supervisor, if there is one, and all the
package subscribers, if there are any.

    >>> browser.addHeader("Authorization", "Basic mark@example.com:test")

    >>> browser.open(
    ...     "http://localhost:9000/ubuntu/+source/mozilla-firefox/"
    ...     "+filebug")

    >>> browser.getControl(name="field.title").value = "a public bug"
    >>> browser.getControl('Continue').click()

    >>> browser.getControl(name="field.comment").value = (
    ...     "anyone can see this")
    >>> browser.getControl("Submit Bug Report").click()

    >>> bug_id = browser.url.split("/")[-1]
    >>> print browser.url.replace(bug_id, "BUG-ID")
    http://bugs.launchpad.dev/ubuntu/+source/mozilla-firefox/+bug/BUG-ID

We should have three subscribers now. The bug reporter (also a package
subscriber), mark, the distro bug supervisor kamion, and foobar, who is
subscribed to the distribution.

    >>> from itertools import chain
    >>> from zope.component import getUtility
    >>> from lp.bugs.interfaces.bug import IBugSet
    >>> from canonical.launchpad.ftests import login, logout, ANONYMOUS

    >>> def subscriber_names(bug):
    ...     subscribers = chain(
    ...         bug.getDirectSubscribers(),
    ...         bug.getIndirectSubscribers())
    ...     return sorted(subscriber.name for subscriber in subscribers)

    >>> login(ANONYMOUS)

    >>> bugset = getUtility(IBugSet)
    >>> subscriber_names(bugset.get(bug_id))
    [u'kamion', u'mark', u'name16']

    >>> logout()

When filing a security bug, only the bug reporter and registrant are explicitly
Cc'd, because the Ubuntu distribution does not have a security contact.

    >>> from lp.registry.interfaces.distribution import IDistributionSet

    >>> login(ANONYMOUS)
    >>> ubuntu = getUtility(IDistributionSet).getByName("ubuntu")
    >>> ubuntu.security_contact is None
    True
    >>> logout()

    >>> browser.open(
    ...     "http://localhost:9000/ubuntu/+source/mozilla-firefox/"
    ...     "+filebug")
    >>> browser.getControl(name="field.title").value = "a PRIVATE bug"
    >>> browser.getControl('Continue').click()

    >>> browser.getControl(name="field.comment").value = "top sekrit"
    >>> browser.getControl(
    ...     "This bug is a security vulnerability").selected = True
    >>> browser.getControl("Submit Bug Report").click()

    >>> other_bug_id = browser.url.split("/")[-1]
    >>> print browser.url.replace(other_bug_id, "BUG-ID")
    http://bugs.launchpad.dev/ubuntu/+source/mozilla-firefox/+bug/BUG-ID

    >>> login("mark@example.com")

    >>> subscriber_names(bugset.get(other_bug_id))
    [u'mark', u'ubuntu-team']

    >>> logout()
