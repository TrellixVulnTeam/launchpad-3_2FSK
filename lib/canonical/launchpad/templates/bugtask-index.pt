<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="context/@@main_template/master"
      i18n:domain="malone"
>
  <body>
    <metal:heading fill-slot="pageheading">
      <div>
        <tal:icon replace="structure context/fmt:icon" />
        Bug #<tal:bug replace="context/bug/id">3252543</tal:bug>:
      </div>
      <h1 tal:content="context/bug/title">Foo doesn't work</h1>
    </metal:heading>

<metal:leftportlets fill-slot="portlets_one">
    <div tal:replace="structure context/@@+portlet-subscribers" />
    <div tal:replace="structure context/@@+portlet-tickets" />
    <div tal:replace="structure context/@@+portlet-duplicates" />
    <div tal:replace="structure context/@@+portlet-details" />
    <div tal:replace="structure context/target/@@+portlet-details" />
</metal:leftportlets>

<metal:rightportlets fill-slot="portlets_two">
    <div tal:replace="structure context/@@+portlet-search" />
    <div tal:replace="structure context/@@+portlet-specs" />
    <div tal:replace="structure context/@@+portlet-attachments" />
    <div tal:replace="structure context/@@+portlet-cve" />
    <div tal:replace="structure context/@@+portlet-reference" />
    <div tal:replace="structure context/@@+portlet-watch" />
    <div tal:replace="structure context/target/@@+portlet-latestbugs" />
</metal:rightportlets>

<div metal:fill-slot="main">

  <tal:block condition="view/process" />
  <tal:block condition="view/reportBugInContext" />
  <tal:block condition="view/handleSubscriptionRequest" />

  <p class="informational message"
     tal:condition="view/notices"
     tal:repeat="notice view/notices"
     tal:content="notice">
     Reported this bug as also occurring in upstream firefox
  </p>

  <p tal:condition="context/bug/duplicateof" class="informational message">
    This report is a duplicate of
    <a href="#"
       tal:attributes="href context/bug/duplicateof/fmt:url;
                       title context/bug/duplicateof/title"
       tal:content="string:bug #${context/bug/duplicateof/id}">bug 42</a>
  </p>

      <form
        tal:condition="not:view/isReportedInContext"
        class="error message"
        name="alsooccursin"
        method="POST"
      >

    This bug is not recorded as needing to be fixed in the
    <a tal:attributes="href string:${context/target/fmt:url}/+bugs"
       tal:content="context/targetname">upstream firefox</a>
    <tal:product condition="context/product">product.</tal:product>
    <tal:package condition="context/sourcepackagename">package.</tal:package>
    <tal:distribution
      condition="python: (not context.product) and (not context.sourcepackagename)"
    >distribution.</tal:distribution>

    <tal:loggedin condition="request/lp:person">

        <input
          type="submit"
          name="reportbug"
          value="Also Needs Fixing Here"
        />
    </tal:loggedin>
    <tal:notloggedin condition="not:request/lp:person">
      If you wish report it in <tal:block content="context/targetname" />,
      you must <a href="+login">log in</a> first.
    </tal:notloggedin>

        </form>

  <div tal:replace="structure context/@@+headline-tasks" />

  <tal:description
    content="structure context/bug/description/fmt:text-to-html">
    $Bug.description
  </tal:description>

  <form action="."
      tal:attributes="action request/URL"
      method="POST">

  <tal:branches define="bug_branches context/bug/bug_branches"
                condition="bug_branches">
    <strong>Related Branches</strong>
    <p tal:condition="context/bug/private"
         class="warning message">
      This bug is private, so avoid adding public branches here.
    </p>

    <table class="listing">
      <thead>
        <tr>
          <th>Bugfix Status</th>
          <th>Developer</th>
          <th>Revision Hint</th>
        </tr>
      </thead>
      <tbody>
        <tr tal:repeat="bug_branch bug_branches">
          <td>
            <a href="#"
               tal:attributes="href string:${bug_branch/fmt:url}/+status"
               tal:content="bug_branch/status/title">
              Under Development
            </a>
          </td>
          <td tal:content="bug_branch/branch/owner/displayname"></td>
          <td tal:content="bug_branch/revision_hint"></td>
        </tr>
      </tbody>
    </table>
  </tal:branches>

  <tal:message repeat="message context/bug/messages">
    <div class="boardComment"
         tal:condition="python:context.bug.description != message.text_contents">

      <div class="boardCommentDetails">
        <strong tal:content="message/title">$Bugmessage.title</strong>

        Posted by <a href="#" tal:attributes="href message/owner/fmt:url"
                              tal:content="message/owner/browsername|string:(none)">
          $Person.browsername</a>
        at <span tal:replace="message/datecreated/fmt:datetime">Thursday
        13:21</span>
      </div>

      <div class="boardCommentBody">
        <ul tal:condition="message/bugattachments">
          <li tal:repeat="attachment message/bugattachments"
              class="download">
            <a tal:attributes="href attachment/libraryfile/url"
               tal:content="attachment/title">foo.txt</a>
          </li>
        </ul>

        <tal:comment
          content="structure message/text_contents/fmt:text-to-html">
          Comment text.
        </tal:comment>
      </div>

    </div>
  </tal:message>

  <tal:logged-in condition="request/lp:person">
    <fieldset class="collapsible collapsed">
      <legend>Add comment to this bug</legend>
          <label for="subject">Subject:</label>
          <div>
            <input id="subject" name="subject" type="text" size="50"
                   tal:attributes="value context/bug/followup_subject" />
          </div>
          <label for="comment">Comment:</label>
          <div>
            <textarea id="comment" name="comment" rows="10"></textarea>
          </div>
          <div tal:condition="python:not context.bug.isSubscribed(view.user)">
            <input type="checkbox" name="subscribe" id="subscribe"
                   value="Subscribe" />
            <label for="subscribe" style="font-weight: normal">
              E-mail me about changes to this bug report
            </label>
          </div>
          <br />
          <input type="submit" name="save" value="Add Comment" />
    </fieldset>
  </tal:logged-in>
  <tal:not-logged-in condition="not: request/lp:person">
    <div align="center">
      To post a comment you must <a href="+login">log in</a>.
    </div>
  </tal:not-logged-in>
  </form>

</div>
</body>
</html>
