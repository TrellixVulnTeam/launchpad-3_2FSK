Bug Watches
===========

Malone is a bug tracker that understands the structure of the Open
Source world. It's there for people who want to use it, and take
advantage of this infrastructure.

But realistically, not everyone is going to switch to using Malone. To
workaround that in Malone, we have bug watches.

Bug watches watch bugs. More specifically, a bug watch watches a bug
in a bugtracker outside of Malone. By doing this, we can be kept aware
of the status of a bug that lives outside Malone for the benefit of
users and maintainers that are using Malone.

Retrieving Bug Watches
----------------------

Bug watches are accessed via a utility that provides IBugWatchSet.

    >>> from zope.component import getUtility
    >>> from canonical.launchpad.interfaces import IBugWatchSet
    >>> bugwatch = getUtility(IBugWatchSet).get(2)
    >>> bugwatch.remotebug
    u'2000'
    >>> bugwatch.url
    u'http://bugzilla.mozilla.org//show_bug.cgi?id=2000'

Creating Bug Watches
--------------------

To create a bugwatch, use IBugWatchSet.createBugWatch:

    >>> from canonical.launchpad.interfaces import (
    ...     IPersonSet, IBugSet, IBugTrackerSet)

    >>> sample_person = getUtility(IPersonSet).get(12)
    >>> bug_one = getUtility(IBugSet).get(1)
    >>> bmo = getUtility(IBugTrackerSet)['mozilla.org']
    >>> bugwatch = getUtility(IBugWatchSet).createBugWatch(
    ...     bug=bug_one, owner=sample_person, bugtracker=bmo,
    ...     remotebug='1234')
    >>> bugwatch.url
    u'http://bugzilla.mozilla.org//show_bug.cgi?id=1234'


Creating a SF.net Bugtracker
----------------------------

    >>> from canonical.launchpad.interfaces import (
    ...     IBugTrackerSet)
    >>> from canonical.lp.dbschema import BugTrackerType
    >>> bts = getUtility(IBugTrackerSet)
    >>> sf = ("http://sourceforge.net/tracker/?atid=737291"
    ...       "&group_id=136955&func=browse")
    >>> bts.ensureBugTracker(sf, sample_person,
    ...     BugTrackerType.SOURCEFORGE, "GNUTelephony BTS", "My summary", 
    ...     "My contact details", "gnutelephony-bugs")
    <BugTracker at 0x...>
    >>> gtb = getUtility(IBugTrackerSet)['gnutelephony-bugs']

Creating SF.net Bug Watches
---------------------------

The URLifier for these bug watches deals with SF.net's horrible URLs.

    >>> sample_person = getUtility(IPersonSet).get(12)
    >>> bug_one = getUtility(IBugSet).get(1)
    >>> bugwatch = getUtility(IBugWatchSet).createBugWatch(
    ...     bug=bug_one, owner=sample_person, bugtracker=gtb,
    ...     remotebug='1337833')
    >>> bugwatch.url
    u'http://sourceforge.net/tracker/?aid=1337833&group_id=136955&atid=737291&func=detail'

