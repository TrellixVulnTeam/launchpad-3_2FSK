= Distribution Launchpad usage =

The distribution overview page indicates for what usage the
distribution officially uses Launchpad.

    >>> anon_browser.open('http://launchpad.dev/ubuntu')
    >>> print extract_text(find_tag_by_id(anon_browser.contents, 'uses'))
    Ubuntu Linux uses Launchpad for
        Answers, Blueprints, Bug Tracking, and Translations.

Unprivileged Launchpad users cannot access the page for changing these
details.

    >>> user_browser.open('http://launchpad.dev/ubuntu')
    >>> user_browser.getLink('Change distribution details')
    Traceback (most recent call last):
      ...
    LinkNotFound...
    >>> user_browser.open('http://launchpad.dev/ubuntu/+edit')
    Traceback (most recent call last):
      ...
    Unauthorized...

The distribution's registrant can access the page and change the usage.

    >>> registrant = setupBrowser(
    ...     auth='Basic celso.providelo@canonical.com:cprov')
    >>> registrant.open('http://launchpad.dev/ubuntu/+edit')
    >>> print registrant.url
    http://launchpad.dev/ubuntu/+edit

    >>> print registrant.getControl(name='field.official_rosetta').value
    True
    >>> print registrant.getControl(name='field.official_malone').value
    True
    >>> print registrant.getControl(name='field.enable_bug_expiration').value
    True
    >>> print registrant.getControl(name='field.official_blueprints').value
    True
    >>> print registrant.getControl(name='field.official_answers').value
    True

    >>> registrant.getControl(name='field.official_rosetta').value = False
    >>> registrant.getControl('Change', index=3).click()

    >>> print extract_text(find_tag_by_id(registrant.contents, 'uses'))
    Ubuntu Linux uses Launchpad for Answers, Blueprints, and Bug Tracking.

Just like Launchpad administrators can.

    >>> admin_browser.open('http://launchpad.dev/ubuntu')
    >>> admin_browser.getLink('Change distribution details').click()
    >>> print admin_browser.title
    Change distribution details
    >>> print admin_browser.getControl(name='field.official_rosetta').value
    False
    >>> print admin_browser.getControl(name='field.official_malone').value
    True
    >>> print admin_browser.getControl(
    ...     name='field.enable_bug_expiration').value
    True
    >>> print admin_browser.getControl(name='field.official_blueprints').value
    True
    >>> print admin_browser.getControl(name='field.official_answers').value
    True

    >>> admin_browser.getControl(
    ...     name='field.enable_bug_expiration').value = False
    >>> admin_browser.getControl(name='field.official_malone').value = False
    >>> admin_browser.getControl(name='field.official_blueprints').value = (
    ... False)
    >>> admin_browser.getControl(name='field.official_answers').value = False
    >>> admin_browser.getControl('Change', index=3).click()

    >>> print admin_browser.url
    http://launchpad.dev/ubuntu
    >>> print extract_text(find_tag_by_id(admin_browser.contents, 'uses'))
    Ubuntu Linux does not use Launchpad for development.


== enable_bug_expiration and JavaScript ==

JavaScript is used to constrain enable_bug_expiration to distributions
that use Launchpad to track bugs. If the form is submitted before the
page has loaded, the enable_bug_expiration will not be disabled by the
JavaScript function. The constraint is enforced by the view class--the
data is corrected instead of returning a error to the user.

Foo Bar updates Ubuntu to use Launchpad to track bugs, and enables
bug expiration.

    >>> admin_browser.getLink('Change distribution details').click()
    >>> admin_browser.getControl(
    ...     name='field.enable_bug_expiration').value = True
    >>> admin_browser.getControl(name='field.official_malone').value = True
    >>> admin_browser.getControl('Change', index=3).click()

    >>> content = find_main_content(admin_browser.contents)

    >>> print extract_text(find_tag_by_id(admin_browser.contents, 'uses'))
    Ubuntu Linux uses Launchpad for Bug Tracking.

Foo Bar chooses to switch the bug tracker again, but this time he
does not change the the expiration check box, and he does the whole
operation before the page complete loading.

    >>> admin_browser.getLink('Change distribution details').click()
    >>> print admin_browser.getControl(name='field.official_malone').value
    True

    >>> print admin_browser.getControl(
    ...     name='field.enable_bug_expiration').value
    True

    >>> admin_browser.getControl(name='field.official_malone').value = False
    >>> admin_browser.getControl('Change', index=3).click()

    >>> content = find_main_content(admin_browser.contents)
    >>> print extract_text(find_tag_by_id(admin_browser.contents, 'uses'))
    Ubuntu Linux does not use Launchpad for development.

Returning to the edit page, Foo Bar can see that bug expiration was
also disabled.

    >>> admin_browser.getLink('Change distribution details').click()
    >>> print admin_browser.getControl(name='field.official_malone').value
    False

    >>> print admin_browser.getControl(
    ...     name='field.enable_bug_expiration').value
    False
