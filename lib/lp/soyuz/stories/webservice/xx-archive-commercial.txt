=============================================
Using the webservice with commercial archives
=============================================

(See also soyuz/stories/webservice/xx-archive.txt and
soyuz/doc/archive-commercial.txt)

Start by making a commercial PPA that we can fetch via the webservice:

    >>> login("admin@canonical.com")

    >>> import httplib2
    >>> httplib2.debuglevel = 10
    >>> from canonical.launchpad.testing.pages import webservice_for_person
    >>> from canonical.launchpad.webapp.interfaces import OAuthPermission
    >>> from zope.component import getUtility
    >>> from lp.registry.interfaces.person import IPersonSet
    >>> cjwatson = getUtility(IPersonSet).getByName('kamion')

    >>> ppa = factory.makeArchive(private=True, name="cpppa")
    >>> from zope.security.proxy import removeSecurityProxy
    >>> removeSecurityProxy(ppa).commercial = True
    >>> import transaction
    >>> transaction.commit()
    >>> logout()

Commercial archives can be found with a custom method 'getCommercialPPAs'
that lives on the distribution object.

Using webservice directly:

    >>> ubuntu = webservice.get("/ubuntu").jsonBody()
    >>> cppas = webservice.named_get(
    ...     ubuntu['self_link'], 'getCommercialPPAs').jsonBody()
    >>> for entry in cppas['entries']:
    ...     entry['commercial']
    True
