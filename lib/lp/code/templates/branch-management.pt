<div
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  tal:define="context_menu context/menu:context">

  <div tal:condition="not: context/revision_count">
    <div tal:condition="context/branch_type/enumvalue:IMPORTED">
      This branch is updated by the Launchpad import system.
    </div>
  </div>

  <div
    id="browse_url"
    class="portletBody portletContent"
    style="margin-bottom: 1.5em"
    tal:define="link context_menu/source"
    tal:condition="link/enabled"
    >
    <a id="codebrowse-link"
       class="sprite info"
       tal:attributes="href link/url"
       tal:content="link/text" >Browse this branch</a>
  </div>

  <dl id="download-url"
      tal:condition="view/bzr_download_url">
    <dt>Get this branch:</dt>
    <dd>bzr branch <tal:url replace="view/bzr_download_url" /></dd>
  </dl>

  <tal:hosted-branch condition="context/branch_type/enumvalue:HOSTED">
    <tal:not-logged-in condition="not:view/user">
      <tal:individual condition="not:context/owner/isTeam">
          Only
          <a tal:attributes="href context/owner/fmt:url"
             tal:content="context/owner/displayname">Person</a>
          can upload to this branch. If you are
          <tal:branch-owner replace="context/owner/displayname"/>
          please <a href="+login">log in</a> for upload directions.
      </tal:individual>
      <tal:team tal:condition="context/owner/isTeam">
          Members of
          <a tal:attributes="href context/owner/fmt:url"
             tal:content="context/owner/displayname">Team</a>
          can upload to this branch. <a href="+login">Log in</a> for directions.
      </tal:team>
    </tal:not-logged-in>

    <tal:logged-in condition="view/user">
      <tal:can-upload tal:condition="view/user_can_upload">
        <dl id="upload-url">
          <dt>Update this branch:</dt>
          <dd>bzr push <tal:url replace="view/bzr_download_url" /></dd>
        </dl>
        <p tal:condition="not:view/user/sshkeys" id="ssh-key-directions">
          To authenticate with the Launchpad branch upload service, you need
          to <a tal:attributes="href string:${view/user/fmt:url}/+editsshkeys">
            register a SSH key </a>.
        </p>
      </tal:can-upload>

      <tal:cannot-upload condition="not:view/user_can_upload">
        <div id="upload-directions" tal:condition="not:context/owner/isTeam">
          You cannot upload to this branch. Only
          <a tal:attributes="href context/owner/fmt:url"
             tal:content="context/owner/displayname">Person</a>
          can upload to this branch.
        </div>
        <div id="upload-directions" tal:condition="context/owner/isTeam">
          You cannot upload to this branch. Members of
          <a tal:attributes="href context/owner/fmt:url"
             tal:content="context/owner/displayname">Team</a>
          can upload to this branch.
        </div>

      </tal:cannot-upload>

    </tal:logged-in>

  </tal:hosted-branch>



</div>
