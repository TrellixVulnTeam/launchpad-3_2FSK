<tal:root
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  omit-tag="">

<metal:macro define-macro="sourcepackagerelease-rows">

  <tal:comment replace="nothing">
    This macro expects the following variables defined:
    :sourcepackagereleases: A list of SourcePackageRelease objects
  </tal:comment>

  <tr tal:repeat="sourcepackagerelease sourcepackagereleases">
  <tal:define define="spr sourcepackagerelease;
                     distroseries spr/upload_distroseries">
    <td>
      <a tal:attributes="href string:${distroseries/distribution/fmt:url}/+source/${spr/name}"
         class="distrosrcpackage"
         tal:content="spr/sourcepackagename/name">
      </a>
    </td>
    <td>
      <a tal:attributes="href string:${distroseries/fmt:url}/+source/${spr/name}"
         class="distroseriessrcpackage"
         tal:content="distroseries/fullseriesname">
      </a>
    </td>
    <td>
      <a tal:attributes="href string:${distroseries/distribution/fmt:url}/+source/${spr/name}/${spr/version}"
         class="distrosrcpackagerelease"
         tal:content="spr/version">
      </a>
    </td>
    <td
      tal:attributes="title spr/dateuploaded/fmt:datetime"
      tal:content="spr/dateuploaded/fmt:approximatedate">
      2005-10-24
    </td>
    <td>
      <tal:needs_building condition="spr/needs_building">
          Not yet built
      </tal:needs_building>
      <tal:built condition="not: spr/needs_building">
          <tal:failed repeat="build spr/failed_builds">
             <a tal:attributes="href build/fmt:url"
                tal:content="build/distroarchseries/architecturetag" />
          </tal:failed>
          <tal:not_failed condition="not: spr/failed_builds">
             None
          </tal:not_failed>
      </tal:built>
    </td>
    <td style="text-align: right">
      <a tal:attributes="href string:${spr/distrosourcepackage/fmt:url}/+bugs"
         tal:content="spr/open_bugs">
      </a>
    </td>
    <td style="text-align: right">
      <a tal:attributes="href string:${spr/sourcepackage/fmt:url}/+questions"
         tal:content="spr/open_questions">
      </a>
    </td>
  </tal:define>
  </tr>
</metal:macro>

</tal:root>
