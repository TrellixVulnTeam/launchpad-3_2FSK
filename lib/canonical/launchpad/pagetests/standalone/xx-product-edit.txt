Page to edit a product - does the page load as the product owner?

  >>> browser.addHeader('Authorization', 'Basic test@canonical.com:test')

  >>> browser.open('http://launchpad.dev/products/firefox')
  >>> browser.getLink('Edit Product Details').click()
  >>> print browser.url
  http://launchpad.dev/products/firefox/+edit
  >>> print browser.contents
  <!DOCTYPE...
  ...<title>Mozilla Firefox in Launchpad</title>...
  ...<h1>Edit details</h1>...

We try to edit the project related to that product. First with a invalid
project.

  >>> browser.getControl('Project', index=0).value = 'asdasfasd'
  >>> browser.getControl('Change').click()
  >>> for message in find_tags_by_class(browser.contents, 'error'):
  ...     print message
  <p class="error message">
  There is a problem with the information you entered.
  Please fix it and try again.
  </p>
  <div class="error">
  ...
  <div class="message">Invalid value</div>
  </div>


Now we try to edit with a project that exists.


  >>> browser.getControl('Project', index=0).value = 'gnome'
  >>> browser.getControl('Change').click()
  >>> print browser.url
  http://launchpad.dev/products/firefox


Now we test if we edited it successfully. 

  >>> print find_portlet(browser.contents, 'The GNOME Project')
  <div class="portlet">
  ...<h2>The GNOME Project</h2>
  ...
  ...Products:...
  ...Mozilla Firefox...
  ...


Setting Development Focus
=========================

The Firefox product's trunk series is set as the development focus:

  >>> browser.open('http://launchpad.dev/products/firefox')
  >>> print find_portlet(browser.contents, 'Mozilla Firefox')
  <div class="portlet">
  ...
  ...Registered series:...
  ...1.0...
  ...trunk...
  ...(development focus)...
  ...


We can change this to the 1.0 series through the edit form:

  >>> browser.open('http://launchpad.dev/products/firefox/+edit')
  >>> browser.getControl('Development focus').getControl('firefox 1.0').click()
  >>> browser.getControl('Change').click()
  >>> print browser.url
  http://launchpad.dev/products/firefox
  >>> print find_portlet(browser.contents, 'Mozilla Firefox')
  <div class="portlet">
  ...
  ...Registered series:...
  ...1.0...
  ...(development focus)...
  ...trunk...
  ...


Renaming Products
=================

First a user adds a product named newproductname.

  >>> user_browser.open('http://launchpad.dev/products/+new')
  >>> user_browser.getControl('Name', index=0).value = 'newproductname'
  >>> user_browser.getControl('Display Name').value = 'dname'
  >>> user_browser.getControl('Title').value = 'title'
  >>> user_browser.getControl('Summary').value = 'summary'
  >>> user_browser.getControl('Description').value = 'description'
  >>> user_browser.getControl('Add').click()
  >>> print user_browser.url
  http://launchpad.dev/products/newproductname


Then a product named newproductname2.

  >>> user_browser.open('http://launchpad.dev/products/+new')
  >>> user_browser.getControl('Name', index=0).value = 'newproductname2'
  >>> user_browser.getControl('Display Name').value = 'dname2'
  >>> user_browser.getControl('Title').value = 'title2'
  >>> user_browser.getControl('Summary').value = 'summary2'
  >>> user_browser.getControl('Description').value = 'description2'
  >>> user_browser.getControl('Add').click()
  >>> print user_browser.url
  http://launchpad.dev/products/newproductname2
 

Now we try to change newproductname2's name to newproductname.

  >>> admin_browser.open(
  ...     'http://launchpad.dev/products/newproductname2/+review')
  >>> admin_browser.getControl('Name').value = 'newproductname'
  >>> admin_browser.getControl('Change').click()
  >>> for message in find_tags_by_class(admin_browser.contents, 'error'):
  ...     print message
  <p class="error message">
  There is a problem with the information you entered.
  Please fix it and try again.
  </p>
  <div class="error">
  ...
  <div class="message">newproductname is already in use by another product, project or distribution</div>
  </div>


Now we try to change it to newproductname3.  We expect that the change will
be accepted because there is no product called newproductname3

  >>> admin_browser.getControl('Name').value = 'newproductname3'
  >>> admin_browser.getControl('Change').click() 
  >>> print admin_browser.url
  http://launchpad.dev/products/newproductname3
