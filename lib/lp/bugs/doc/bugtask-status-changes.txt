Changing Bug Task Status
========================

Restrictions
------------

There are a few simple rules around who can change the status of a
bug task.  There are three statuses that can only be set by either
the project registrant or the bug supervisor:

 * Won't Fix
 * Expired
 * Triaged

Regular users of Launchpad cannot transition a bug task to any of
these statuses.

An additional restraint is added to Won't Fix.  Only the product
registrant or bug supervisor can change from this status to any
other status.

For more, see lp.bugs.tests.test_bugtask_status.TestBugTaskStatusSetting.

Testing for Permission
----------------------

The method IBugTask.canTransitionToStatus comes in handy here. It
tells us if a transition to a status is permitted. It is *not* a
dry-run of IBugTask.transitionToStatus, but is good enough and fast
enough to be used by UI code, e.g. to display only those statuses to
which a user can transition a particular bugtask.

    >>> owner = factory.makePerson()
    >>> product = factory.makeProduct(owner=owner)
    >>> bugtask = factory.makeBugTask(target=product)
    >>> user = factory.makePerson()

    >>> from lp.bugs.interfaces.bugtask import BugTaskStatus
    >>> bugtask.canTransitionToStatus(BugTaskStatus.WONTFIX, owner)
    True
    >>> bugtask.canTransitionToStatus(BugTaskStatus.WONTFIX, user)
    False

This method is fully tested in
lp.bugs.tests.test_bugtask_status.TestCanTransitionToStatus.
