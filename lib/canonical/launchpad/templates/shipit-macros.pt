<metal:quantity_widgets define-macro="quantity_widgets">
  <tal:comment replace="nothing">
    This macro expects the following variables defined:

    :widgets_matrix: A matrix in which each row contains a ShipItFlavour and
                     one quantity widget for each ShipItArchitecture that we
                     ship CDs. These widgets should always be ordered according
                     to their architectures, and the order should be 
                     the same as in view/ordered_architectures.

    :view/ordered_architectures: A list of ShipItArchitecture objects in the
                                 order they should be diplayed in the UI.
  </tal:comment>

  <table tal:attributes="cols view/ordered_architectures/count:len">
    <tr>
      <thead>
        <th>&nbsp;</th>
        <tal:headers repeat="arch view/ordered_architectures">
          <th tal:content="arch/title" />
        </tal:headers>
      </thead>
    </tr>
    <tr tal:repeat="row widgets_matrix">
      <tal:block repeat="cel row">
      <tal:comment replace="nothing">
        We need to save the widget with this nocall: here because if we
        don't do that, our dear zope will turn it into a string for us.
      </tal:comment>
      <tal:save-widget define="widget nocall:cel">

        <tal:is-header condition="repeat/cel/start">
          <th tal:content="cel" />
        </tal:is-header>
        <tal:is-not-header condition="not: repeat/cel/start">
          <td style="text-align: center">
            <tal:block condition="cel">
              <span metal:use-macro="context/@@shipit_macros/display_raw_widget" />
            </tal:block>
            <span tal:condition="not: cel">n/a</span>
          </td>
        </tal:is-not-header>

      </tal:save-widget>
      </tal:block>
    </tr>
  </table>

</metal:quantity_widgets>


<metal:display_widget define-macro="display_widget">
  <tal:comment replace="nothing">
    This macro expects the following variables defined:
        :widget: The widget that's going to be rendered.
  </tal:comment>

  <th tal:content="widget/label">Label:</th>
  <td>
    <span metal:use-macro="context/@@shipit_macros/display_raw_widget" />
  </td>
</metal:display_widget>


<metal:display_raw_widget define-macro="display_raw_widget">
  <tal:comment replace="nothing">
    This macro expects the following variables defined:
        :widget: The widget that's going to be rendered.
  </tal:comment>

  <div tal:attributes="class python:error and 'error' or None"
       tal:define="error widget/error">
    <span tal:replace="structure widget" />
    <span tal:condition="widget/required"
          class="fieldRequired"
          title="Required">(Required)</span>
    <div tal:condition="error" tal:content="structure error" />
  </div>
</metal:display_raw_widget>


<metal:shipping_details define-macro="shipping_details">
  <tal:comment replace="nothing">
    This macro expects the view to have the following widgets:
      recipientdisplayname_widget
      organization_widget
      addressline1_widget
      addressline2_widget
      city_widget
      province_widget
      postcode_widget
      country_widget
      phone_widget
  </tal:comment>

  <table>
    <tr>
      <tal:block tal:define="widget nocall:view/recipientdisplayname_widget">
        <span metal:use-macro="context/@@shipit_macros/display_widget" />
      </tal:block>
    </tr>
    <tr>
      <tal:block tal:define="widget nocall:view/organization_widget">
        <span metal:use-macro="context/@@shipit_macros/display_widget" />
      </tal:block>
    </tr>
    <tr>
      <tal:block tal:define="widget nocall:view/addressline1_widget">
        <span metal:use-macro="context/@@shipit_macros/display_widget" />
      </tal:block>
    </tr>
    <tr>
      <tal:block tal:define="widget nocall:view/addressline2_widget">
        <span metal:use-macro="context/@@shipit_macros/display_widget" />
      </tal:block>
    </tr>
    <tr>
      <tal:block tal:define="widget nocall:view/city_widget">
        <span metal:use-macro="context/@@shipit_macros/display_widget" />
      </tal:block>
    </tr>
    <tr>
      <tal:block tal:define="widget nocall:view/province_widget">
        <span metal:use-macro="context/@@shipit_macros/display_widget" />
      </tal:block>
    </tr>
    <tr>
      <tal:block tal:define="widget nocall:view/postcode_widget">
        <span metal:use-macro="context/@@shipit_macros/display_widget" />
      </tal:block>
    </tr>
    <tr>
      <tal:block tal:define="widget nocall:view/country_widget">
        <span metal:use-macro="context/@@shipit_macros/display_widget" />
      </tal:block>
    </tr>
    <tr>
      <tal:block tal:define="widget nocall:view/phone_widget">
        <span metal:use-macro="context/@@shipit_macros/display_widget" />
      </tal:block>
    </tr>
  </table>
</metal:shipping_details>


<metal:meta-master define-macro="meta-master">

<metal:doctype define-slot="doctype"><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"></metal:doctype>

<head>
    <title tal:content="CONTEXTS/fmt:pagetitle">Launchpad</title>
    <!-- Launchpad style sheet -->
    <style type="text/css"
        media="screen">@import url(/@@/launchpad.css);</style>
    <!-- Launchpad JS code -->
    <script type="text/javascript" src="/@@/launchpad.js"></script>
    <script type="text/javascript" src="/@@/sorttable.js"></script>

    <metal:extra-head define-slot="extra-head" />

    <style type="text/css">
      <!-- 
        /* Undo Ubuntu's CSS treachery */
        .shipitPortlet {
            font-size: 80%;
         }
        .shipitPortlet .shipitPortletBody {
            position: relative;
            top: -1px;
            background: transparent;
            border: 1px solid #8cacbb;
            padding: 1em;
            margin: 0;
        }
        .shipitPortlet h4 {
          margin: 0;
          background-color: #dee7ec;
          border: 1px solid #8cacbb;
          padding: 0em 0.3em 0em 1em;
          text-transform: lowercase;
          display: block;
          font-size: 1em;
          font-weight: normal;
        }
        #body {
          margin: 1em;
        }
        :link {
          color: #660000;
        }
        :visited {
          color: #993333;
        }
      -->
    </style>

    <metal:block define-slot="head_epilogue"></metal:block>
</head>

  <body>
    <div id="pageWrapper">

      <div id="mastWrapper">
        <div id="masthead">
           <metal:logo define-slot="header-logo" />
           <div id="search">
            <tal:block condition="request/lp:person">
              <form action="/+logout" class="login" method="POST">
                Logged in as <span tal:replace="request/lp:person/displayname" />
                  &ndash;
                <input type="submit" value="Log Out" />
              </form>
            </tal:block>

            <tal:block condition="not: request/lp:person">
              Not logged in &#8212;
              <a href="/">
                Log In / Register
              </a>
            </tal:block>
          </div>
        </div>
      </div>
    </div>

    <div class="visualClear" id="body">
      <tal:maintenance replace="structure context/@@+maintenancemessage" />
      <tal:notifications define="notifications request/notifications"
                         condition="notifications">
        <metal:notifications
          use-macro="context/@@+main-template-macros/notifications" />
      </tal:notifications>

      <metal:block define-slot="body">
      </metal:block>
    </div>

    <div class="visualClear">&nbsp;</div>

    <metal:footer define-slot="footer" />

</body>
</metal:meta-master>
