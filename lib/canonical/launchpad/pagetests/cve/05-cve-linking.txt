Now, lets link this to Malone Bug #5. First, we must check we can see the
linking page. We will have to be logged in, so we will authenticate as
Sample Person.

  >>> print http(r"""
  ... GET /malone/cve/2005-2737/+linkbug HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... """)
  HTTP/1.1 200 Ok
  ...

OK, let's go and POST to the form, requesting this bug to be linked to M#5.

  >>> print http(r"""
  ... POST /malone/cve/2005-2737/+linkbug HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... Content-Length: 301
  ... Content-Type: multipart/form-data; boundary=---------------------------12087313751534540819252901240
  ... 
  ... -----------------------------12087313751534540819252901240
  ... Content-Disposition: form-data; name="field.bug"
  ... 
  ... 5
  ... -----------------------------12087313751534540819252901240
  ... Content-Disposition: form-data; name="FORM_SUBMIT"
  ... 
  ... Continue
  ... -----------------------------12087313751534540819252901240--
  ... """)
  HTTP/1.1 303 See Other
  Content-Length: 0
  ...
  Location: http://.../malone/cve/2005-2737

If we view the page for Bug #5 we should now see this CVE.

  >>> print http(r"""
  ... GET /products/firefox/+bug/5 HTTP/1.1
  ... """)
  HTTP/1.1 200 Ok
  ...2005-2737...

Alright, let's remove that link. First, make sure we can see the unlinkbug
page.

  >>> print http(r"""
  ... GET /malone/cve/2005-2737/+unlinkbug HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... """)
  HTTP/1.1 200 Ok
  ...

And that we can POST to it.

  >>> print http(r"""
  ... POST /malone/cve/2005-2737/+unlinkbug HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... Content-Length: 298
  ... Content-Type: multipart/form-data; boundary=---------------------------1326113566220524952588716955
  ... 
  ... -----------------------------1326113566220524952588716955
  ... Content-Disposition: form-data; name="field.bug"
  ... 
  ... 5
  ... -----------------------------1326113566220524952588716955
  ... Content-Disposition: form-data; name="FORM_SUBMIT"
  ... 
  ... Continue
  ... -----------------------------1326113566220524952588716955--
  ... """)
  HTTP/1.1 303 See Other
  Content-Length: 0
  ...
  Location: http://.../malone/cve/2005-2737

Similarly, we should be able to unlink and re-link a CVE to a bug. Let's
look at Bug #1. We should see that it is linked to CVE 1999-8979.

  >>> print http(r"""
  ... GET /products/firefox/+bug/1 HTTP/1.1
  ... """)
  HTTP/1.1 200 Ok
  ...1999-8979...

Let's remove that link. First, make sure we can see the page.We'll use
Sample Person again.

  >>> print http(r"""
  ... GET /products/firefox/+bug/1/+unlinkcve HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... """)
  HTTP/1.1 200 Ok
  ...

And that we can POST to it.

  >>> print http(r"""
  ... POST /products/firefox/+bug/1/+unlinkcve HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... Content-Length: 317
  ... Content-Type: multipart/form-data; boundary=---------------------------192921188714487939411191642790
  ... 
  ... -----------------------------192921188714487939411191642790
  ... Content-Disposition: form-data; name="field.sequence"
  ... 
  ... 1999-8979
  ... -----------------------------192921188714487939411191642790
  ... Content-Disposition: form-data; name="FORM_SUBMIT"
  ... 
  ... Continue
  ... -----------------------------192921188714487939411191642790--
  ... """)
  HTTP/1.1 303 See Other
  Content-Length: 0
  ...
  Location: http://.../products/firefox/+bug/1

And add it back. Make sure we can see the "Link CVE" page.

  >>> print http(r"""
  ... GET /products/firefox/+bug/1/+linkcve HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... """)
  HTTP/1.1 200 Ok
  ...

And POST to it.

  >>> print http(r"""
  ... POST /products/firefox/+bug/1/+linkcve HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... Content-Length: 314
  ... Content-Type: multipart/form-data; boundary=---------------------------10715549571845379851634356273
  ... 
  ... -----------------------------10715549571845379851634356273
  ... Content-Disposition: form-data; name="field.sequence"
  ... 
  ... 1999-8979
  ... -----------------------------10715549571845379851634356273
  ... Content-Disposition: form-data; name="FORM_SUBMIT"
  ... 
  ... Continue
  ... -----------------------------10715549571845379851634356273--
  ... """)
  HTTP/1.1 303 See Other
  Content-Length: 0
  ...
  Location: http://.../products/firefox/+bug/1


