# identify the component configuration used to define the site:
site-definition site.zcml

# Turn off Zope3 developer mode.
devmode off

# number of bytecode instructions to execute between checks for
# interruptions (SIGINTR, thread switches):
interrupt-check-interval 200

<server>
  type HTTP
  address 9032
</server>

# non-persistent in-memory storage
<zodb>
  <mappingstorage/>
</zodb>

<accesslog>
  # This sets up logging to both a file (access.log) and to standard
  # output (STDOUT).  The "path" setting can be a relative or absolute
  # filesystem path or the tokens STDOUT or STDERR.

  <logfile>
    path /srv/launchpad.net/production-logs/launchpad-access2.log
  </logfile>

</accesslog>

<eventlog>
  # This sets up logging to both a file (z3.log) and to standard
  # output (STDOUT).  The "path" setting can be a relative or absolute
  # filesystem path or the tokens STDOUT or STDERR.

  <logfile>
    path /srv/launchpad.net/production-logs/launchpad2.log
  </logfile>

</eventlog>

# Launchpad configuration. Note that we can specify multiple configurations
# in here. Currently, we have configurations named 'testrunner' (used
# by the testrunner), and 'default' (used by everything else)
#
# The section that is used can be specified by setting the LPCONFIG_SECTION
# environment variable
#
<canonical default>
    # DB settings must still match launchpad-sql-configure-normal.zcml
    dbname launchpad_prod
    dbhost hackberry.canonical.com

    # Display tracebacks on error pages.
    # IMPORTANT: Set to false on production servers!
    show_tracebacks false

    # This is the email address used for the Errors-To: header on
    # all outgoing emails. At somepoint a bounce handler will be
    # installed here to detect failing email addresses and flag them
    # in the database.
    bounce_address bounces@canonical.com

    noreply_from_address noreply@launchpad.net

    pid_dir /srv/launchpad.net/var

    <launchpad>
        dbuser lpnet2
        # Who can use Launchpad as an OpenID provider.
        openid_users openid-testers
        errors_address launchpad-error-reports@lists.canonical.com
        bugs_domain bugs.launchpad.net
        db_statement_timeout 25000
        soft_request_timeout 10000
        default_batch_size 75
        beta_testers_redirection_host edge.launchpad.net
        <launchpad_session>
            dbuser session_lpnet2
            dbhost hackberry.canonical.com
            dbname session_prod
            cookie lp
        </launchpad_session>
        <launchpad_errorreports>
            errordir /srv/launchpad.net/production-logs
            oops_prefix B
            copy_to_zlog false
        </launchpad_errorreports>

        <virtual_hosts>
            use_https yes
            <mainsite>
                hostname launchpad.net
                althostnames localhost, www.launchpad.net, gangotri.ubuntu.com
            </mainsite>
            <api>
                hostname api.launchpad.net
            </api>
            <blueprints>
                hostname blueprints.launchpad.net
            </blueprints>
            <code>
                hostname code.launchpad.net
            </code>
            <translations>
                hostname translations.launchpad.net
            </translations>
            <bugs>
                hostname bugs.launchpad.net
            </bugs>
            <answers>
                hostname answers.launchpad.net
            </answers>
            <openid>
                hostname login.launchpad.net
            </openid>
            <shipitubuntu>
                hostname shipit.ubuntu.com
            </shipitubuntu>
            <shipitkubuntu>
                hostname shipit.kubuntu.org
            </shipitkubuntu>
            <shipitedubuntu>
                hostname shipit.edubuntu.org
            </shipitedubuntu>
            <xmlrpc>
                hostname xmlrpc.launchpad.net
                rooturl https://launchpad.net/
            </xmlrpc>
            <xmlrpc-private>
                hostname xmlrpc-private.launchpad.net
            </xmlrpc-private>
            <feeds>
                hostname feeds.launchpad.net
                # don't link to ssl for feeds
                rooturl http://feeds.launchpad.net/
            </feeds>
        </virtual_hosts>
    </launchpad>

    <librarian>
        # Librarian configuration information for both client and server
        dbuser librarian
        upload_host mizuho.ubuntu.com
        upload_port 9090
        download_host mizuho.ubuntu.com
        download_port 8000
        download_url http://launchpadlibrarian.net/
        buildd_download_url http://launchpadlibrarian.net/
        <librarian_server>
            # Configuration used if we are running a librarian server.
            root /var/tmp/fatsam
        </librarian_server>
    </librarian>

    <distributionmirrorprober>
        dbuser distributionmirror
        cdimage_file_list_url http://releases.ubuntu.com/.manifest
        timeout 30
    </distributionmirrorprober>

    <malone>
        # The From address for Malone email interface errors
        bugmail_error_from_address noreply@bugs.launchpad.net
        buglist_batch_size 75
    </malone>

    <shipit>
        # XXX: salgado 2006-06-16 bug=50033:
        # Even though this is empty, it must be kept so that the default
        # values are used. See https://launchpad.net/bugs/50033 for details.
    </shipit>

    <rosetta>
        # XXX: danilo 2007-02-07 bug=50033:
        # Even though this is empty, it must be kept so that the default
        # values are used. See https://launchpad.net/bugs/50033 for details.
        <rosettaadmin>
        </rosettaadmin>
    </rosetta>

    <zopeless>
        # Configuration specific for code that is running in the Zopeless
        # environment. Hopefully this section will disappear when the
        # Zope and Zopeless environments grow closer.
        send_email true
        smtp_host localhost
        smtp_port 25
    </zopeless>
    <gpghandler>
        host keyserver.internal
        public_host keyserver.ubuntu.com
        port 11371
    </gpghandler>
    <zeca>
        # where the pre-installed key-files will be copied to (every
        # initialization, see lib/zeca/ftest/harness.py)
        root /var/tmp/zeca
    </zeca>
    <buildsequencer>
        mailproblemsto launchpad-error-reports@lists.canonical.com
        launch no
        logfile -
        <buildsequencer_job slave_scanner>
            command cronscripts/buildd-slave-scanner.py
            mindelay 5
        </buildsequencer_job>
    </buildsequencer>

    <processmail>
        dbuser processmail
    </processmail>

    <answertracker>
        dbuser answertracker
    </answertracker>

    <codehosting>
        # XXX: MichaelHudson 2007-08-31
        # Even though this is empty, it must be kept so that the default
        # values are used. See https://launchpad.net/bugs/50033 for details.
    </codehosting>

    <codeimport>
    </codeimport>

    <uploader>
        dbuser uploader
        default_recipient_name Launchpad Archiver
        # This is localhost to ensure security embargo stuff never goes
        # outside the box.
        default_recipient_address lp_archive@localhost
        default_sender_name Ubuntu Installer
        default_sender_address archive@ubuntu.com
    </uploader>

    <personalpackagearchive>
    </personalpackagearchive>

    <archivepublisher>
    </archivepublisher>

    <mailman>
        <mailman-build>
            # If you change anything in this section, you must manually clean
            # and rebuild Mailman.  This will not happen automatically, and
            # Mailman will not build at all if the Mailman package can be
            # imported.

            # Whether Mailman should be built if it is not already.
            build no

            # The --prefix location for the configure script.  This can be a
            # relative path to indicate a location relative to the
            # runlaunchpad.py script's current working directory.
            #prefix lib/mailman

            # The 'VAR_DIR' location.  This is where Mailman will put and look
            # for variable run time data, such as the list pickles and queue
            # directories.
            #var_dir ignore-me

            # The user:group names that the Mailman process will run under.
            # You may need to invoke buildmailman.py or "make run" as root via
            # sudo to have the necessary permissions during the build or run
            # phase.  Leave this commented to use the current user and group.
            #user_group launchpad:launchpad

            # Uncomment this to specify the site list's owner address and
            # password.  Otherwise, a fake email address and random password
            # will be used.
            #site_list_owner you@example.com:password

            # Uncomment this if you want a host_name other than the current
            # machine's `hostname -f`.  This is only used for the email domain
            # part.
            host_name lists.launchpad.net
        </mailman-build>

        # Whether Mailman should be started (i.e mailmanctl start).
        launch no

        # Host and port for connecting to the outgoing smtp server.  Valid
        # format is [host][:port] where the default is localhost:25
        #smtp ignore-me:25

        #xmlrpc_url http://ignore-me
        #xmlrpc_runner_sleep 10

        archive_url_template http://lists.launchpad.net/$$team_name
    </mailman>

</canonical>

# This is the config used by the test runner.
<canonical testrunner>
    dbname launchpad_ftest
    show_tracebacks true
    # chunkydiff may be turned off temporarily to help diagnose test
    # failures, but please don't commit this setting to rocketfuel.
    chunkydiff on

    bounce_address bounces@canonical.com

    <launchpad>
        dbuser launchpad
        errors_address launchpad-error-reports@lists.canonical.com
        bugs_domain bugs.launchpad.net
        <launchpad_errorreports>
            errordir /var/tmp/lperr.test
            oops_prefix T
            copy_to_zlog false
        </launchpad_errorreports>
    </launchpad>
    <librarian>
        dbuser librarian
        upload_host localhost
        upload_port 59090
        download_host localhost
        download_port 58000
        download_url http://localhost:58000/
        buildd_download_url http://localhost:58000/
        <librarian_server>
            launch no
            root /var/tmp/fatsam.test
        </librarian_server>
    </librarian>
    <zopeless>
        send_email false
    </zopeless>
</canonical>
