<div
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  metal:define-macro="comment-box"
  tal:attributes="class comment/css_class">

  <div class="boardCommentDetails" tal:condition="not: comment/bugwatch">
    <tal:comment_has_owner>
      <tal:comment_owner replace="structure comment/owner/fmt:link" />
    </tal:comment_has_owner>
    wrote
    <span
      tal:attributes="title comment/datecreated/fmt:datetime"
      tal:content="comment/datecreated/fmt:displaydate">
      7 minutes ago
    </span>:
    <a tal:attributes="href comment/fmt:url">
      <strong tal:condition="comment/display_title"
              tal:content="comment/title" />
      (permalink)
    </a>
  </div>

  <div class="boardCommentDetails" tal:condition="comment/bugwatch">
    <img tal:replace="structure comment/bugtask/target/image:icon" />
    In
    <a tal:attributes="href comment/bugwatch/url"
       tal:content="comment/bugwatch/title" />,
    <tal:comment_has_owner>
      <tal:comment_owner replace="structure comment/owner/fmt:link" />
    </tal:comment_has_owner>
    wrote
    <span
      tal:attributes="title comment/datecreated/fmt:datetime"
      tal:content="comment/datecreated/fmt:displaydate">
      7 minutes ago
    </span>:
    <a tal:attributes="href comment/fmt:url">
      <strong tal:condition="comment/display_title"
              tal:content="comment/title" />
      (permalink)
    </a>
  </div>

  <div class="boardCommentBody">
    <ul tal:condition="comment/bugattachments" style="margin-bottom: 1em">
      <li tal:repeat="attachment comment/bugattachments"
          class="download">
        <a tal:attributes="href attachment/libraryfile/http_url"
           tal:content="attachment/title">foo.txt</a>
        (<span
           tal:replace="attachment/libraryfile/content/filesize/fmt:bytes" />,
        <span tal:replace="attachment/libraryfile/mimetype" />)
      </li>
    </ul>

    <div style="font-family: monospace;"
      tal:condition="view/user"
      tal:content="structure comment/text_for_display/fmt:email-to-html">
      Comment text.
    </div>

    <div style="font-family: monospace;"
      tal:condition="not:view/user"
      tal:content="structure
        comment/text_for_display/fmt:obfuscate-email/fmt:email-to-html">
      Comment text.
    </div>
    <p tal:condition="comment/was_truncated">
      <a tal:attributes="href comment/fmt:url">Read more...</a>
    </p>
  </div>

</div>
