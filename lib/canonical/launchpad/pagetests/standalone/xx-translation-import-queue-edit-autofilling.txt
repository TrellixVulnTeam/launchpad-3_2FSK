This test is going to test the form prefill so we speedup the productivity
of the Translation import queue reviewers.

First, we need to feed the import queue.

  >>> browser.addHeader('Authorization', 'Basic carlos@canonical.com:test')
  >>> browser.open('http://localhost/products/alsa-utils/trunk/+translations-upload')
  >>> browser.url
  'http://localhost/products/alsa-utils/trunk/+translations-upload'

  >>> import canonical.launchpad
  >>> import os.path
  >>> test_file_name = os.path.join(
  ...     os.path.dirname(canonical.launchpad.__file__),
  ...     'pagetests/standalone/xx-translation-import-queue-edit-autofilling.tar.gz')
  >>> file_control = browser.getControl(name='file')
  >>> file_control.value = open(test_file_name)
  >>> file_control.filename = 'foo.tar.gz'
  >>> browser.getControl(name='translations_upload').click()
  >>> browser.url
  u'http://localhost/products/alsa-utils/trunk/+translations-upload'
  >>> 'Thank you for your upload. 2 files from the tarball will be reviewed' in browser.contents
  True
  >>> print browser.contents

Let's check the values we get by default from the .pot file. As we can see,
the form is completely empty.

  >>> browser.open('http://localhost/rosetta/imports/2')
  >>> browser.url
  u'http://localhost/rosetta/imports/2'
  >>> browser.getControl(name='field.potemplatename').value
  ''
  >>> browser.getControl(name='field.path').value
  ''

Let's fill the information.

  >>> browser.getControl(name='field.potemplatename').value = 'alsa-utils'
  >>> browser.getControl(name='FORM_SUBMIT').click()
  >>> browser.url
  u'http://localhost:9000/rosetta/imports'

Now, as we already know the potemplatename, a new form load should
give us that field with information.

  >>> browser.open('http://localhost/rosetta/imports/2')
  >>> browser.url
  u'http://localhost/rosetta/imports/2'
  >>> browser.getControl(name='field.potemplatename').value
  'alsa-utils'

Let's move to the .po file. By default, we don't know anything about it,
but we can guess the language. As it's a guessed value, we warn the user so
he checks that it's ok.

  >>> browser.open('http://localhost/rosetta/imports/1')
  >>> browser.url
  u'http://localhost/rosetta/imports/1'
  >>> browser.getControl(name='field.potemplatename').value
  ''
  >>> browser.getControl(name='field.path').value
  ''
  >>> browser.getControl(name='field.language').value
  ['es']
  >>> browser.getControl(name='field.variant').value
  ''

Let's add the potemplatename information and confirm the language selection.

  >>> browser.getControl(name='field.potemplatename').value = 'alsa-utils'
  >>> browser.getControl(name='FORM_SUBMIT').click()
  >>> browser.url
  u'http://localhost:9000/rosetta/imports'

And reloading the form, we should get all that information.

  >>> browser.open('http://localhost/rosetta/imports/1')
  >>> browser.url
  u'http://localhost/rosetta/imports/1'
  >>> browser.getControl(name='field.potemplatename').value
  'alsa-utils'
  >>> browser.getControl(name='field.path').value
  ''
  >>> browser.getControl(name='field.language').value
  ['es']
  >>> browser.getControl(name='field.variant').value
  ''
