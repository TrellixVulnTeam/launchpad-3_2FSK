Bugs and Branches
=================

Branches can be linked to Bugs, to track work in progress on branches,
and when fixes are committed.

BugBranch
---------

BugBranch links a bug and a branch.

    >>> from canonical.launchpad.interfaces import (
    ...     IBugSet, IBranchSet)
    >>> from canonical.database.sqlbase import flush_database_updates

    >>> login("foo.bar@canonical.com")

    >>> bugset = getUtility(IBugSet)
    >>> bug = bugset.get(1)
    >>> branch = getUtility(IBranchSet).get(10)

Adding a branch to a bug returns an IBugBranch.

    >>> bug_branch = bug.addBranch(branch)

    >>> flush_database_updates()

The bug and branch fields of the returned bug_branch should reflect our
sample data.

    >>> bug_branch.bug.id
    1
    >>> bug_branch.branch.id
    10

    >>> [bug_branch.branch.name for bug_branch in
    ...  bug.bug_branches]
    [u'mozilla@arch.ubuntu.com_mozilla--release--0.9.2']

By default, a bug branch is in the state BugBranchStatus.INPROGRESS.

    >>> from canonical.lp.dbschema import BugBranchStatus

    >>> bug_branch.status == BugBranchStatus.INPROGRESS
    True

Trying to add a branch that is already linked to a bug will simply
return the existing BugBranch.

    >>> bug_branch_two = bug.addBranch(branch)
    >>> bug_branch_two == bug_branch
    True

You can check if a branch is linked to a bug:

    >>> bug.hasBranch(branch)
    True

    >>> bug_two = bugset.get(2)
    >>> bug_two.hasBranch(branch)
    False

A bug branch also has a whiteboard, so the community can specify things
of interest to others tracking the bugfix on this branch:

    >>> branch = getUtility(IBranchSet).get(1)
    >>> bug_branch_three = bug.addBranch(
    ...     branch, "I should have this fixed today")
    >>> bug_branch_three.whiteboard
    u'I should have this fixed today'

Bugs Related to Branches
------------------------

The bugs related to a branch are accessible via the related_bugs
property.

    >>> [bug.id for bug in branch.related_bugs]
    [1]