Test to check that Rosetta is able to get translation errors.

  >>> user_browser.open(
  ...     "http://launchpad.dev/distros/ubuntu/hoary/+source/evolution/+pots/evolution-2.2/es/+translate?start=20")
  >>> user_browser.url
  'http://launchpad.dev/distros/ubuntu/hoary/+source/evolution/+pots/evolution-2.2/es/+translate?start=20'

We can see current values for the message we will try to change:

  >>> from canonical.launchpad.database import POTMsgSet
  >>> potmsgset = POTMsgSet.get(150)
  >>> pomsgset = potmsgset.getPOMsgSet('es')
  >>> pomsgset.active_texts
  [None, None]

We are going to submit now translations for the singular and plural forms.
We also need to set the checkbox to True so the submit takes care of that
submission and doesn't ignore it.

  >>> user_browser.getControl(name='msgset_150_es_translation_0_new_checkbox').value = True
  >>> user_browser.getControl(name='msgset_150_es_translation_0_new').value = u'Found %s invalid file'
  >>> user_browser.getControl(name='msgset_150_es_translation_1_new_checkbox').value = True
  >>> user_browser.getControl(name='msgset_150_es_translation_1_new').value = u'Found %s invalid files'
  >>> user_browser.getControl(name='submit_translations').click()

We got an error, that means the url should be the same.

  >>> user_browser.url
  'http://launchpad.dev/distros/ubuntu/hoary/+source/evolution/+pots/evolution-2.2/es/+translate?start=20'

And we can see the error.

  >>> for tag in find_tags_by_class(user_browser.contents, 'error'):
  ...     print tag
  <div class="error message">There is an error in a translation you provided. Please correct it before continuing.</div>
  <tr class="error">
    <th colspan="3">
      <strong>Error in Translation:</strong>
    </th>
    <td>
    </td><td>
      <div>
        format specifications in 'msgid' and 'msgstr[0]' for argument 1 are not the sameformat specifications in 'msgid' and 'msgstr[1]' for argument 1 are not the same
      </div>
    </td>
  </tr>

The translation form got an error with the translations we wanted to store,
and thus we still have that text as part of the textareas, otherwise, they
will be empty waiting for new suggestions/translations.

  >>> user_browser.getControl(name='msgset_150_es_translation_0_new_checkbox').value
  True

XXX: CarlosPerelloMarin 20061026: The extra '\n' char is there to workaroud bug #47511

  >>> user_browser.getControl(name='msgset_150_es_translation_0_new').value
  '\nFound %s invalid file'
  >>> user_browser.getControl(name='msgset_150_es_translation_1_new_checkbox').value
  True

XXX: CarlosPerelloMarin 20061026: The extra '\n' char is there to workaroud bug #47511

  >>> user_browser.getControl(name='msgset_150_es_translation_1_new').value
  '\nFound %s invalid files'

Also, we can see previous values remain unchanged:

  >>> pomsgset.active_texts
  [None, None]
