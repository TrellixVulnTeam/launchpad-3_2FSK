<div
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  id="code-review-votes">

<table tal:condition="view/show_table" class="listing compressed">
  <thead>
    <tr>
      <th>Reviewer</th>
      <th>Review Type</th>
      <th>Date Requested</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody>
    <!-- Current reviews -->
    <tr tal:repeat="review view/current_reviews">
      <td>
        <tal:reviewer replace="structure review/reviewer/fmt:link">
        Eric the Reviewer</tal:reviewer>
      </td>
      <td tal:content="review/review_type" />
      <td>
        <tal:date-requested condition="review/date_requested">
          <span tal:attributes="title string:Requested by ${review/registrant/displayname}">
            <tal:date replace="review/date_requested/fmt:approximatedate"/>
          </span>
        </tal:date-requested>
      </td>
      <td>
        <span tal:attributes="class string:vote${review/comment/vote/name}"
              tal:content="review/status_text">
          Approved
        </span>
        <tal:date replace="review/date_of_comment/fmt:displaydate" />
        <a tal:condition="review/show_edit" href="+vote">
          <img src="/@@/edit" title="Vote again" alt="vote"/>
        </a>
      </td>
    </tr>
    <!-- Pending reviews -->
    <tr tal:repeat="review view/requested_reviews">
      <td tal:content="structure review/reviewer/fmt:link" />
      <td tal:content="review/review_type" />
      <td>
        <span tal:attributes="title string:Requested by ${review/registrant/displayname}">
          <tal:date replace="review/date_requested/fmt:approximatedate"/>
        </span>
      </td>
      <td>
        <span class="votePENDING">Pending</span>
        <tal:vote-link condition="review/show_vote_link">
          <a tal:attributes="href string:+vote?claim=${review/reviewer/name}&review_type=${review/review_type}">[Review]</a>
        </tal:vote-link>
      </td>
    </tr>
    <tr tal:condition="view/show_user_review_link">
      <td class="greylink">
        <tal:user replace="structure view/user/fmt:link"/>
      </td>
      <td colspan="2"></td>
      <td>
        <a href="+vote">[Review]</a>
      </td>
    </tr>

    <tal:request-review define="link context/menu:context/request_review"
                        condition="link/enabled">
    <tr tal:condition="view/show_comment_links">
      <td colspan="4" style="text-align:right">
        <div tal:content="structure link/render">
          Request review
        </div>
      </td>
    </tr>
    </tal:request-review>
  </tbody>
</table>

</div>
