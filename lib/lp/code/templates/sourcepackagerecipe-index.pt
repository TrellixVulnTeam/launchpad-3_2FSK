<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  metal:use-macro="view/macro:page/main_side"
  i18n:domain="launchpad"
>

<metal:block fill-slot="head_epilogue">
  <style type="text/css">
    .binary-build .indent {
      padding-left: 2em;
    }
  </style>
</metal:block>

<body>

<tal:registering metal:fill-slot="registering">
  Created by
    <tal:registrant replace="structure context/registrant/fmt:link" />
  on
    <tal:created-on replace="structure context/date_created/fmt:date" />
  and last modified on
    <tal:last-modified replace="structure context/date_last_modified/fmt:date" />
</tal:registering>


<metal:side fill-slot="side">
  <div tal:replace="structure context/@@+global-actions" />
</metal:side>

<div metal:fill-slot="main">
  <div class="yui-g first">
    <div class="yui-u first">
      <div class="portlet">
        <h2>Description</h2>
        <tal:description replace="context/description" />
      </div>
    </div>
    <div class="yui-u">
      <div class="portlet">
        <h2>Recipe information</h2>
        <div class="two-column-list">
          <dl id="build_daily">
            <dt>Build schedule:
              <a href="/+help/recipe-build-frequency.html" target="help" class="sprite maybe">
                &nbsp;<span class="invisible-link">Tag help</span>
              </a>
            </dt>
            <dd tal:content="structure view/daily_build_widget"/>
            <dd>
              <div
                tal:define="link context/menu:context/request_daily_build"
                tal:condition="link/enabled"
                >
                <noscript>
                  <form action="+request-daily-build"
                        method="post"
                        id="request-daily-build-form">
                      <input type="submit" name="field.actions.build"
                          id="field.actions.build" value="Build now" />
                  </form>
                </noscript>
                <a id="request-daily-build" style="display: none"
                   class="sprite source-package-recipe js-action"
                   tal:attributes="href link/url"
                   tal:content="link/text"/>
              </div>
            </dd>
          </dl>

          <dl id="owner">
            <dt>Owner:</dt>
            <dd tal:content="structure view/person_picker"/>
          </dl>
          <dl id="base-branch">
            <dt>Base branch:</dt>
            <dd tal:content="structure context/base_branch/fmt:link" />
          </dl>
          <dl id="debian-version">
            <dt>Debian version:</dt>
            <dd tal:content="context/deb_version_template" />
          </dl>
          <dl id="daily_build_archive">
            <dt>Daily build archive:</dt>
            <dd tal:content="structure view/archive_picker"/>
          </dl>

          <dl id="distros">
            <dt>Distribution series:</dt>
            <dd>
              <ul>
                  <li tal:repeat="curseries context/distroseries"
                      tal:content="structure curseries/fmt:link" />
              </ul>
            </dd>
          </dl>
        </div>
      </div>
    </div>
  </div>

  <div class="yui-g">
    <div id="builds-target" tal:content="structure context/@@+builds" />
  </div>
  <div
    tal:define="link context/menu:context/request_builds"
    tal:condition="link/enabled"
    >
    <a id="request-builds"
       class="sprite add"
       tal:attributes="href link/url"
       tal:content="link/text" />
  </div>
  <div class='portlet'>
    <h2>Recipe contents</h2>
    <pre tal:content="context/recipe_text" />
  </div>

  <tal:script>
    <script id='requestbuild-script' type="text/javascript" tal:content="string:
      LPS.use('io-base', 'lp.code.requestbuild_overlay', function(Y) {
        if(Y.UA.ie) {
            return;
        }
        Y.on('load', function() {
            var logged_in = LP.client.links['me'] !== undefined;
            if (logged_in) {
                build_now_link = Y.one('#request-daily-build');
                if( build_now_link != null ) {
                  build_now_link.setStyle('display', 'block');
                  Y.lp.code.requestbuild_overlay.connect_requestdailybuild();
                }
                Y.lp.code.requestbuild_overlay.connect_requestbuilds();

            }
        }, window);
      });"
    >
    </script>
  </tal:script>
</div>
</body>
</html>
