<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="context/@@main_template_2col/master"
      i18n:domain="malone"
>
  <body>
    <metal:heading fill-slot="pageheading">
      <h1
        tal:condition="view/shouldShowAdvancedForm"
        tal:content="view/getAdvancedSearchPageHeading"
      >Bugs in Fooix: Advanced search</h1>
      <h1 tal:condition="not: view/shouldShowAdvancedForm">
        Bugs in
        <tal:software replace="context/displayname">Fooix</tal:software>
      </h1>
    </metal:heading>
  
    <div metal:fill-slot="head_epilogue">
      <style type="text/css">label {font-weight: normal;}</style>
    </div>

  <metal:leftportlets fill-slot="portlets_one">
    <tal:do_not_show_portlets_advanced_form
      condition="not: view/shouldShowAdvancedForm">
      <tal:block content="structure context/@@+portlet-bugfilters" />
      <tal:releasebugs
         tal:condition="context/@@+portlet-bugtasklist-releasebugs|nothing"
         tal:content="structure context/@@+portlet-bugtasklist-releasebugs" />
     </tal:do_not_show_portlets_advanced_form>
     <tal:show_portlets_advanced condition="view/shouldShowAdvancedForm">
       <div tal:replace="structure context/@@+portlet-details" />
     </tal:show_portlets_advanced>
  </metal:leftportlets>

  <div metal:fill-slot="main">

      <tal:do_not_show_advanced_form 
        condition="not: view/shouldShowAdvancedForm">
      <div tal:define="batch_navigator view/search">
        <form method="get" name="search" action="">
          <input type="text" name="field.searchtext"
                 tal:attributes="value python:request.form.get('field.searchtext', '')" />
          <input type="submit" name="search" value="Search" />
          <a href="?advanced=1"><small>Advanced search</small></a>
          <div style="margin-top: 5px">
            <small>
              Sort by:
              <metal:widget use-macro="context/@@+bugtask-macros-listview/sortwidget" />
            </small>
          </div>
        </form>
        <script type="text/javascript">
          <!--
              document.forms["search"].elements['field.searchtext'].focus();
            -->
        </script>
        <br />
        <tal:buglisting content="structure batch_navigator/@@+table-view" />
      </div>
      </tal:do_not_show_advanced_form>

      <tal:show_advanced condition="view/shouldShowAdvancedForm">
        <metal:advanced_form
          use-macro="context/@@+bugtask-macros-tableview/advanced_search_form" />
      </tal:show_advanced>
    <div class="visualClear">&nbsp;</div>
  </div>

</body>

</html>
