<!--
    This is the main bug page assignments portal. It should show only
    the assignments that are critical to see in the current context.
    Other assignments, in all their glory, can be displayed on a
    specialised assignments page.
-->

<div tal:omit-tag="" tal:define="bug_url string:/malone/bugs/${context/id}">
<table class="listing rowNavigation" style="width: 100%;">
    <thead>
        <tr>
            <th>Upstream / Package</th>
            <th>Status</th>
            <th>Severity</th>
            <th>Priority</th>
            <th>Assigned to</th>
        </tr>
    </thead>


    <tbody>
        <!-- Upstream Assignments -->
        <tr tal:repeat="bugtask context/bugtasks"
            tal:attributes="onclick string:window.location='/malone/tasks/${bugtask/id}/+edit';">
           
            <td>
                <a href=""
                    tal:condition="bugtask/product"
                    tal:attributes="href string:/malone/products/${bugtask/product/name}"
                    >
                    upstream <span tal:content="bugtask/product/name" />
                    $Product.name</a>
                <a href=""
                    tal:condition="python: bugtask.distribution and bugtask.sourcepackagename"
                    tal:attributes="href string:/malone/distros/${bugtask/distribution/name}/${bugtask/sourcepackagename/name}"
                    >
                        <span tal:content="bugtask/distribution/name">
                            distro
                        </span>
                        <span tal:content="bugtask/sourcepackagename/name">
                            sourcepackagename
                        </span>
                </a>
                <a href=""
                    tal:condition="python: bugtask.distribution and not bugtask.sourcepackagename"
                    tal:attributes="href string:/malone/distros/${bugtask/distribution/name}/}"
                    >
                        <span tal:content="bugtask/distribution/name">
                            distro
                        </span>
                </a>
            </td>
            
            <td tal:content="bugtask/status/lp:BugTaskStatus">
                $BugTask.status
            </td>

            <td tal:content="bugtask/severity/lp:BugSeverity"
                tal:attributes="class string:severity${bugtask/severity/lp:BugSeverity}">
                Critical
            </td>

            <td tal:content="bugtask/priority/lp:BugPriority"
                tal:attributes="class string:priority${bugtask/priority/lp:BugPriority}">
                Medium
            </td>
            
            <td>
                <a tal:condition="bugtask/assignee"
                   tal:attributes="href string:/malone/bugs/assigned?name=${bugtask/assignee/name}">
                   <img src="/++resource++user.gif" alt="" 
                    /><span tal:replace="bugtask/assignee/browsername">
                    assignee.browsername
                    </span>
                </a>
            </td>
        
        </tr>

    </tbody>
</table>

<a href="#" tal:attributes="href string:$bug_url/tasks/+upstreamtask"
    style="font-size: 85%; float: right; display: inline; clear: both; text-decoration: none;"
    title="Mark this bug as occurring upstream">
    <img src="/++resource++add.gif" alt="+" />
    File Against Upstream...
</a>

<a href="#" tal:attributes="href string:$bug_url/tasks/+packagetask"
    style="font-size: 85%; float: right; display: inline; clear: both; text-decoration: none;"
    title="Mark this bug as occurring in another package">
    <img src="/++resource++add.gif" alt="+" />
    File Against Package...
</a>
</div>
