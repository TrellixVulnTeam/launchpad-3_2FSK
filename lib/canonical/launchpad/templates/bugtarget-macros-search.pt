<metal:block define-macro="sortwidget_label">
  <label for="orderby">Sorted by:</label>
</metal:block>

<metal:block define-macro="sortwidget">
  <tal:comment condition="nothing">
    This macro expects that the callsite's view class has a shouldShowTargetName
    method.
  </tal:comment>
  <select name="orderby" id="orderby" size="1"
          tal:define="orderby request/orderby|string:-importance">
    <option
      value="-importance"
      tal:attributes="selected python:orderby == '-importance'"
    >by importance</option>
    <option
      value="status"
      tal:attributes="selected python:orderby == 'status'"
    >by status</option>
    <option
      value="milestone"
      tal:attributes="selected python:orderby == 'milestone'"
    >by milestone</option>
    <option
      tal:condition="view/shouldShowTargetName|nothing"
      tal:attributes="selected python:orderby == 'targetname'"
      value="targetname"
    >by location</option>
    <option
      value="datecreated"
      tal:attributes="selected python:orderby == 'datecreated'"
    >oldest first</option>
    <option
      value="-datecreated"
      tal:attributes="selected python:orderby == '-datecreated'"
    >newest first</option>
    <option
      value="-date_last_updated"
      tal:attributes="selected python:orderby == '-date_last_updated'"
    >recently changed</option>
  </select>

</metal:block>

<metal:block define-macro="simple-search-form">
<form method="get" name="search" class="primary search" action=""
      tal:attributes="action search_url|string:">
  <tal:searchbox replace="structure view/widgets/searchtext" />
  <metal:widget use-macro="context/@@+bugtarget-macros-search/sortwidget" />
  <input type="submit" name="search" value="Search" />
  <tal:widget replace="structure view/widgets/status/hidden" />
  <tal:widget replace="structure view/widgets/importance/hidden" />
  <tal:widget replace="structure view/widgets/assignee/hidden" />
  <tal:widget replace="structure view/widgets/bug_reporter/hidden" />
  <tal:widget replace="structure view/widgets/milestone/hidden" />
  <tal:widget replace="structure view/widgets/omit_dupes/hidden" />
  <tal:widget replace="structure view/widgets/has_patch/hidden" />
  <tal:widget replace="structure view/widgets/component/hidden" />
  <tal:widget replace="structure view/widgets/has_no_package/hidden" />
  <a tal:attributes="href advanced_search_url|string:?advanced=1"
  >Advanced search</a>
  <div metal:define-slot="extra-search-widgets">
  </div>
</form>
<script type="text/javascript">
  <!--
      document.forms["search"].elements['field.searchtext'].focus();
    -->
</script>
</metal:block>
