<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="context/@@main_template/master"
      i18n:domain="launchpad">

<head>
    <tal:block metal:fill-slot="head_epilogue">
      <tal:visible_emails condition="not: context/hide_email_addresses">
        <link rel="meta" type="application/rdf+xml" title="FOAF" href="+rdf"
              tal:condition="context/is_valid_person_or_team" />
      </tal:visible_emails>
    </tal:block>
</head>

<body>

<metal:leftportlets fill-slot="portlets_one">
  <div tal:replace="structure context/@@+portlet-emails" />
</metal:leftportlets>

<metal:rightportlets fill-slot="portlets_two">
  <div tal:replace="structure context/@@+portlet-details" />
  <div tal:replace="structure context/@@+portlet-latestquestions" />
</metal:rightportlets>

<div metal:fill-slot="main">

  <tal:icon replace="structure context/image:mugshot" />
  <h1 tal:condition="not:context/isTeam"
  >Who is <tal:name replace="context/browsername">Fred</tal:name>?</h1>
  <h1 tal:condition="context/isTeam" tal:content="context/browsername" />

  <tal:homepage tal:condition="context/homepage_content"
    content="structure context/homepage_content/fmt:text-to-html" />
    <tal:team-description
      replace="structure context/teamdescription/fmt:text-to-html" />

  <tal:valid-person-or-team condition="context/is_valid_person_or_team">
  <div class="left" tal:define="contributions view/contributions">
    <tal:is-team condition="not:context/isTeam">
    <div tal:condition="contributions" class="section">
    <div class="portlet">
      <h2>Most active in</h2>
      <table class="contributions" id="contributions">
        <tbody>
          <tal:contributions repeat="contribution contributions">
          <tr tal:define="project contribution/project;
                          project_categories contribution/categories">
            <th>
              <a tal:attributes="href project/fmt:url"
                 tal:content="project/title">Project</a>
            </th>
            <td tal:repeat="category view/contributed_categories">
              <tal:icon condition="python: category in project_categories"
                        replace="structure category/image:icon" />
            </td>
          </tr>
          </tal:contributions>
        </tbody>
      </table>
    </div>
    </div>
    </tal:is-team>
    <div tal:condition="not:context/isTeam" class="section">
    <div class="portlet">
      <h2>Team memberships</h2>
      <table tal:condition="context/myactivememberships">
        <tr tal:repeat="membership context/myactivememberships">
          <td><img src="/@@/team" /></td>
          <td>
            <div>
              <a
                tal:attributes="
                  href membership/team/fmt:url;
                  title membership/team/teamdescription/fmt:shorten/80"
                tal:content="membership/team/browsername"
              >Team name</a>
            </div>
            <div>
              Joined
              <span
                tal:attributes="title membership/datejoined/fmt:datetime"
                tal:content="membership/datejoined/fmt:displaydate" />
            </div>
          </td>
        </tr>
      </table>

      <p tal:condition="not: context/myactivememberships">
        <span tal:replace="context/browsername">Foo Bar</span> is not an
        active member of any Launchpad teams.
      </p>
    </div>
    </div>

    <tal:recent-members condition="context/isTeam">
    <div tal:condition="view/recently_approved_members" class="section">
    <div class="portlet">
      <h2>Recently approved</h2>
      <ul>
        <li class="person"
            tal:repeat="person view/recently_approved_members">
          <a tal:attributes="href person/fmt:url"
             tal:content="person/unique_displayname"
          >Foo Bar (name16)</a>
        </li>
      </ul>
    </div>
    </div>
    <div tal:condition="view/recently_proposed_members" class="section">
    <div class="portlet">
      <h2>Recently applied</h2>
      <ul>
        <li class="person"
            tal:repeat="person view/recently_proposed_members">
          <a tal:attributes="href person/fmt:url"
             tal:content="person/unique_displayname"
          >Foo Bar (name16)</a>
        </li>
      </ul>
    </div>
    </div>
    </tal:recent-members>
  </div>

  <div class="right">
    <div class="section">
    <div class="portlet">
      <h2 tal:condition="not: context/isTeam">Contact details</h2>
      <h2 tal:condition="context/isTeam">Team and membership summary</h2>
      <table class="summary">
        <tbody>
          <tr tal:condition="context/teamowner">
            <th>Team owner:</th>
            <td>
              <a
                tal:attributes="href context/teamowner/fmt:url"
                tal:content="context/teamowner/browsername"
              >sabdfl</a>
            </td>
          </tr>
          <tr tal:condition="context/teamowner">
            <th>Membership:</th>
            <td>
              <span tal:replace="context/all_member_count">12</span>
              (<span
                tal:replace="context/subscriptionpolicy/title">Moderated</span>)
            </td>
          </tr>
          <tr tal:condition="context/icon">
            <th>Icon:</th>
            <td><tal:icon replace="structure context/image:icon" /></td>
          </tr>
          <tr tal:condition="context/allwikis">
            <th>Wiki:</th>
            <td>
              <span tal:repeat="wiki context/allwikis">
                <a tal:content="wiki/wikiname"
                   tal:attributes="href wiki/url"
                 >WikiName</a><tal:block condition="not: repeat/wiki/end">,
                 </tal:block>
              </span>
            </td>
          </tr>
          <tr tal:repeat="ircnick context/ircnicknames">
            <th>IRC:</th>
            <td><code style="font-size: 120%"
                      tal:content="ircnick/nickname"/>
                on network <code style="font-size: 120%"
                                 tal:content="ircnick/network" />
            </td>
          </tr>
          <tr tal:condition="context/jabberids">
            <th>Jabber:</th>
            <td>
              <tal:block repeat="jabber context/jabberids">
                <span tal:replace="jabber/jabberid"
                  /><span tal:condition="not: repeat/jabber/end">,</span>
              </tal:block>
            </td>
          </tr>
          <tr tal:condition="context/gpgkeys">
            <th>OpenPGP keys:</th>
            <td>
              <tal:block repeat="key context/gpgkeys">
                <a tal:attributes="href key/keyserverURL">
                  <span tal:replace="key/keyid"
                    /></a><span tal:condition="not: repeat/key/end">,</span>
              </tal:block>
            </td>
          </tr>
          <tr tal:condition="context/sshkeys">
            <th>SSH Keys:</th>
            <td>
              <a href="+sshkeys">
                <span tal:replace="context/sshkeys/count">0</span> SSH key(s)
              </a>
            </td>
          </tr>
          <tr tal:condition="context/teams_with_icons/count">
            <th></th>
            <td>
              <a tal:repeat="team context/teams_with_icons"
                 tal:attributes="href team/fmt:url"
                ><img tal:attributes="src team/icon/getURL;
                                      title string:Icon of ${team/name}"
              /></a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    </div>

    <tal:not-team condition="not:context/isTeam">
    <div id="working-on"
         tal:define="bugtasks view/getBugsInProgress;
                     specs context/assigned_specs_in_progress"
         tal:condition="python: bugtasks or specs">
    <div class="section">
    <div class="portlet">
      <h2>Working on&#8230;</h2>
      <ul class="bug">
        <li tal:repeat="bugtask bugtasks">
          <div><a tal:attributes="href bugtask/fmt:url">
          <span tal:replace="
                string: ${bugtask/bug/id}. ${bugtask/bug/title}" /></a>
          <span tal:content="string: ${bugtask/targetname}, reported by ${bugtask/owner/displayname}" />
          </div>
        </li>
      </ul>
      <div tal:condition="bugtasks">
        <a tal:attributes="href view/getURLToAssignedBugsInProgress">
          &raquo; Show all bugs in progress 
        </a>
      </div>
    </div>
    </div>
    <div class="section">
    <div class="portlet">
      <ul class="blueprint">
        <li tal:repeat="spec specs">
          <div>
            <a tal:attributes="href spec/fmt:url">
            <span tal:replace="spec/title" /></a>
          </div>
        </li>
      </ul>
      <div tal:condition="specs">
        <tal:comment condition="nothing">
          XXX: This link should point to a list of the in-progress specs
          assigned to this person, but we don't have a way to list that
          right now, wo we'll have to list all incomplete specs assigned
          to the person. -- Guilherme Salgado, 2007-02-12
        </tal:comment>
        <a tal:attributes="href string:${context/fmt:url}/+specs?role=assignee">
          Show all assigned blueprints
        </a>
      </div>
    </div>
    </div>
    </div>
    </tal:not-team>

    <div tal:condition="context/isTeam" class="section">
    <div class="portlet">
      <h2>Subteam of</h2>

      <p tal:condition="not:context/getSuperTeams">
        &#8220;<span tal:replace="context/browsername"/>&#8221;
        itself is not a member of any other team.
      </p>

      <tal:block condition="context/getSuperTeams">
        <p>
          &#8220;<span tal:replace="context/browsername"/>&#8221;
          is a member of these teams:
        </p>
        <ul>
          <li tal:repeat="team context/getSuperTeams">
            <a tal:attributes="href team/fmt:url"
               tal:content="team/browsername">name</a>
          </li>
        </ul>
      </tal:block>
    </div>

    <div class="section">
    <div class="portlet">
      <h2>Your involvement</h2>

      <p tal:condition="not: request/lp:person">
        You must <a href="+login">log in</a>
        to join or leave this team.
      </p>
      <tal:block condition="request/lp:person">
        <tal:block condition="view/userIsOwner">
          <p tal:condition="view/userIsActiveMember">
            You are the owner of this team.
          </p>
          <p tal:condition="not: view/userIsActiveMember">
            You are the owner of this team,
            but not currently an active member.
          </p>
        </tal:block>
        <tal:block condition="not: view/userIsOwner">
          <p tal:condition="view/userIsActiveMember">
            You are a member of this team.
          </p>
          <p tal:condition="not: view/userIsActiveMember">
            <tal:foo tal:condition="not: view/userIsParticipant">
              You are not a member of this team.
            </tal:foo>
            <tal:foo tal:condition="view/userIsParticipant">
              You are an indirect member of this team:
              <br />
              <a tal:attributes="href view/user/fmt:url"
                 tal:content="view/user/displayname">
                Guilherme Salgado
              </a>
              <tal:path repeat="team view/findUserPathToTeam">
                &rarr;
                <a tal:attributes="href team/fmt:url"
                   tal:content="team/displayname">
                  Launchpad Developers
                </a>
              </tal:path>
            </tal:foo>
          </p>
        </tal:block>
      </tal:block>
    </div>
    </div>
  </div>
  </tal:valid-person-or-team>

  <tal:invalid-person condition="not: context/is_valid_person_or_team">
    <p><span tal:replace="context/browsername" /> does not use Launchpad.
      <tal:block condition="context/creation_comment">
        This page was created
        <span
          tal:attributes="title context/datecreated/fmt:datetime"
          tal:content="context/datecreated/fmt:displaydate" />
        <tal:user-created
          condition="context/creation_rationale/enumvalue:USER_CREATED">
          by <a tal:attributes="href context/registrant/fmt:url">
          <span tal:replace="context/registrant/browsername">Foo</span></a>,
          and the reason given by that user for its creation is:
          <em tal:content="structure context/creation_comment/fmt:text-to-html">
            reason</em>
        </tal:user-created>
        <tal:not-user-created
          condition="not: context/creation_rationale/enumvalue:USER_CREATED">
          <strong tal:content="context/creation_comment" />.
        </tal:not-user-created>
      </tal:block>
      <tal:block condition="not: context/creation_comment">
        This page was created
        <span
          tal:attributes="title context/datecreated/fmt:datetime"
          tal:content="context/datecreated/fmt:displaydate" />.
      </tal:block>
    </p>

    <tal:logged-in condition="request/lp:person">
      <a tal:attributes="
        href string:/people/+requestmerge?field.dupeaccount=${context/name}"
      >Hey, I'm <span tal:replace="context/browsername" /></a>
    </tal:logged-in>

    <tal:not-logged-in condition="not: request/lp:person">
      <a href="+claim">Hey, I'm <span tal:replace="context/browsername" /></a>
    </tal:not-logged-in>
  </tal:invalid-person>

</div>
</body>
</html>
<!-- 1-0 in-progress Needs table of contributions (bug 81224), list of current bugs (bug 81221) and blueprints (bug 81222). -->
