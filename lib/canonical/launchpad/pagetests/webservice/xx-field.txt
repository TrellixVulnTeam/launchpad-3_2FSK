= Field resources =

It's possible to get the value of one particular field. You can get a
JSON or XHTML-fragment representation.

    >>> import simplejson
    >>> def set_display_name(name):
    ...     """Sets salgado's display name."""
    ...     representation = {'display_name': name}
    ...     ignore = webservice('/~salgado', 'PATCH',
    ...                         simplejson.dumps(representation))

    >>> set_display_name("<b>Guilherme Salgado</b>")

    >>> print webservice.get('/~salgado/display_name')
    HTTP/1.1 200 Ok
    ...
    Content-Type: application/json
    ...
    "<b>Guilherme Salgado</b>"

    >>> print webservice.get('/~salgado/display_name', 'application/xhtml+xml')
    HTTP/1.1 200 Ok
    ...
    Content-Type: application/xhtml+xml
    ...
    &lt;b&gt;Guilherme Salgado&lt;/b&gt;

    >>> set_display_name("Guilherme Salgado")


= Supported methods =

Field resources are read-only.

    >>> for method in ['HEAD', 'POST', 'PUT', 'DELETE', 'OPTIONS']:
    ...     print webservice("/~salgado/display_name", method)
    HTTP/1.1 405 Method Not Allowed
    Allow: GET
    ...
    HTTP/1.1 405 Method Not Allowed
    Allow: GET
    ...
    HTTP/1.1 405 Method Not Allowed
    Allow: GET
    ...
    HTTP/1.1 405 Method Not Allowed
    Allow: GET
    ...
    HTTP/1.1 405 Method Not Allowed
    Allow: GET
    ...


= Conditional GET =

Field resources have ETags independent of their parent entries. They
respond to conditional GET.

    >>> response = webservice.get('/~salgado')
    >>> salgado_etag = response._response.getHeader('ETag')

    >>> response = webservice.get('/~salgado/display_name')
    >>> etag = response._response.getHeader('ETag')

    >>> salgado_etag == etag
    False

    >>> print webservice.get('/~salgado/display_name',
    ...                      headers={'If-None-Match': etag})
    HTTP/1.1 304 Not Modified
    ...

    >>> set_display_name("new display name")
    >>> print webservice.get('/~salgado/display_name',
    ...                      headers={'If-None-Match': etag})
    HTTP/1.1 200 Ok
    ...

    >>> set_display_name("Guilherme Salgado")


= Custom representations =

Every entry has an XHTML representation. The default representation is
a simple text node.

  >>> print webservice.get('/~salgado/display_name', 'application/xhtml+xml')
  HTTP/1.1 200 Ok
  ...
  Guilherme Salgado

But it's possible to define a custom HTML view for a particular object
type. Here's a simple view that serves some hard-coded HTML.

  >>> class DummyView:
  ...
  ...     def __init__(*args):
  ...         pass
  ...
  ...     def __call__(*args):
  ...         return "<html>foo</html>"

Register the view as the WebServiceLayer view for an IPerson entry...

  >>> from canonical.lazr.interfaces.rest import WebServiceLayer
  >>> from canonical.launchpad.interfaces import IPerson
  >>> from zope.schema.interfaces import IText
  >>> from zope.interface.interfaces import IInterface
  >>> view_name = "canonical.lazr.rest.resource.EntryFieldResource"
  >>> from zope.component import getGlobalSiteManager
  >>> manager = getGlobalSiteManager()
  >>> manager.registerAdapter(
  ...      factory=DummyView, required=[IPerson, IText, WebServiceLayer],
  ...      provided=IInterface, name=view_name)

...and the XHTML representation of an IPerson will be the result of
calling a DummyView object.

  >>> print webservice.get('/~salgado/display_name', 'application/xhtml+xml')
  HTTP/1.1 200 Ok
  ...
  <html>foo</html>

Before we continue, here's some cleanup code to remove the custom view
we just defined.

  >>> from zope.component import getGlobalSiteManager
  >>> ignored = getGlobalSiteManager().unregisterAdapter(
  ...      factory=DummyView, required=[IPerson, IText, WebServiceLayer],
  ...      provided=IInterface, name=view_name)

  >>> print webservice.get('/~salgado/display_name', 'application/xhtml+xml')
  HTTP/1.1 200 Ok
  ...
  <dl ...>
  ...
  </dl>
