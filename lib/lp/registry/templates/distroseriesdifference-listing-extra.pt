<tal:root
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  i18n:domain="launchpad">

  <metal:macros tal:replace="nothing">
    <metal:macro-derived metal:define-macro="base-to-derived">
      <span tal:replace="context/base_version">1.1.1</span> to
      <span tal:replace="context/derived_series/displayname">
        Derilucid</span> version: 
      <span tal:replace="context/source_version">1.2.3</span>
    </metal:macro-derived>

    <metal:macro-parent metal:define-macro="base-to-parent">
      <span tal:replace="context/base_version">1.1.1</span> to
      <span tal:replace="context/derived_series/parent_series/displayname">
        Lucid</span> version: 
      <span tal:replace="context/parent_source_version">1.2.4</span>
    </metal:macro-parent>
  </metal:macros>

  <tal:show_options condition="view/show_edit_options">
    <div class="blacklist-options" style="float:right">
      <dl>
        <dt>Blacklisted:</dt>
        <dd>
          <form><tal:replace replace="structure view/widgets/blacklist_options" /></form>
        </dd>
      </dl>
  </div>
  </tal:show_options>

  <dl>
    <dt>Binary descriptions:</dt>
      <dd><ul>
        <li tal:repeat="summary view/binary_summaries">
          <tal:description replace="summary" /></li>
      </ul></dd>
    <dt>Last common version:</dt>
    <dd tal:content="context/base_version">1.2.1</dd>
    <span
      tal:condition="python: not(context.package_diff) or not(context.parent_package_diff)"
      class="package-diff-button"></span>
    <dt>Differences from last common version:</dt>
    <dd>
      <ul class="package-diff-status">
        <tal:source-diff-option condition="context/source_pub">
          <li tal:condition="context/package_diff">
            <span tal:condition="context/package_diff/status/enumvalue:PENDING"
              class="PENDING">
              <span tal:replace="context/base_version">1.1.1</span> to
                <span metal:use-macro="template/macros/base-to-derived" />
            </span>

            <span tal:condition="context/package_diff/status/enumvalue:FAILED"
              class="FAILED">
              <span tal:replace="context/base_version">1.1.1</span> to
                <span metal:use-macro="template/macros/base-to-derived" />
            </span>

            <span tal:condition="context/package_diff/status/enumvalue:COMPLETED"
              class="COMPLETED">
              <a tal:attributes="href context/package_diff_url">
                <span metal:use-macro="template/macros/base-to-derived" />
              </a>
            </span>
          </li>
          <li tal:condition="not: context/package_diff">
            <span class="request-derived-diff derived">
              <span metal:use-macro="template/macros/base-to-derived" />
            </span>
          </li>
        </tal:source-diff-option>

        <tal:parent-diff-option condition="context/parent_source_pub">
          <li tal:condition="context/parent_package_diff">
            <span tal:condition="context/parent_package_diff/status/enumvalue:PENDING"
              class="PENDING parent">
              <span tal:replace="context/base_version">1.1.1</span> to
                <span metal:use-macro="template/macros/base-to-parent" />
            </span>

            <span tal:condition="context/parent_package_diff/status/enumvalue:FAILED"
              class="FAILED">
              <span tal:replace="context/base_version">1.1.1</span> to
                <span metal:use-macro="template/macros/base-to-parent" />
            </span>

            <span tal:condition="context/parent_package_diff/status/enumvalue:COMPLETED"
              class="COMPLETED">
              <a tal:attributes="href context/parent_package_diff_url">
                <span metal:use-macro="template/macros/base-to-parent" />
              </a>
            </span>
          </li>
          <li tal:condition="not: context/parent_package_diff">
            <span class="request-derived-diff parent">
              <span metal:use-macro="template/macros/base-to-parent" />
            </span>
          </li>
        </tal:parent-diff-option>

      </ul>
    </dd>
  </dl>

  <h2>Comments:</h2>
  <tal:conversation replace="structure view/@@+render"/>
  <tal:show_options condition="view/show_edit_options"
                    define="src_name context/source_package_name/name">
  <div tal:attributes="class string:add-comment-placeholder ${src_name}"></div>
  </tal:show_options>

</tal:root>
