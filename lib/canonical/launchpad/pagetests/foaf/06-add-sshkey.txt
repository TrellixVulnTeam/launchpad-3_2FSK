
The +editsshkeys page can be used to upload a public ssh key or to remove
an already uploaded one.

    >>> browser.addHeader(
    ...     'Authorization', 'Basic guilherme.salgado@canonical.com:zeca')
    >>> browser.open('http://launchpad.dev/~salgado/+editsshkeys')
    >>> browser.url
    'http://launchpad.dev/~salgado/+editsshkeys'

    >>> print browser.contents
    <!DOCTYPE...
    ...<h2>Add an SSH key</h2>...
    ...


Any key must be of the form "keytype keytext comment", where keytype must be
either ssh-rsa or ssh-dss.  If the key doesn't match the expected format, an
error message will be shown.


    >>> sshkey = "ssh-rsa   "
    >>> browser.getControl(name='sshkey').value = sshkey
    >>> browser.getControl('Import Public Key').click()
    >>> for tag in find_main_content(browser.contents)('p', 'error message'):
    ...     print tag.renderContents()
    Invalid public key

    >>> sshkey = "ssh-rsa foo"
    >>> browser.getControl(name='sshkey').value = sshkey
    >>> browser.getControl('Import Public Key').click()
    >>> for tag in find_main_content(browser.contents)('p', 'error message'):
    ...     print tag.renderContents()
    Invalid public key

    >>> sshkey = "ssh-xsa foo comment"
    >>> browser.getControl(name='sshkey').value = sshkey
    >>> browser.getControl('Import Public Key').click()
    >>> for tag in find_main_content(browser.contents)('p', 'error message'):
    ...     print tag.renderContents()
    Invalid public key


Now, Salgado will upload one RSA and one DSA keys, matching the expected
format.

    >>> sshkey = "ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA6VVQrIoBhxSB7duD69PRzYfdJz3QNUky5lSOpl6a9hEP9iAU72RK3fr4uaYiEEjr70EDAROCimi/rtkBuWCRmPJbQDpzBoZ7PDW/jF5tWAuC4+5z/fy05HOhHRH8WGzeEuWn5HBflcx1QasMD95oDiiEuQbF/kGxBM5/no/4FeJU3fgc+1XQNH7tMDQIcaqoHarc2kefGC8/sbRwbzajhg9yeqskgs6o6y+7931/bcZSLZ/wU53m5nB7eVkkVihk7KD+sf9jKG91LnaRW1IjBgo8AAbXl+e556XkwIwVoieKNYW2Fvw8ybcW5rCTvJ1e/3Cvo2hw8ZsDMRofSifiKw== salgado@canario"
    >>> browser.getControl(name='sshkey').value = sshkey
    >>> browser.getControl('Import Public Key').click()
    >>> soup = find_main_content(browser.contents)
    >>> for tag in soup('p', 'informational message'):
    ...     print tag.renderContents()
    SSH public key added.

    >>> sshkey = "ssh-dss AAAAB3NzaC1kc3MAAAEBAObOoy3fScSSQPHE/V6tPGoFzo5y1JRjDLcs8CNcvIHh9L27Qdj6h18AXn6MUCvvSCKm49aHpp1Xe14a6fmEIesjz6VopPWGENaOwRmhH6zfqM6imKUXQ0sq9p0znYb0TMjyRC0/AmqYneUF6FA2mVXygkGAkp/vDRPFQhPwnHpVD9TVPxHBQdHgM3bTo2TT+GoL7kw/s32ZiAH4OPvN5fN7bCkQWoUs/ySfoNbISMdvdtq07Rra2Biwzgjjs0ZcKbMicbDyYCe4gXlqK4wqcDfcwgrdqdG6NM0LUdekarWjnv0pMb6ttUl4U7e7Nf+eGkiTVItlppC8DyrnqC9SKCUAAAAVAOlEYNobJottyObVWQcrU8eAP4T5AAABAQDmJmL4DcQ1GVvw1Pjy57V0WUyGrOVBRVz7BwYBIvMA7xJCCvzd47mYWrWJkjV6O3tw2vG5oZx+BXE+ve8O6jL89CrwqncoUS8WHCojRmuUHTmtCCiRBCH+/68HMCusO3Blk//kQSsaqfIn+8Xa56Vr2SweSUlLgjvb51+89JJ13oDlUvdftW2GZu+grbmojqcoJ1LVAI5n0qsDItsFid46f8XfNzPeksasY9JbY5fKq/xf1KcgXL2F9XwmrDjFCuI4/xkJWNfGwaLKC/cbrJ1xmvPLl1/Hm5kNqgrwpNwHVOwyYSCUqXroU5PnpE9uydHUhjhtU2K2Hj0i7fOyxoxyAAABAQCpXKgd6lpTAEKm7ECY3TbJaTXPkNvAwg/2ud+PrtefHrVFFWrXrblSQhnmnc6ut8G3BsDzCljAIV2v+XcdOo+m8EViLf+Bi+gfbAIz4vdVepwQ2XHWUOTKk90i7Xqg4mUUDRIVw9ioNF0GAHbNlJTK3FWC3gstbCJU2hyV3UzgB95b6zqpUHeyn1RK4VAFYGY9fCIdZNy926HEart6uO/N6cO1ETw5B63kI8fTBjU7HLGgGXRjOv1APAqvKgry3tQD2WYkVJGRyYLjDK9d8nStUpwN5swI1xx2IWAbD+UCsRXAixn8s3mvpBD/jbnWjrzEensBc96jtiAsx2P5oXEd salgado@canario"
    >>> browser.getControl(name='sshkey').value = sshkey
    >>> browser.getControl('Import Public Key').click()
    >>> soup = find_main_content(browser.contents)
    >>> for tag in soup('p', 'informational message'):
    ...     print tag.renderContents()
    SSH public key added.


Launchpad administrators are not allowed to poke at other user's ssh keys.

    >>> admin_browser.open('http://launchpad.dev/~salgado/+editsshkeys')
    Traceback (most recent call last):
    ...
    Unauthorized: ...


Salgado will now remove one of his ssh keys from Launchpad.

    >>> browser.url
    'http://launchpad.dev/~salgado/+editsshkeys'

    >>> browser.getControl('Remove', index=0).click()
    >>> soup = find_main_content(browser.contents)
    >>> for tag in soup('p', 'informational message'):
    ...     print tag.renderContents()
    Key ... removed


If Salgado tries to remove a key that doesn't exist or one that doesn't
belong to him, it will fail with an error message.

    >>> browser.getControl(name='key', index=0).value = '99999'
    >>> browser.getControl('Remove', index=0).click()
    >>> soup = find_main_content(browser.contents)
    >>> for tag in soup('p', 'error message'):
    ...     print tag.renderContents()
    Cannot remove a key that doesn't exist

    >>> browser.getControl(name='key', index=0).value = '1'
    >>> browser.getControl('Remove', index=0).click()
    Traceback (most recent call last):
    UnexpectedFormData: ...

Similarly, it's not possible to remove an unspecified ssh key, although in
this case we'll raise an UnexpectedFormData.

    >>> browser.open('http://launchpad.dev/~salgado/+editsshkeys')
    >>> browser.getControl(name='key', index=0).value = ''
    >>> browser.getControl('Remove', index=0).click()
    Traceback (most recent call last):
    ...
    UnexpectedFormData: ...
