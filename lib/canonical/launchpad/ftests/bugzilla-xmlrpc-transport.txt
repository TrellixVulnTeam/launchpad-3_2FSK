= TestBugzillaXMLRPCTransport =

The TestBugzillaXMLRPCTransport is an XML-RPC transport which simulates
a remote Bugzilla instance that implements both the Bugzilla XMLRPC API
and the additional Launchpad plugin API.

    >>> import xmlrpclib
    >>> from canonical.launchpad.ftests.externalbugtracker import (
    ...     TestBugzillaXMLRPCTransport)
    >>> bugzilla_transport = TestBugzillaXMLRPCTransport()
    >>> server = xmlrpclib.ServerProxy(
    ...     'http://example.com/', transport=bugzilla_transport)


== Launchpad.time() ==

Launchpad.time() returns the current time on the remote server, the
remote server's timezone and what the remote server believes to be the
current UTC time.

    >>> time_dict = server.Launchpad.time()
    >>> for key in sorted(time_dict):
    ...     print "%s: %s" % (key, time_dict[key])
    local_time: 20080501T01:01:01
    tz_name: UTC
    utc_time: 20080501T01:01:01

We can set the local time value on the remote server to make testing
more useful.

    >>> import time
    >>> from datetime import datetime

    >>> remote_datetime = datetime(2008, 5, 15, 16, 19, 53)
    >>> bugzilla_transport.seconds_since_epoch = time.mktime(
    ...     remote_datetime.timetuple())
    >>> bugzilla_transport.timezone = "US/Central"
    >>> bugzilla_transport.utc_offset = -6*60*60

    >>> time_dict = server.Launchpad.time()
    >>> for key in sorted(time_dict):
    ...     print "%s: %s" % (key, time_dict[key])
    local_time: 20080515T16:19:53
    tz_name: US/Central
    utc_time: 20080515T22:19:53


== Bug.comments() ==

The Launchpad Bugzilla plugin defines a Bug.comments() method which
allows a remote system to get the comments for a given bug or set of
bugs. It takes a list of bug IDs and returns all the comments for those
bugs.

    >>> return_dict = server.Bug.comments({'bug_ids': [1, 2]})
    >>> bugs_dict = return_dict['bugs']
    >>> for key in sorted(bugs_dict).keys():
    ...     print "Bug %s:" % key
    ...     bug_dict = bugs_dict[key]
    ...     for comment_key in sorted(bug_dict.values()):
    ...         print "    %s: %s" % (comment_key, bug_dict[comment_key])
    ...     print
    Bug 1:
        author:
        id:
        number:
        text:
        time
    <BLANKLINE>
    Bug 2:
        author:
        id:
        number:
        text:
        time

