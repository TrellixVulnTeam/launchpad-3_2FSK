<metal:suggestions define-macro="translation-suggestions">
  <tal:comment replace="nothing">
  This macro expects the following variables defined:
      :pomsgset_view: An IPOMsgSet View.
      :submissions: A list of IPOSubmission objects.
  </tal:comment>
  <tal:block condition="submissions">
    <tr class="secondary">
      <th colspan="2" style="border: inherit;">
        <label><metal:title define-slot="suggestion-title" />:</label>
      </th>
      <td class="icon left right" />
      <td>
        <tal:block condition="not:pomsgset_view/is_multi_line">
          <tal:submission repeat="submission submissions">
            <div
              tal:define="submissionlang submission/pomsgset/pofile/language"
              tal:attributes="
                lang submissionlang/dashedcode;
                dir submissionlang/abbreviated_text_dir
              "
              tal:content="submission/potranslation/translation"
              >suggestion</div>
            <div class="discreet">
              &mdash;
              <span tal:replace="submission/person/browsername">
                Foo Bar
              </span>
            </div>
          </tal:submission>
        </tal:block>
        <tal:block
          condition="pomsgset_view/is_multi_line"
          define="submission python:submissions[0]">
          <pre
            tal:define="submissionlang submission/pomsgset/pofile/language"
            tal:attributes="
              lang submissionlang/dashedcode;
              dir submissionlang/abbreviated_text_dir
              "
            tal:content="submission/potranslation/translation">
            suggestion
          </pre>
          <div class="discreet">
            &mdash;
            <span tal:replace="submission/person/browsername">Foo Bar</span>
            <tal:block
              define="submissions_remaining python:len(submissions)-1"
              condition="submissions_remaining">
              (<span tal:replace="submissions_remaining">3</span> more)
            </tal:block>
          </div>
        </tal:block>
      </td>
    </tr>
  </tal:block>
</metal:suggestions>
<metal:pomsgset define-macro="pomsgset-view">
  <tal:comment replace="nothing">
  This macro expects the following variable defined:
      :pomsgset_view: An IPOMsgSet View.
  </tal:comment>
  <tr>
    <td style="text-align: right;">
      <span tal:replace="pomsgset_view/sequence">1</span>.
      <input
        type="hidden"
        tal:attributes="
        name string:set_${pomsgset_view/id}_msgid"
        />
    </td>
    <th style="border-style: dotted; border-width: 1px 0 0;">
      <label class="language-code" tal:condition="not:pomsgset_view/is_plural">
        English:
      </label>
      <label class="language-code" tal:condition="pomsgset_view/is_plural">
        English singular:
      </label>
    </th>
    <td class="icon left right" />
    <td tal:content="structure pomsgset_view/msgid">
      The original text.
    </td>
  </tr>
  <tr class="secondary" tal:condition="pomsgset_view/is_plural">
    <th colspan="2">
      <label>English plural:</label>
    </th>
    <td class="icon left right" />
    <td tal:content="structure pomsgset_view/msgid_plural">
      plural source
    </td>
  </tr>
  <tr class="discreet secondary" tal:condition="pomsgset_view/msgid_has_tab">
    <td colspan="3" />
    <td>
      <img
        alt="Note:"
        src="/@@/info_icon.gif"
        title="This is a note to translators"
        />
      <code>[tab]</code> represents a tab character. Please enter it as
      <code>[tab]</code> in your translation too.
    </td>
  </tr>
  <tr class="discreet secondary" tal:condition="pomsgset_view/source_comment">
    <td colspan="3" />
    <td>
      <img
        alt="Developer note:"
        src="/@@/info_icon.gif"
        title="This note was provided by the software developer."
        />
      <span
        tal:content="pomsgset_view/source_comment"
        tal:omit-tag="">
        This refers to the content type.
      </span>
    </td>
  </tr>
  <tal:block
    tal:define="language_code pomsgset_view/pofile/language/code"
    repeat="index pomsgset_view/translation_range">
    <tr class="secondary">
      <th colspan="2">
        <label class="language-code">
          <span tal:replace="pomsgset_view/pofile/language/englishname">
            Welsh
          </span>:
        </label>
      </th>
      <td>
        <!-- will eventually contain copy buttons -->
      </td>
      <td>
        <div tal:condition="pomsgset_view/error" class="error">
          <strong>Error in Translation:</strong>
          <span tal:replace="pomsgset_view/error" />
        </div>
        <tal:comment tal:replace="nothing">
          XXX: Carlos Perello Marin 2005-05-05
          This 'python:' expression should be fixed by SteveA.
        </tal:comment>
        <input
          style="width: 100%;"
          type="text"
          tal:condition="not:pomsgset_view/is_multi_line"
          tal:attributes="
            name string:set_${pomsgset_view/id}_translation_${language_code}_${index};
            value python:pomsgset_view.get_translation(index);
            tabindex view/tab_index;
            lang pomsgset_view/pofile/language/dashedcode;
            dir pomsgset_view/pofile/language/abbreviated_text_dir;
            " />
        <tal:block condition="pomsgset_view/is_multi_line">
          <tal:comment tal:replace="nothing">
            XXX: Carlos Perello Marin 2005-05-05
            This 'python:' expression should be fixed by SteveA.
          </tal:comment>
          <tal:with-content condition="python:pomsgset_view.get_translation(index)">
            <tal:comment tal:replace="nothing">
              The lack of indentation for tal:content is deliberate or we would
              add extra whitespaces to the textarea, which causes us to
              potentially corrupt translations.
              https://bugzilla.mozilla.org/show_bug.cgi?id=299009
            </tal:comment>
            <textarea
              style="width: 100%;"
              tal:attributes="
                name string:set_${pomsgset_view/id}_translation_${language_code}_${index};
                rows pomsgset_view/max_lines_count;
                tabindex view/tab_index;
                lang pomsgset_view/pofile/language/dashedcode;
                dir pomsgset_view/pofile/language/abbreviated_text_dir;
                ">
<tal:content replace="structure python:pomsgset_view.get_translation(index)" /></textarea>
          </tal:with-content>
          <tal:without-content condition="python:not pomsgset_view.get_translation(index)">
            <tal:comment tal:replace="nothing">
              XXX: Carlos Perello Marin 2005-05-05
              This 'python:' expression should be fixed by SteveA.

              We are using an special case if we don't have any content for this
              textarea because tal expressions leave empty lines behind so we
              get new lines added to the textarea for free and that causes
              erroneous translations.
            </tal:comment>
            <textarea
              style="width: 100%;"
              tal:attributes="
                name string:set_${pomsgset_view/id}_translation_${language_code}_${index};
                rows pomsgset_view/max_lines_count;
                tabindex view/tab_index;
                lang pomsgset_view/pofile/language/dashedcode;
                dir pomsgset_view/pofile/language/abbreviated_text_dir;
                "></textarea>
          </tal:without-content>
        </tal:block>
      </td>
    </tr>
    <tr class="secondary">
      <td colspan="3" />
      <td>
        <div>
          <label class="fuzzy-checkbox">
            <input
              type="checkbox"
              value="fuzzy"
              tal:attributes="
                checked pomsgset_view/is_fuzzy;
                name string:set_${pomsgset_view/id}_fuzzy_${language_code};
                tabindex: view/tab_index
                " />
            <tal:block condition="not:pomsgset_view/is_plural">
              Someone should review this translation
            </tal:block>
            <tal:block condition="pomsgset_view/is_plural">
              Someone should review these translations
            </tal:block>
          </label>
        </div>
      </td>
    </tr>
    <tal:block
      define="submissions python:pomsgset_view.get_suggested_submissions(index)">
      <metal:submissions
        use-macro="submissions/@@+pomsgset-translate/translation-suggestions">
        <metal:fill metal:fill-slot="suggestion-title"><tal:block
          condition="not:pomsgset_view/is_multi_line"
          >Suggestions</tal:block><tal:block
          condition="pomsgset_view/is_multi_line"
          >Suggestion</tal:block></metal:fill>
      </metal:submissions>
    </tal:block>
    <tal:block
      define="submissions python:pomsgset_view.get_current_submissions(index)">
      <metal:submissions
        use-macro="submissions/@@+pomsgset-translate/translation-suggestions">
        <metal:fill metal:fill-slot="suggestion-title"><tal:block
          condition="not:pomsgset_view/is_multi_line"
          >Used elsewhere</tal:block><tal:block
          condition="pomsgset_view/is_multi_line"
          >Used elsewhere</tal:block></metal:fill>
      </metal:submissions>
    </tal:block>
    <tal:block
      define="submissions python:pomsgset_view.get_wiki_submissions(index)">
      <metal:submissions
        use-macro="submissions/@@+pomsgset-translate/translation-suggestions">
        <metal:fill metal:fill-slot="suggestion-title"><tal:block
          condition="not:pomsgset_view/is_multi_line"
          >Suggested elsewhere</tal:block><tal:block
          condition="pomsgset_view/is_multi_line"
          >Suggested elsewhere</tal:block></metal:fill>
      </metal:submissions>
    </tal:block>
    <tal:block
      define="submissions
      python:pomsgset_view.get_alternate_language_submissions(index)">
      <metal:submissions
        use-macro="submissions/@@+pomsgset-translate/translation-suggestions">
        <metal:fill metal:fill-slot="suggestion-title"><tal:block
          condition="not:pomsgset_view/is_multi_line"
          ><span tal:replace="pomsgset_view/second_lang_pofile/language/englishname"
          /> (Alternate Language)</tal:block><tal:block
          condition="pomsgset_view/is_multi_line"
          ><span tal:replace="pomsgset_view/second_lang_pofile/language/englishname"
          /> (Alternate Language)</tal:block></metal:fill>
      </metal:submissions>
    </tal:block>
  </tal:block>
  <tr tal:condition="pomsgset_view/comment" class="secondary">
    <th colspan="2"><label>Translator note:</label></th>
    <td />
    <td tal:content="pomsgset_view/comment">
      Translator comment.
    </td>
  </tr>
  <tr class="discreet secondary">
    <th colspan="2" style="padding-bottom: 1em;">
      Located in:
    </th>
    <td class="icon left right" />
    <td style="overflow: auto;" tal:content="pomsgset_view/file_references">
      ./plone_forms/discussion_reply_form.pt
    </td>
  </tr>
</metal:pomsgset>
