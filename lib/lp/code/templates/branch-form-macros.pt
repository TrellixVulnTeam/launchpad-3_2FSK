 <tal:root
   xmlns:tal="http://xml.zope.org/namespaces/tal"
   xmlns:metal="http://xml.zope.org/namespaces/metal"
   omit-tag="">

<metal:add-branch define-macro="add-branch-content">

  <div id="branch-unique-name-div" class="hidden">
    The resulting location of the branch will be:
    <strong><span id="branch-unique-name"></span></strong> (<a href="/+help/register-branch.html" target="help">Do you need to register?</a>)
  </div>

  <div metal:use-macro="context/@@launchpad_form/form">
  </div>

<script type='text/javascript' tal:content="string:var target_name='${view/target/name}';" />

<script type="text/javascript">
//<![CDATA[
function update_branch_unique_name()
{
  var unique_name = document.getElementById("branch-unique-name")
  var owner = document.getElementById("field.owner")
  var name = document.getElementById("field.name").value
  if (name == '') {
    name = '&lt;name&gt;'
  }
  var branch_name = "~" + owner.value + "/" + target_name + "/" + name
  unique_name.innerHTML = branch_name
}

function hookUpBranchFieldFunctions()
{
  connect('field.owner', 'onkeyup', update_branch_unique_name);
  connect('field.owner', 'onchange', update_branch_unique_name);
  connect('field.name', 'onkeyup', update_branch_unique_name);
  update_branch_unique_name();
  document.getElementById("branch-unique-name-div").style.display = "block";
}

registerLaunchpadFunction(hookUpBranchFieldFunctions);

//]]>
</script>

</metal:add-branch>

</tal:root>
