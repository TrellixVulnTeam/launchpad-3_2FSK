= Translations Relicensing =

When Karl visits +translate page for the first time, he is sent
to a form to indicate whether he wants his translations to be
relicensed under BSD license.

    >>> browser = setupBrowser(auth='Basic karl@canonical.com:test')
    >>> browser.open('http://translations.launchpad.dev/alsa-utils/trunk/'
    ...              '+pots/alsa-utils/es/+translate')
    >>> browser.url
    'http://translations.launchpad.dev/~karl/+licensing'

Karl realises that he is not on the translate page, he can see that
that this page has information about relicensing.

    >>> print browser.title
    Translations licensing
    >>> print find_main_content(browser.contents)
    <div...
    <p>Hello. We plan to clarify the licence...
    ...

The page asks Karl to make a choice as to whether he wants to
relicense his translations.

    >>> radiobutton = browser.getControl(name='field.allow_relicensing')

The default choice is to permit relicensing. Karl chooses "no".

    >>> print radiobutton.value
    True
    >>> radiobutton.value = False
    >>> browser.getControl("Update my decision").click()

Karl sees a notice that his translations will be removed when
Launchpad Translations switches to a BSD license.

    >>> get_feedback_messages(browser.contents)
    [u'Your choice has been saved. Your translations will be removed
    once we completely switch to BSD license for translations.']

Karl changes his mind. He returns to the relicensing page.

    >>> browser.open('http://translations.launchpad.dev/~karl/')
    >>> browser.getLink('Translations licensing').click()
    >>> browser.url
    'http://translations.launchpad.dev/~karl/+licensing'
    >>> print browser.title
    Translations licensing

Karl sees that the current value is 'no', which he set before.

    >>> radiobutton = browser.getControl(name='field.allow_relicensing')
    >>> print radiobutton.value
    False

He changes it again.

    >>> radiobutton.value = True
    >>> browser.getControl("Update my decision").click()

    >>> get_feedback_messages(browser.contents)
    [u'Your choice has been saved. Thank you for deciding to license
    your translations under BSD license.']

Karl can now browse to a +translate page without being forwarded.

    >>> browser.open('http://translations.launchpad.dev/alsa-utils/trunk/'
    ...              '+pots/alsa-utils/es/+translate')
    >>> browser.url
    'http://translations.launchpad.dev/alsa-utils/trunk/+pots/alsa-utils/es/+translate'

== Permissions ==

If another logged-in user comes across Karl's translations page, he sees
no link to relicense Karl's translations.

    >>> user_browser.open('http://translations.launchpad.dev/~karl/')
    >>> user_browser.getLink('Translations licensing')
    Traceback (most recent call last):
    ...
    LinkNotFoundError

Typing in URL directly doesn't work either.

    >>> user_browser.open(
    ...     'http://translations.launchpad.dev/~karl/+licensing')
    Traceback (most recent call last):
    ...
    Unauthorized: ...
