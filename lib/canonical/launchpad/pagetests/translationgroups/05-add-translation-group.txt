  >>> from canonical.launchpad.helpers import backslashreplace

See if we can add a new Translation Group. First, load the +new page without
any login credentials.

  >>> try:
  ...     anon_browser.open(
  ...         'http://translations.launchpad.dev/translations/groups/+new')
  ...     print "Allowed"
  ... except:
  ...     print "Blocked"
  Blocked

Same for a regular, unprivileged user.

  >>> try:
  ...     user_browser.open(
  ...         'http://translations.launchpad.dev/translations/groups/+new')
  ...     print "Allowed"
  ... except:
  ...     print "Blocked"
  Blocked

OK, best we try again, with administrator rights!

  >>> admin_browser.open(
  ...     'http://translations.launchpad.dev/translations/groups/+new')
  >>> find_main_content(admin_browser.contents)
  <...
  <h1>Create a new translation group</h1>
  ...

We test if the name validator is working.

  >>> admin_browser.getControl('Name').value='PolYglot'
  >>> admin_browser.getControl('Title').value='The PolyGlot Translation Group'
  >>> admin_browser.getControl('Summary').value = "The PolyGlots are a well organised translation group that handles the work of translating a number of Ubuntu and upstream projects. It consists of a large number of translation teams, each specialising in their own language."
  >>> admin_browser.getControl('Add').click()
  >>> find_main_content(admin_browser.contents)
  <...
  ...Invalid name 'PolYglot'...
  ...


Cool, we get the page to create a translation group. Let's go ahead and POST
the form to create a new group, called the "polyglot" translation group.

  >>> admin_browser.getControl('Name').value='polyglot'
  >>> admin_browser.getControl('Title').value='The PolyGlot Translation Group'
  >>> admin_browser.getControl('Summary').value = "The PolyGlots are a well organised translation group that handles the work of translating a number of Ubuntu and upstream projects. It consists of a large number of translation teams, each specialising in their own language."
  >>> admin_browser.getControl('Add').click()
  >>> admin_browser.url
  '.../polyglot'

OK, we created it and got redirected to the page for that group. That's nice
and clean. Let's view it.

  >>> find_main_content(admin_browser.contents)
  <...
  ...The PolyGlot Translation Group...
  ...

A Rosetta administrator is also allowed to create groups.

  >>> browser.addHeader('Authorization', 'Basic jordi@ubuntu.com:test')
  >>> browser.open(
  ...     'http://translations.launchpad.dev/translations/groups/+new')
  >>> browser.getControl('Name').value='monolingua'
  >>> browser.getControl('Title').value='Single-language Translators'
  >>> browser.getControl('Summary').value = "Since each of us only speaks one language, we work out software translations through drawings and hand signals."
  >>> browser.getControl('Add').click()
  >>> browser.url
  '.../monolingua'


