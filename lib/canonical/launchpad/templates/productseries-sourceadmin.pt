<tal:layout define="columns1 default">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
  lang="en"
  metal:use-macro="context/@@main_template/master"
  i18n:domain="rosetta">

<body>

    <div metal:fill-slot="main">
      <table>
        <tbody>
          <tr>
            <td style="width: 75%; padding-right: 1em;">

  <tal:processform condition="view/adminSource" omit-tag="" />

              <h1>Register an upstream branch for importing</h1>
              
              <p tal:condition="not:view/errormsgs">
                Once you enter the details of the
                <abbr title="revision control system">RCS</abbr>
                you use for this product series,
                Launchpad can attempt to import that code
                and publish it as a Bazaar branch.
                This lets distributors share code with you more efficiently,
                and also allows distributed upstream development.
              </p>

  <div tal:repeat="errmsg view/errormsgs" tal:omit-tag>
  <p class="portalMessage" tal:content="errmsg" />
  </div>

              <form method="post">
  
                <fieldset>
                  <legend>CVS Repository</legend>
                  <table>
                    <tbody>
                      <tr>
                        <th><label>Root:</label></th>
                        <td>
                          <input type="text" name="cvsroot" size="30"
                          tal:attributes="value view/cvsroot" />
                          <span class="fieldRequired">(Required)</span>
                        </td>
                      </tr>
                      <tr>
                        <th><label>Module:</label></th>
                        <td>
                          <input type="text" name="cvsmodule" size="30"
                          tal:attributes="value view/cvsmodule" />
                          <span class="fieldRequired">(Required)</span>
                        </td>
                      </tr>
                      <tr>
                        <th><label>Branch name:</label></th>
                        <td>
                          <input type="text" name="cvsbranch" size="30"
                          tal:attributes="value view/cvsbranch" />
                          <span class="fieldRequired">(Required)</span>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </fieldset>

                <fieldset>

  <legend>SVN Repository</legend>
  
                  <table>
                    <tbody>
                      <tr>
                        <th><label>Repository:</label></th>
                        <td>
                          <div>
                            <input type="text" name="svnrepository" size="35"
                            tal:attributes="value view/svnrepository" />
                            <span class="fieldRequired">(Required)</span>
                          </div>
                          <div class="formHelp">
                            Address for the SVN repository, in either
                            <code>svn://</code> or
                            <code>http</code>(<code>s</code>)<code>://</code>
                            form.
                          </div>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </fieldset>

<tal:x condition="nothing">
  <fieldset>
  <legend>Arch source</legend>
  <p class="discreet">
  If you fill out this, the CVS/SVN/Arch stuff above isn't required.
  This will be governed by JS in the later versions.
  </p>
  
  <div class="field">
    <label>OpenPGP key ID</label>
    <span class="fieldRequired">(Required)</span>
    <input type="text" name="archsourcegpgkeyid" size="30"
       value="" />
  </div>

  <div class="field">
    <label>Arch archive name</label>
    <span class="fieldRequired">(Required)</span>
    <input type="text" name="archsourcename" size="30"
       value="" />
  </div>

  <div class="field">
    <label>URL</label>
    <span class="fieldRequired">(Required)</span>
    <input type="text" name="archsourceurl" size="30"
       value="" />
  </div>

  </fieldset>
</tal:x>
  
                <fieldset>
                  <legend>Import and Sync Details</legend>
                  <table>
                    <tbody>
                      <tr>
                        <th><label>Import from:</label></th>
                        <td>
                          <div>
                            <span tal:replace="structure view/rcs_selector" />
                            <span class="fieldRequired">(Required)</span>
                          </div>
                          <div class="formHelp">
                            Which RCS details to use for the import.
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <th><label>Arch archive:</label></th>
                        <td>
                          <input type="text" name="targetarcharchive" size="30"
                          tal:attributes="value view/targetarcharchive" />
                          <span class="fieldRequired">(Required)</span>
                        </td>
                      </tr>
                      <tr class="formHelp">
                        <th>Recommended:</th>
                        <td>
                          <code tal:content="view/default_targetarcharchive" />
                        </td>
                      </tr>
                      <tr>
                        <th><label>Arch category:</label></th>
                        <td>
                          <input type="text" name="targetarchcategory" size="30"
                          tal:attributes="value view/targetarchcategory" />
                          <span class="fieldRequired">(Required)</span>
                        </td>
                      </tr>
                      <tr class="formHelp">
                        <th>Recommended:</th>
                        <td>
                          <code tal:content="view/default_targetarchcategory" />
                        </td>
                      </tr>
                      <tr>
                        <th><label>Arch branch:</label></th>
                        <td>
                          <input type="text" name="targetarchbranch" size="30"
                          tal:attributes="value view/targetarchbranch" />
                          <span class="fieldRequired">(Required)</span>
                        </td>
                      </tr>
                      <tr class="formHelp">
                        <th>Recommended:</th>
                        <td>
                          <code tal:content="view/default_targetarchbranch" />
                        </td>
                      </tr>
                      <tr>
                        <th><label>Arch version:</label></th>
                        <td>
                          <input type="text" name="targetarchversion" size="30"
                          tal:attributes="value view/targetarchversion" />
                          <span class="fieldRequired">(Required)</span>
                        </td>
                      </tr>
                      <tr class="formHelp">
                        <th>Recommended:</th>
                        <td tal:content="view/default_targetarchversion" />
                      </tr>
                    </tbody>
                  </table>
                </fieldset>

  <fieldset tal:condition="context/autoTestFailed">
    <legend>Failed import control</legend>
    <div>
      <label>
        <input type="checkbox" name="resetToAutotest" />
        Retest this series in roomba
      </label>
    </div>
  </fieldset>

                <fieldset>
                  <legend>FTP Details</legend>
                  <table>
                    <tbody>
                      <tr>
                        <th><label>Root directory URL:</label></th>
                        <td>
                          <input name="releaseroot" size=40
                          tal:attributes="value context/releaseroot" />
                        </td>
                      </tr>
                      <tr class="formHelp">
                        <th>Example:</th>
                        <td>
                          <code>ftp://www.mozilla.org/pub/firefox/1.1/</code>
                        </td>
                      </tr>
                      <tr class="formHelp">
                        <th />
                        <td>
                          The directory containing releases that are
                          part of this series.
                          Launchpad automatically scans this directory
                          regularly to import new releases.
                        </td>
                      </tr>
                      <tr>
                        <th><label>Filename pattern:</label></th>
                        <td>
                          <input name="releasefileglob" size=40
                          tal:attributes="value context/releasefileglob" />
                        </td>
                      </tr>
                      <tr class="formHelp">
                        <th>Example:</th>
                        <td><code>firefox-1.1.*.src.tgz</code></td>
                      </tr>
                      <tr class="formHelp">
                        <th />
                        <td>
                          Launchpad uses this pattern to find new releases of
                          <span tal:replace="context/product/displayname" />
                          when they are uploaded to the root directory.
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </fieldset>

                <fieldset>

    <legend>Product and Project Status</legend>

    <div tal:condition="context/product/project" tal:omit-tag>
      <p><b>Project: <span tal:replace="context/product/project/title">Project
      Title</span></b></p>
      <p tal:condition="python: not (context.product.project.reviewed and
         context.product.project.active)"
         class="portalMessage">This project is not yet 
         <a tal:attributes="href
             string:/projects/${context/product/project/name}/+review">
         approved</a>.</p>

      <p tal:content="context/product/project/summary">product
      summary</p>
    </div>

    <p><b>Product: <span tal:replace="context/product/title">Product
    Title</span></b></p>
    <div tal:condition="python: not (context.product.reviewed and
      context.product.active)" class="portalMessage">This product is
      not yet 
      <a tal:attributes="href
        string:/products/${context/product/name}/+review">
        approved</a>.</div>
      <p><span tal:replace="context/product/summary">product
      summary</span></p>

      <div tal:condition="view/namesReviewed">
      
        <div class="field">
          <label>
            <input type="checkbox" name="syncCertified"
            tal:attributes="checked context/syncCertified" />
            This source is certified for synchronization
          </label>
        </div>

        <div class="field">
          <label>
            <input type="checkbox" name="autoSyncEnabled"
            tal:attributes="checked context/autoSyncEnabled" />
            The upstream source is being synchronised to Arch automatically
          </label>
        </div>

    </div>

  <div class="actions">

  <tal:x condition="nothing">
    DO NOT CHANGE THE VALUE OF THIS.
    It is used to verify that the correct form was posted.
  </tal:x>
  <input type="submit"
     name="Update RCS Details"
     value="Update RCS Details" />

  </div>

  </form>

            </td>
            <td
              style="width: 25%;"
              tal:content="structure CONTEXTS/@@+menubox"
            />
          </tr>
        </tbody>
      </table>
    </div>
    <metal:nomenu fill-slot="column_two"></metal:nomenu>
  </body>
</html>
</tal:layout>
