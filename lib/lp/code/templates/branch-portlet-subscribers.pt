<div
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  class="portlet" id="portlet-subscribers">
  <div class="portletBody portletContent"
       tal:define="context_menu context/menu:context">

    <div tal:condition="not:view/owner_is_registrant">
      <h2>Registered by</h2>
      <dl>
        <dt>
          <tal:registrant tal:replace="structure context/registrant/fmt:link" />
        </dt>
      </dl>
    </div>

    <div>
      <h2>Owner</h2>
      <dl>
        <dt>
          <tal:owner tal:replace="structure context/owner/fmt:link" />
          <a
            tal:define="link context_menu/edit"
            tal:condition="link/enabled"
            tal:attributes="href link/url">
            <img src="/@@/edit" tal:attributes="alt link/text" />
          </a>
        </dt>
      </dl>
    </div>

    <div>
      <h2>Default Review Team</h2>
      <dl>
        <dt>
          <tal:owner tal:replace="structure context/code_reviewer/fmt:link" />
          <a tal:define="link context_menu/reviewer"
             tal:condition="link/enabled"
             tal:attributes="href link/url"
             ><img tal:attributes="alt link/text;title link/text" src="/@@/edit" /></a>
        </dt>
      </dl>
    </div>

    <div>
      <div class="actions">
      <div
        tal:define="link context_menu/subscription"
        tal:condition="link/enabled"
        >
        <a id="selfsubscription"
           class="bg-image add"
           tal:attributes="href link/url"
           tal:content="link/text" />
      </div>
      <div
        tal:define="link context_menu/add_subscriber"
        tal:condition="link/enabled"
        tal:content="structure link/render"
        />
      </div>
      <h2>Subscribers</h2>
      <p id="subscriber-list">
        <noscript>
          Please enable javascript to view branch subscribers.
        </noscript>
      </p>
      <div id="subscribers-portlet-spinner"
          style="text-align: center; display: none;">
        <img src="/@@/spinner" />
      </div>
    </div>
  </div>
  <tal:script
    replace="structure
    string:&lt;script id='milestone-script' type='text/javascript'&gt;" />
    <!--

    YUI().use('io-base', 'node', function(Y) {

    if(Y.UA.ie) {
        Y.get('#subscriber-list').set('innerHTML',
            'view subscribers');
        return;
    }

    Y.on('domready', function() {
        update_subscriber_list();
    });

    /*
     * Update the subscriber list via Ajax.
     */
    function update_subscriber_list() {

        Y.get('#subscribers-portlet-spinner').setStyle('display', 'block');
        Y.io('+branch-portlet-subscriber-content', {
            on: {
                complete: function(id, response) {
                    Y.get('#subscribers-portlet-spinner').setStyle(
                        'display', 'none');
                    Y.get('#subscriber-list').set(
                        'innerHTML', response.responseText);

                    var element = Y.get('.menu-link-subscription');
                    if (element.get('innerHTML') == 'Edit your subscription') {
                        element.setStyle('display', 'none');
                    }
                }}});
    }

    });
    -->
  <tal:script replace="structure string:&lt;/script&gt;" />


</div>
