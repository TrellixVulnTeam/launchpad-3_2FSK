= The PullerAPI application =

The puller API application is an XMLRPC service that allows the puller
to find and update the status of branches.  It is available as the
puller_api attribute of our private XMLRPC instance.

    >>> from canonical.launchpad.interfaces import (
    ...     IPrivateApplication)
    >>> from canonical.launchpad.interfaces.codehosting import (
    ...     IPullerAPIApplication)
    >>> from canonical.launchpad.webapp.testing import verifyObject

    >>> private_root = getUtility(IPrivateApplication)
    >>> verifyObject(
    ...     IPullerAPIApplication,
    ...     private_root.puller_api)
    True

The PullerAPI view provides the IPullerAPI XML-RPC API:

    >>> from zope.publisher.xmlrpc import TestRequest
    >>> from canonical.launchpad.interfaces.codehosting import IPullerAPI
    >>> from canonical.launchpad.xmlrpc.codehosting import PullerAPI

    >>> puller_api = PullerAPI(
    ...     private_root.puller_api, TestRequest())
    >>> verifyObject(IPullerAPI, puller_api)
    True

The IPullerAPI interface defines some methods, for which see the unit
tests.  To allow a minimal test here, we call getBranchPullQueue,
which will return an empty list.

    >>> from canonical.launchpad.interfaces.branch import BranchType
    >>> puller_api.getBranchPullQueue(BranchType.HOSTED.name)
    []

This remains true what it is accessed over XMLRPC.

    >>> import xmlrpclib
    >>> from canonical.functional import XMLRPCTestTransport
    >>> puller = xmlrpclib.ServerProxy(
    ...     'http://xmlrpc-private.launchpad.dev:8087/puller_api',
    ...     transport=XMLRPCTestTransport())
    >>> puller.getBranchPullQueue(BranchType.HOSTED.name)
    []
