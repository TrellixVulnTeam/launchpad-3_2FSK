= Creating a new team =

    >>> browser.addHeader('Authorization', 'Basic test@canonical.com:test')
    >>> browser.open('http://launchpad.dev/people/')
    >>> browser.getLink('Register a team').click()

    >>> browser.url
    'http://launchpad.dev/people/+newteam'

    >>> browser.title
    'Register a new team in Launchpad'

    >>> browser.getControl(name='field.name').value = 'myemail'
    >>> browser.getControl('Display Name').value = 'my own team'
    >>> browser.getControl(
    ...     'Team Description').value = 'my own team description'
    >>> browser.getControl('Subscription period').value = '365'
    >>> browser.getControl('Renewal period').value = '365'
    >>> browser.getControl('Open Team').selected = True
    >>> browser.getControl('Create').click()

    >>> browser.url
    'http://launchpad.dev/~myemail'

    >>> browser.title
    'my own team in Launchpad'

The owner of a team is always added as an administrator of his team.

    >>> from canonical.launchpad.database import Person
    >>> [a.name for a in Person.byName('myemail').adminmembers]
    [u'name12']

When creating a new team you can optionally provide a contact email address
for that team. This contact address must not be registered in Launchpad.

    >>> browser.open('http://launchpad.dev/people/+newteam')

    >>> browser.getControl(name='field.name').value = 'newtestteam'
    >>> browser.getControl('Display Name').value = 'newtestteam'
    >>> browser.getControl(
    ...     'Contact Email Address').value = 'test@canonical.com'
    >>> browser.getControl('Team Description').value = 'another test team'
    >>> browser.getControl('Moderated Team').selected = True
    >>> browser.getControl('Create').click()

    >>> for tag in find_tags_by_class(browser.contents, 'message'):
    ...     print extract_text(tag)
    There is 1 error.
    test@canonical.com is already registered in Launchpad and is associated
    with Sample Person.

We also check if the given email address is syntatically valid.

    >>> browser.getControl(
    ...     'Contact Email Address').value = 'testcanonical.com'
    >>> browser.getControl('Create').click()

    >>> for tag in find_tags_by_class(browser.contents, 'message'):
    ...     print extract_text(tag)
    There is 1 error.
    testcanonical.com isn't a valid email address.

Now we enter a valid email address that's not registered in Launchpad.

    >>> browser.getControl('Contact Email Address').value = 'team-foo@bar.com'
    >>> browser.getControl('Create').click()

    >>> browser.url
    'http://launchpad.dev/~newtestteam'

    >>> for tag in find_tags_by_class(
    ...     browser.contents, 'informational message'):
    ...     print tag.renderContents()
    A confirmation message has been sent to 'team-foo@bar.com'. Follow the
    instructions in that message to confirm the new contact address for this
    team. (If the message doesn't arrive in a few minutes, your mail provider
    might use 'greylisting', which could delay the message for up to an hour
    or two.)
