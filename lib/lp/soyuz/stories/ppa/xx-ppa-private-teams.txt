Personal Package Archives for private teams
===========================================


Activating Personal Package Archives for Private Teams
------------------------------------------------------

Private teams can have PPAs and the process of activation is the same
as for individuals and public teams.

    >>> # Create a private team.
    >>> from zope.component import getUtility
    >>> from lp.registry.interfaces.person import IPersonSet, PersonVisibility
    >>> login('foo.bar@canonical.com')
    >>> person_set = getUtility(IPersonSet)
    >>> cprov = person_set.getByName('cprov')
    >>> priv_team = factory.makeTeam(name='private-team',
    ...     owner=cprov, displayname="Private Team",
    ...     visibility=PersonVisibility.PRIVATE)
    >>> logout()

A section named 'Personal Package Archives' is presented in the
user/team page.

    >>> browser = setupBrowser(
    ...     auth='Basic celso.providelo@canonical.com:cprov')
    >>> browser.open("http://launchpad.dev/~private-team")

   >>> print_tag_with_id(browser.contents, 'ppas')
   Personal package archives
   Create a new PPA

The form looks almost identical to that for a public team.

   >>> browser.getLink('Create a new PPA').click()
   >>> browser.title
   'Activate Personal Package Archive...

There is, however, an extra bit of information indicating the new PPA
will be private.

   >>> print_tag_with_id(browser.contents, 'ppa-privacy-statement')
   Since 'Private Team' is a private team this PPA will be private.

   >>> browser.getControl(name='field.displayname').value = "Private Team PPA"
   >>> browser.getControl(name='field.accepted').value = True
   >>> browser.getControl("Activate").click()
   >>> print browser.title
   Private Team PPA : “Private Team” team


Administrator changes to the PPA
--------------------------------

An administrator viewing the PPA administration page sees that it is
marked private.

   >>> admin_browser.open(
   ...     'http://launchpad.dev/~private-team/+archive/ppa/+admin')
   >>> admin_browser.getControl(name='field.private').value
   True

Attempting to change the PPA to public is thwarted.

   >>> admin_browser.getControl(name='field.private').value = False
   >>> admin_browser.getControl('Save').click()
    >>> for error in get_feedback_messages(admin_browser.contents):
    ...     print error
    There is 1 error.
    Private teams may not have public archives.
