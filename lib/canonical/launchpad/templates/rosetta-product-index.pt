<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="context/@@main_template/master"
      i18n:domain="rosetta">

<head>
    <title metal:fill-slot="title">Rosetta:
        <span tal:replace="context/title">Some product or other</span></title>
    <!-- Plone style sheet -->
    <style type="text/css" media="screen">@import url(plone.css);</style>
    <!-- Rosetta style sheet -->
    <style type="text/css" media="screen">@import url(rosetta.css);</style>
</head>

<body>

<div metal:fill-slot="main">

    <h1>Translation overview: <span tal:replace="context/title">NAME</span></h1>

    <p class="discreet">
    This is a product of the project <a href=".."
        tal:content="context/project/displayname">PROJECT</a>.
    </p>

    <div style="float: right; clear: both; margin-top: 0.25em;">
    Product home page:
    <a href="http://product.home/page"
       tal:content="context/url|default"
       tal:attributes="href context/url|nothing">(None supplied)</a>
    </div>

    <p tal:content="context/description">
    Mozilla offers a full suite of integrated Internet applications including
    a web browser, e-mail client, address book, web page composer, Internet
    chat software and calendar application.
    </p>

    <!--
    No templates: say so.
    Templates, no languages: list templates without stats.
    Templates, languages: list templates with stats.
    -->

    <tal:block condition="not: view/templates">
        <p>
        Rosetta doesn't currently know of any translatable resources for
        <span tal:content="context/title">product title</span>.
        </p>
    </tal:block>

    <tal:block condition="view/templates">

        <div tal:condition="not: view/languages">
            <p>
            Below is a list of PO templates for this product.
            </p>

            <ul>
                <li tal:repeat="template context/poTemplates">
                    <a tal:attributes="href string:${template/name}/translate"
                        tal:content="template/title">template</a></li>
            </ul>
        </div>

        <div tal:condition="view/languages" tal:repeat="template view/templates">
            <p>
            Below is a list of PO templates for this product, and information
            about them in your languages.
            </p>

            <h2 tal:content="template/title">Template</h2>
            
            <p>
            <a tal:attributes="href string:${template/name}/+edit">Edit this
                template.</a>
            <br />
            <a tal:attributes="href string:${template/name}/translate"
                >Translate this template into all selected languages.</a>
            <br />
            <a tal:attributes="href string:${template/name}/upload"
                >Upload data for this template.</a>
            </p>

            <table class="listing">
                <thead>
                    <th>Language</th>
                    <th>Translated</th>
                    <th>Untranslated</th>
                    <th>Graph</th>
                    <th>Last Change</th>
                    <th>Details</th>
                    <th>Export</th>
                    <th>Translate</th>
                </thead>

                <tbody>
                    <tr tal:repeat="language template/languages">
                        <td><span tal:content="language/name">Language
                            Name</span></td>
                        <td><span tal:replace="language/poTranslated">0</span></td>
                        <td><span tal:replace="language/poUntranslated">0</span></td>
                        <td>
                            <!-- Show an mdash if there isn't going to be a
                            graph. -->
                            <span tal:condition="not: language/poLen">&mdash;</span>

                            <img src="/++resource++green-bar.png"
                                height="15"
                                alt="Translated &amp; non updated graph"
                                tal:condition="language/poNonUpdatesCount"
                                tal:attributes="width language/poNonUpdatesPercent;
                                                title string: Translated: ${language/poNonUpdatesPercent}%"
                            /><img src="/++resource++blue-bar.png"
                                height="15"
                                alt="Updated graph"
                                tal:condition="language/poUpdatesCount"
                                tal:attributes="width language/poUpdatesPercent;
                                                title string: Updates: ${language/poUpdatesPercent}%"
                            /><img src="/++resource++dwelled-bar.png"
                                height="15"
                                alt="Rosetta additions graph"
                                tal:condition="language/poRosettaCount"
                                tal:attributes="width language/poRosettaPercent;
                                                title string: Rosetta additions: ${language/poRosettaPercent}%"
                            /><img src="/++resource++red-bar.png"
                                height="15"
                                alt="Fuzzy graph"
                                tal:condition="language/poUntranslated"
                                tal:attributes="width language/poUntranslatedPercent;
                                                title string: Untranslated: ${language/poUntranslatedPercent}%" />
                        </td>
                        <td>
                            <tal:block condition="language/lastChangedSighting">
                                <span tal:content="language/lastChangedSighting/person/displayname" />
                                &ndash;
                                <span tal:content="language/lastChangedSighting/datelastactive/fmt:datetime" />
                            </tal:block>
                            <tal:block condition="not: language/lastChangedSighting">
                                &mdash;
                            </tal:block>
                        </td>
                            <!--
                            XXX Dafydd Harries, 2004/11/22
                            We should make PO files autovivify.
                            -->
                        <td>
                            <a tal:condition="language/hasPOFile"
                                tal:attributes="href string:${template/name}/${language/code}"
                            >View</a>
                            <span tal:condition="not: language/hasPOFile">&mdash;</span>
                        </td>
                        <td>
                            <a tal:condition="language/hasPOFile"
                                tal:attributes="href string:${template/name}/${language/code}/po">
                                <img src="/++resource++download.png"
                                    alt="Download PO file" />Download PO file</a>
                            <span tal:condition="not: language/hasPOFile">&mdash;</span>
                        </td>
                        <td><a tal:attributes="href
                            string:${template/name}/translate?languages=${language/code}"
                            >Translate</a>
                        </td>
                    </tr>
                </tbody>
            </table>

        </div>
    </tal:block> <!-- condition="view/templates -->
    <div>
        <img src="/++resource++add.gif" />
        <a href="+newpotemplate">Add a new template</a>
    </div>

</div>

</body>
</html>
