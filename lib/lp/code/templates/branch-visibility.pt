<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  metal:use-macro="view/macro:page/main_only"
  i18n:domain="launchpad">

<body>

  <h1 metal:fill-slot="heading">Branch visibility policy</h1>

  <div metal:fill-slot="main">

  <p tal:condition="context/isUsingInheritedBranchVisibilityPolicy"
     id="inherited">
    Using inherited policy from
    <strong tal:content="structure context/project/fmt:link" />.
  </p>

  <div id="policy-items">
  <p id="default-policy">
    Default branch visibility for all branches in
    <strong tal:content="context/displayname">Project</strong>
    is <strong tal:content="view/base_visibility_rule/title">Public</strong>.
  </p>

  <tal:has-policies condition="view/team_policies">
    <p>Except for the following teams:
    </p>
    <ul id="team-policies">
      <li tal:repeat="item view/team_policies">
        <tal:team replace="structure item/team/fmt:link:mainsite"
                  condition="item/team">Team Name</tal:team>:
        <tal:team condition="not: item/team">Everyone</tal:team>
        <tal:policy replace="item/rule/title">Public</tal:policy>
      </li>
    </ul>

  </tal:has-policies>
  </div>

  <div style="padding-left: 1em" id="policy-actions">
  <tal:using-inherited-policy condition="context/isUsingInheritedBranchVisibilityPolicy">
      <p>
        <img src="/@@/edit" alt="edit" />
        <a tal:define="inherited_url context/project/fmt:url"
           tal:attributes="href string:${inherited_url}/+branchvisibility">
          Edit inherited policy
        </a>
      </p>
      <p>
        <img src="/@@/add" alt="add" />
        <a href="+addbranchvisibilitypolicy">Customise policy for
          <tal:displayname replace="context/displayname">Project
          </tal:displayname>
        </a>
      </p>
  </tal:using-inherited-policy>

  <tal:no-inhertied-policy condition="not: context/isUsingInheritedBranchVisibilityPolicy">
      <p>
        <img src="/@@/add" alt="add" />
        <a href="+addbranchvisibilitypolicy">Set policy for a team</a>
      </p>

      <tal:can-remove condition="view/can_remove_items">
        <p>
          <img src="/@@/remove" alt="remove" />
          <a href="+removebranchvisibilitypolicy">Remove policy items</a>
        </p>
      </tal:can-remove>

  </tal:no-inhertied-policy>
  </div>

  <p>NOTE: Changing the branch visibility policies for teams does not change
  the visibility of any existing branches.</p>

</div>

</body>
</html>
