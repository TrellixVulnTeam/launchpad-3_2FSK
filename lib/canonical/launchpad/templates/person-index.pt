<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  xml:lang="en"
  lang="en"
  dir="ltr"
  metal:use-macro="view/macro:page/onecolumn"
  i18n:domain="launchpad"
>

<head>
  <tal:block metal:fill-slot="head_epilogue">
    <tal:valid_person_or_team condition="context/is_valid_person_or_team">
      <link
          tal:condition="not:context/hide_email_addresses"
          rel="meta" type="application/rdf+xml"
          title="FOAF" href="+rdf"
          />
    </tal:valid_person_or_team>
    <tal:openid_enabled condition="context/is_openid_enabled">
      <link
          rel="openid.server"
          tal:attributes="href view/openid_server_url"
          />
      <link
          rel="openid.delegate"
          tal:attributes="href view/openid_identity_url"
          />
    </tal:openid_enabled>
    <meta tal:condition="not: context/is_valid_person_or_team"
          name="robots" content="noindex,nofollow" />
  </tal:block>
</head>

<body>

<metal:leftportlets fill-slot="portlets_one">
  <div tal:replace="structure context/@@+portlet-emails" />
  <div tal:replace="structure context/@@+portlet-latestquestions" />
</metal:leftportlets>

<div metal:fill-slot="main">

  <tal:icon replace="structure context/image:mugshot" />

  <h1 tal:content="context/browsername">Some Person or Team</h1>

  <tal:is-person tal:condition="context/is_valid_person">
    <div
      class="description"
      tal:condition="context/homepage_content"
      tal:content="structure context/homepage_content/fmt:text-to-html"
    />

    <div tal:replace="structure context/@@+portlet-contact-details"/>

    <div
      class="portlet"
      tal:define="contributions view/contributions"
      tal:condition="contributions">
      <h2>Most active in</h2>
      <table class="contributions" id="contributions">
        <tbody>
          <tal:contributions repeat="contribution contributions">
          <tr tal:define="project contribution/project;
                          project_categories contribution/categories">
            <th>
              <img tal:replace="structure project/image:icon"
                   src="/@@/product" />
              <a tal:attributes="href project/fmt:url"
                 tal:content="project/title/fmt:shorten/28">Project</a>
            </th>
            <td tal:repeat="category view/contributed_categories">
              <tal:icon condition="python: category in project_categories"
                        replace="structure category/image:icon" />
            </td>
          </tr>
          </tal:contributions>
        </tbody>
      </table>
    </div>

    <div id="working-on"
         tal:define="bugtasks view/getBugsInProgress;
                     specs context/assigned_specs_in_progress"
         tal:condition="python: bugtasks or specs">
      <div class="section">
        <div class="portlet">
          <h2>Working on&#8230;</h2>
          <table>
            <tr tal:repeat="bugtask bugtasks"
                tal:replace="structure bugtask/@@+listing-detailed" />
          </table>
          <div tal:condition="bugtasks">
            <a tal:attributes="href view/getURLToAssignedBugsInProgress">
              &raquo; Show all bugs in progress
            </a>
          </div>
        </div>
      </div>
      <div class="section">
        <div class="portlet">
          <table>
            <tr tal:repeat="spec specs"
                tal:replace="structure spec/@@+listing-simple" />
          </table>
          <div tal:condition="specs">
            <tal:comment condition="nothing">
              <!-- XXX: Guilherme Salgado 2007-02-12:
                   This link should point to a list of the in-progress specs
                   assigned to this person, but we don't have a way to list that
                   right now, so we'll have to list all incomplete specs assigned
                   to the person. -->
            </tal:comment>
            <a tal:attributes="href string:${context/fmt:url}/+specs?role=assignee">
              &raquo; Show all assigned blueprints
            </a>
          </div>
        </div>
      </div>
    </div>

    <div class="portlet"
         tal:define="memberships context/@@+restricted-membership/getLatestApprovedMembershipsForPerson">
      <h2>Latest memberships</h2>
      <table id="participation">
        <tr tal:repeat="membership memberships"
            tal:replace="structure membership/@@+listing-simple" />
      </table>

      <p tal:condition="memberships">
        <a href="+participation">
          &raquo; See all teams in which
          <span tal:replace="context/title">Foo Bar</span> participates
        </a>
      </p>
      <p tal:condition="not: memberships">
        <span tal:replace="context/browsername">Foo Bar</span> is not an
        active member of any Launchpad teams.
      </p>
    </div>

    <div tal:replace="structure context/@@+portlet-details"/>

  </tal:is-person>

  <tal:is-team tal:condition="context/is_team">
    <div
      class="description"
      tal:content="structure context/teamdescription/fmt:text-to-html"
    />

    <ul class="buttons" tal:define="mentorships context/team_mentorships"
                        tal:condition="context/isTeam">
      <li tal:condition="mentorships">
        <a href="+mentoring" title="People will mentor work for newcomers">
          <img alt="Mentorships" src="/+icing/but-sml-mentoring.gif" />
        </a>
      </li>
      <li tal:condition="not: mentorships">
        <a href="+mentoring" title="No mentoring is yet offered for this team">
          <img alt="Mentorships" src="/+icing/but-sml-mentoring-off.gif" />
        </a>
      </li>
      <tal:not-restricted
          condition="not: context/subscriptionpolicy/enumvalue:RESTRICTED">
        <li tal:condition="not: view/userIsParticipant">
          <a href="+join" title="Sign up as a member of this team">
            <img alt="Join!" src="/+icing/but-sml-jointhisteam.gif" />
          </a>
        </li>
      </tal:not-restricted>
    </ul>

    <div class="left" tal:define="contributions view/contributions">
      <div class="portlet" id="your-involvement">
        <h2>Your involvement</h2>

        <p tal:condition="not: request/lp:person">
          You must <a href="+login">log in</a>
          to join or leave this team.
        </p>
        <tal:block condition="request/lp:person">
          <tal:block condition="view/userIsOwner">
            <p tal:condition="view/userIsActiveMember">
	      You are the owner of this team.
            </p>
            <p tal:condition="not: view/userIsActiveMember">
              You are the owner of this team,
              but not currently an active member.
            </p>
          </tal:block>
          <tal:block condition="not: view/userIsOwner">
            <p tal:condition="view/userIsActiveMember">
	      <tal:block tal:condition="view/userCanRequestToLeave">
		<form class="actions"
		      name="leave"
		      id="form.team.leave"
		      action="+leave"
		      method="post">
		  You are a member of this team.
		  <input type="submit" name="leave" value="Leave the Team" />
		</form>
	      </tal:block>
            </p>
            <p tal:condition="not: view/userIsActiveMember">
              <tal:foo tal:condition="not: view/userIsParticipant">
                You are not a member of this team.
              </tal:foo>
              <tal:foo tal:condition="view/userIsParticipant">
                You are an indirect member of this team:
                <br />
                <a tal:attributes="href view/user/fmt:url"
                   tal:content="view/user/displayname">
                  Guilherme Salgado
                </a>
                <tal:path repeat="team view/findUserPathToTeam">
                  &rarr;
                  <a tal:attributes="href team/fmt:url"
                     tal:content="team/displayname">
                    Launchpad Developers
                  </a>
                </tal:path>
              </tal:foo>
            </p>
          </tal:block>
	  <tal:block condition="view/userIsParticipant">
	    <p tal:condition="view/team_has_mailing_list">
	      <tal:block tal:condition="view/user_is_subscribed_to_list">
		<form class="actions"
		      name="unsubscribe"
		      id="form.list.unsubscribe"
		      action=""
		      method="post">
		  You are subscribed to the team mailing list.
		  <input type="submit" name="unsubscribe" value="Unsubscribe" />
		</form>
	      </tal:block>
	      <tal:block tal:condition="view/user_can_subscribe_to_list">
		You are not subscribed to the team mailing list.
		(<a href="/people/+me/+editemails">Subscribe</a>)
	      </tal:block>
	    </p>
	  </tal:block>
        </tal:block>
      </div>
      <div tal:condition="context/@@+restricted-membership/userCanViewMembership"
           class="section">
      <div class="portlet" id="recently-approved"
           tal:condition="view/recently_approved_members">
        <h2>Recently approved</h2>
        <ul>
          <li class="person"
              tal:repeat="person view/recently_approved_members">
            <a tal:attributes="href person/fmt:url"
              tal:content="person/unique_displayname"
            >Foo Bar (name16)</a>
          </li>
        </ul>
      </div>
      </div>
      <div tal:condition="context/@@+restricted-membership/userCanViewMembership"
           class="section">
      <div class="portlet" id="recently-applied"
           tal:condition="view/recently_proposed_members">
        <h2>Recently applied</h2>
        <ul>
          <li class="person"
              tal:repeat="person view/recently_proposed_members">
            <a tal:attributes="href person/fmt:url"
               tal:content="person/unique_displayname"
            >Foo Bar (name16)</a>
          </li>
        </ul>
      </div>
      </div>

      <div class="section"
           tal:content="structure context/@@+portlet-related-projects" />
    </div>

    <div class="right">
      <div class="section"
           tal:content="structure context/@@+portlet-details" />
      <div class="section"
           tal:content="structure context/@@+portlet-contact-details" />

      <div class="section">
        <div class="portlet" id="subteam-of">
          <h2>Subteam of</h2>

          <p tal:condition="not:context/super_teams">
            &#8220;<span tal:replace="context/browsername"/>&#8221;
            itself is not a member of any other team.
          </p>

          <tal:block condition="context/super_teams">
            <p>
              &#8220;<span tal:replace="context/browsername"/>&#8221;
              is a member of these teams:
            </p>
            <ul>
              <li tal:repeat="team context/super_teams">
                <a tal:attributes="href team/fmt:url"
                   tal:content="team/browsername">name</a>
              </li>
            </ul>
          </tal:block>
        </div>
      </div>
    </div>
  </tal:is-team>

  <div id="not-lp-user-or-team"
       tal:condition="not: context/is_valid_person_or_team">
    <tal:noaccount tal:condition="context/account_status/enumvalue:NOACCOUNT">
      <p><span tal:replace="context/browsername" /> does not use Launchpad.
        <tal:block condition="context/creation_comment">
          This page was created
          <span
            tal:attributes="title context/datecreated/fmt:datetime"
            tal:content="context/datecreated/fmt:displaydate" />
          <tal:user-created
            condition="context/creation_rationale/enumvalue:USER_CREATED">
            by <a tal:attributes="href context/registrant/fmt:url">
            <span tal:replace="context/registrant/browsername">Foo</span></a>,
            and the reason given by that user for its creation is:
            <em tal:content="structure context/creation_comment/fmt:text-to-html">
              reason</em>
          </tal:user-created>
          <tal:not-user-created
            condition="not: context/creation_rationale/enumvalue:USER_CREATED">
            <strong tal:content="context/creation_comment" />.
          </tal:not-user-created>
        </tal:block>
        <tal:block condition="not: context/creation_comment">
          This page was created
          <span
            tal:attributes="title context/datecreated/fmt:datetime"
            tal:content="context/datecreated/fmt:displaydate" />.
        </tal:block>
      </p>

      <tal:logged-in condition="request/lp:person">
        <tal:person condition="not: view/context_is_probably_a_team">
          <a tal:attributes="
            href string:/people/+requestmerge?field.dupeaccount=${context/name}"
          >Are you <span tal:replace="context/browsername" />?</a>
        </tal:person>
        <tal:team condition="view/context_is_probably_a_team">
          <a href="+claimteam">Is this a team you run?</a>
        </tal:team>
      </tal:logged-in>

      <tal:not-logged-in condition="not: request/lp:person">
        <a href="+claim">Are you <span tal:replace="context/browsername" />?</a>
      </tal:not-logged-in>
    </tal:noaccount>

    <tal:deactivated-account
        condition="context/account_status/enumvalue:DEACTIVATED">
      <p>
        <span tal:replace="context/browsername" /> does not use
        Launchpad.
      </p>
    </tal:deactivated-account>
  </div>

</div>
</body>
</html>
