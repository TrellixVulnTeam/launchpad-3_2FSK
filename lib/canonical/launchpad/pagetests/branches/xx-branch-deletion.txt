= Deleting branches =

Branches that have no revisions or links to other Launchpad objects
can be deleted.  The main use for this is to allow users to delete
branches that have been created in error.

    >>> browser = setupBrowser(auth="Basic test@canonical.com:test")
    >>> browser.open('http://code.launchpad.dev/~name12')
    >>> browser.getLink(id="register-branch").click()
    >>> browser.getControl('Project').value = 'firefox'
    >>> browser.getControl('Branch URL').value = 'http://foo.bar.com/oops'
    >>> browser.getControl('Name').value = 'to-delete'
    >>> browser.getControl('Register Branch').click()
    >>> browser.title
    '...~name12/firefox/to-delete... branch in Launchpad'

The newly created branch has an action 'Delete branch'.

    >>> delete_link = browser.getLink('Delete branch')
    >>> print delete_link.url
    http://code.launchpad.dev/~name12/firefox/to-delete/+delete

The branch deletion page does not say that items must be deleted.

    >>> delete_link.click()
    >>> content = extract_text(find_main_content(browser.contents))
    >>> 'The following items must be deleted' not in content
    True

If the user subscribes to the branch, then the branch is still deletable.

    >>> browser.getLink('Subscribe').click()
    >>> # Just use the default settings since we don't care.
    >>> browser.getControl('Subscribe').click()
    >>> delete_link = browser.getLink('Delete branch')

When the user clicks on the link, they are informed what will happen if they
delete the branch.

    >>> delete_link.click()
    >>> print extract_text(find_main_content(browser.contents))
    ~name12/firefox/to-delete for the Mozilla Firefox project
    Delete branch
    The following items must be deleted:
    Subscription of Sample Person to ~name.../firefox/to-delete (This is a
    subscription to this branch.)
    Branch deletion is permanent.

Once the branch has been deleted, the user is taken back to the code
listing for the owner of the branch, and a message is shown saying that
the branch has been deleted.

    >>> browser.getControl('Delete').click()
    >>> print browser.url
    http://code.launchpad.dev/~name12
    >>> for message in get_feedback_messages(browser.contents):
    ...     print message
    Branch ~name12/firefox/to-delete deleted.
