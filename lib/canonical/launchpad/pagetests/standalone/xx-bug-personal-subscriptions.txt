Personal Subscriptions
======================

The user should be able to subscribe and unsubscribe from bugs in
Launchpad.

When they are not subscribed, they should see the "Subscribe" link in
the actions portlet.

  >>> browser.addHeader('Authorization', 'Basic foo.bar@canonical.com:test')
  >>> browser.open('http://localhost/products/firefox/+bug/1')
  >>> browser.url
  'http://localhost/products/firefox/+bug/1'

  >>> subscribe_link = browser.getLink('Subscribe')
  >>> subscribe_link
  <Link...>

If they follow that link, they should be able to see the page that asks them
if they want to subscribe. The "Subscribe" button should be visible on the
page.

  >>> subscribe_link.click()

  >>> subscription_widget = browser.getControl(name='field.subscription')
  >>> subscription_widget.options
  ['name16']

  >>> submit = browser.getControl('Continue')

Now, let's POST that back to the bug home page. It should show the user. It
should also show a message, and the link should change to "Unsubscribe".


  >>> submit.click()

  >>> browser.url
  'http://localhost/products/firefox/+bug/1/'

XXX: check properly that the user is subscribed.

  >>> print browser.contents
  <...
  ...You have been subscribed to this...
  ...Unsubscribe...
  ...Foo Bar...



Now, we want to view the +subscribe page again. It should say "Unsubscribe"
because we are now a subscriber.

  >>> subscribe_link = browser.getLink('Unsubscribe')
  >>> subscribe_link.click()
  >>> browser.url
  'http://localhost/products/firefox/+bug/1/+subscribe'

And if we POST that back to the bug home page, we will be unsubscribed in a
spectacular fashion.

  >>> submit = browser.getControl('Continue')
  >>> submit.click()

  >>> browser.url
  'http://localhost/products/firefox/+bug/1/'

  >>> print browser.contents
  <...
  ...You have been unsubscribed from this...
  ...Subscribe...
