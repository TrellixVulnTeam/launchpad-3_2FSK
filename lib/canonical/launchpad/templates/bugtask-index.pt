<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  xml:lang="en"
  lang="en"
  dir="ltr"
  metal:use-macro="view/macro:page/onecolumn"
>
  <body>
    <div metal:fill-slot="main" tal:define="context_menu context/menu:context">
      <p class="object timestamp">

          Bug #<tal:block content="context/bug/id"/> reported
          by <tal:reporter replace="structure context/bug/owner/fmt:link" />
          <span
              tal:attributes="title context/bug/datecreated/fmt:datetime"
              tal:content="context/bug/datecreated/fmt:displaydate" />
          <tal:activitylog
            define="link context_menu/activitylog"
            condition="link/enabled"
          >(<tal:link replace="structure link/render" />)</tal:activitylog>

      </p>
      <div class="object identifier">

          <a tal:attributes="href context/bug/fmt:url">
            <tal:icon replace="structure context/image:icon" />
            Bug #<span tal:content="context/bug/id"
            >12345</span><tal:nickname
                          condition="context/bug/name">
          (<tal:nicknametext replace="context/bug/name" />)</tal:nickname>:</a>

      </div>
      <tal:privacy replace="structure context/bug/@@+portlet-privacy" />
      <h1 tal:replace="structure view/bug_title_edit_widget">
        Bug title
      </h1>

      <tal:block condition="view/reportBugInContext" />

      <p class="informational message"
         tal:condition="view/notices"
         tal:repeat="notice view/notices"
         tal:content="notice">
        Reported this bug as also occurring in upstream firefox
      </p>

      <p
         id="can-expire"
         tal:condition="context/bug/can_expire"
         >
        <tal:expiration_message replace="view/expiration_message" />
        (<a href="https://help.launchpad.net/BugExpiry">find out why</a>)
      </p>

      <p id="bug-is-question" class="informational message"
         tal:condition="context/bug/getQuestionCreatedFromBug"
         tal:define="question context/bug/getQuestionCreatedFromBug">
        This bug report was converted into a question:
        question #<tal:question-id replace="question/id" />:
        <a href=""
           tal:attributes="href question/fmt:url"
           tal:content="question/title">%s</a>.
        <tal:XXX condition="nothing">
          # XXX mpt 20080716 bug=249094: This should be an alert only when
          # you have just now converted the report into a question.
        </tal:XXX>
      </p>
      <form
          tal:condition="not:view/isReportedInContext"
          class="error message"
          name="alsooccursin"
          method="POST"
          >

        This bug isn't linked to
        <strong><a
           tal:attributes="href string:${context/target/fmt:url}"
           tal:content="context/bugtargetdisplayname"
           >Mozilla Firefox</a></strong>.  Would you like to report it here as
           well?<br/>

        <tal:loggedin condition="request/lp:person">

          <center><input
              type="submit"
              name="reportbug"
              value=""
              tal:attributes="value string:Yes, report in ${context/bugtargetdisplayname}"
              /></center>
        </tal:loggedin>
        <tal:notloggedin condition="not:request/lp:person">
          If you want to report it in <tal:block
          content="context/bugtargetdisplayname" />,
          you must <a href="+login">log in</a> first.
        </tal:notloggedin>

      </form>

      <table style="width: 100%; margin-bottom: 0.33em;">
        <tr>
          <td style="text-align: left; width: 50%;">
            <a
              tal:define="link context_menu/markduplicate"
              tal:condition="python: link.enabled and not
                            context.bug.duplicateof"
              tal:attributes="href link/url">
              <img src="/@@/bug-dupe-icon" /> Mark as duplicate</a>
            <tal:block
              tal:condition="context/bug/duplicates"
              tal:define="number_of_dupes context/bug/duplicates/count"
            ><span id="number_of_dupes">(This bug has
            <tal:num-dupes condition="python:number_of_dupes == 1">1
            duplicate)</tal:num-dupes>
            <tal:num-dupes condition="python:number_of_dupes > 1"
            content="string:${number_of_dupes} duplicates)"
            >2 duplicates</tal:num-dupes></span>
            </tal:block>
            <tal:block
              tal:define="duplicateof context/bug/duplicateof"
              tal:condition="duplicateof"
            >Duplicate of
              <a
                tal:condition="duplicateof/required:launchpad.View"
                tal:attributes="href duplicateof/fmt:url; title
                   duplicateof/title; style string:margin-right: 4px;
                   id string:duplicate-of;"
                tal:content="string:bug #${duplicateof/id}"
              >bug #42</a>
                <span
                  tal:condition="not:duplicateof/required:launchpad.View"
                  tal:replace="string:bug #${duplicateof/id}" />
            <a
              tal:define="link context_menu/markduplicate"
              tal:condition="python: link.enabled"
              id="change_duplicate_bug"
              title="Edit or remove linked duplicate bug"
              tal:attributes="href link/url">
              <img src="/@@/edit" />
            </a>

            </tal:block>
          </td>

          <td style="text-align: right; width: 50%;">
            <tal:createquestion
              define="link context_menu/createquestion"
              condition="link/enabled"
              replace="structure link/render" />

            <tal:removequestion
              define="link context_menu/removequestion"
              condition="link/enabled"
              replace="structure link/render" />
          </td>
        </tr>
      </table>

      <div tal:replace="structure context/bug/@@+bugtasks-and-nominations-table" />

      <div id="maincontentsub">
        <div id="nonportlets">

      <div class="report">
        <tal:description
            define="global description context/bug/description/fmt:obfuscate-email/fmt:text-to-html" />

        <div id="bug-description" tal:content="structure description" />

          <div id="bug-tags" tal:define="tags context/bug/tags" tal:condition="tags"
               style="width: 45%: text-align: left; float: right;">
            Tags:
            <a tal:repeat="tag tags"
               tal:content="tag"
               tal:attributes="href string:${context/target/fmt:url}/+bugs?field.tag=${tag}">tag</a>
          </div>

          <div style="width: 45%: text-align: right; float: left;" class="clearfix">
            <tal:editdescription
                define="link context_menu/editdescription"
                condition="link/enabled"
                replace="structure link/render" />
            <span tal:condition="view/wasDescriptionModified" class="discreet"
            >(see <a href="comments/0">original description</a>)</span>
          </div>

        <div class="clearfix"></div>
      </div>

      <tal:branches define="bug_branches view/bug_branches"
                    condition="bug_branches">

        <h2>Related branches</h2>

        <tal:bug-branches repeat="bug_branch bug_branches">
          <div tal:define="show_edit bug_branch/required:launchpad.Edit"
               tal:condition="bug_branch/branch/required:launchpad.View">
            <div class="bug-branch-summary">
              <tal:branch-ref replace="structure bug_branch/branch/fmt:link"/>
              (<span tal:content="bug_branch/branch/lifecycle_status/title"
              tal:attributes="class string:branchstatus${bug_branch/branch/lifecycle_status/name}"
              >Experimental</span>)
              <tal:bug_branch_status condition="not: show_edit|nothing"
                                     replace="bug_branch/status/title"/>
              <a tal:condition="show_edit"
                 tal:attributes="href string:${bug_branch/branch/fmt:url}/+bug/${bug_branch/bug/id}/+edit;
                                 onclick string:return switchBugBranchFormAndWhiteboard('${bug_branch/id}')">
                <img src="/@@/bug-status-expand"/>
              </a>
              <dl tal:condition="bug_branch/whiteboard"
                  tal:attributes="id string:bugbranch${bug_branch/id}-wb">
                <dd>
                  <tal:whiteboard content="structure bug_branch/whiteboard/fmt:text-to-html">
                    The whiteboard.
                  </tal:whiteboard>
                </dd>
              </dl>
            </div>
            <div tal:condition="show_edit|nothing"
                 tal:attributes="id string:bugbranch${bug_branch/id}"
                 style="display: none"
                 >
              <dl><dd>
                <tal:edit-form replace="structure bug_branch/@@+bug-edit"/>
              </dd></dl>
            </div>
          </div>
        </tal:bug-branches>
      </tal:branches>

      <p>
        <tal:addbranch
            define="link context_menu/addbranch"
            condition="link/enabled"
            replace="structure link/render" />
      </p>

      <div tal:condition="context/bug/cves">
        <h2>CVE References</h2>
        <ul>
          <li class="cve" tal:repeat="cve context/bug/cves">
            <a tal:attributes="href cve/fmt:url;
                               title cve/description/fmt:shorten/40"
               tal:content="cve/sequence"
               >2002-1342</a>
          </li>
        </ul>
      </div>
      <div class="actions">
        <tal:linktocve
            define="link context_menu/linktocve"
            condition="link/enabled"
            replace="structure link/render" />
        <tal:unlinkcve
            define="link context_menu/unlinkcve"
            condition="link/enabled"
            replace="structure link/render" />
      </div>

      <tal:comment repeat="comment view/getBugCommentsForDisplay">
        <tal:comment-box condition="comment/can_be_shown">
          <metal:comment-box
              metal:use-macro="context/@@bugcomment-macros/comment-box" />
        </tal:comment-box>
      </tal:comment>

      <tal:logged-in condition="view/user">
        <fieldset class="collapsible collapsed">
          <legend><a href="+addcomment">Add a comment/attachment</a></legend>
          <div tal:content="structure context/@@+addcomment-form" />
        </fieldset>
      </tal:logged-in>
      <tal:not-logged-in condition="not: view/user">
        <div align="center">
          To post a comment you must <a href="+login">log in</a>.
        </div>
      </tal:not-logged-in>
      <div id="mentoring" style="margin-top: 2em;">
        <tal:mentors define="mentoring_offers context/bug/mentoring_offers"
                     condition="mentoring_offers">
          <p>
            <b>Mentors:</b>
            <tal:block repeat="mentoring_offer mentoring_offers">
              <a tal:replace="structure mentoring_offer/owner/fmt:link">foobar</a>
            </tal:block>
          </p>
          <tal:block condition="not: context/bug/is_complete">
            <div tal:condition="view/userIsMentor" class="actions">
              <img class="inlineLinkIcon" src="/@@/remove" alt=""/><a href="+retractmentoring">Retract my offer of mentorship</a>
            </div>
          </tal:block>
        </tal:mentors>
        <p tal:define="link context_menu/offermentoring"
             tal:condition="link/enabled"
             tal:content="structure link/render"
        />
      </div>
      <div class="related">
        <h2>What next?</h2>
        <ul>
          <li>
            <a
                tal:attributes="href string:${context/target/fmt:url}/+filebug"
                >Report another bug</a>
            about <tal:context replace="context/target/displayname" />
          </li>
          <li>
            <a
                tal:attributes="href string:${context/target/fmt:url}/+bugs"
                >List open bugs</a>
            for <tal:context replace="context/target/displayname" />
          </li>
        </ul>
      </div>

        </div><!-- id="nonportlets"-->
      </div><!--- id="maincontentsub"-->
      <div id="portlets">
        <div tal:replace="structure context/bug/@@+portlet-duplicates" />
        <div tal:replace="structure context/bug/@@+portlet-subscribers" />
        <div tal:replace="structure context/bug/@@+portlet-questions" />
        <div tal:replace="structure context/bug/@@+portlet-specs" />
        <div tal:replace="structure context/bug/@@+portlet-attachments" />
        <div tal:replace="structure context/bug/@@+portlet-watch" />
        <div tal:replace="structure context/@@+portlet-search" />
      </div>
    </div>
  </body>
</html>
