# identify the component configuration used to define the site:
site-definition site.zcml

# Turn off Zope3 developer mode.
devmode off

# number of bytecode instructions to execute between checks for
# interruptions (SIGINTR, thread switches):
interrupt-check-interval 200

# Do not start any Launchpad servers!

# non-persistent in-memory storage
<zodb>
  <mappingstorage/>
</zodb>

<accesslog>
  <logfile>
    path /srv/staging.launchpad.net/staging-logs/launchpad-access.log
  </logfile>
</accesslog>

<eventlog>
  <logfile>
    path /srv/staging.launchpad.net/staging-logs/launchpad.log
  </logfile>
</eventlog>

<canonical default>
    dbname launchpad_staging
    # Might want this on, but for now test what will be seen in production
    show_tracebacks false
    bounce_address bounces@canonical.com
    pid_dir /srv/staging.launchpad.net/var

    <launchpad>
        dbuser launchpad
        openid_users openid-testers
        errors_address launchpad-error-reports@lists.canonical.com
        bugs_domain bugs.staging.launchpad.net
        specs_domain specs.staging.launchpad.net
        is_demo true
        site_message Testing environment. All changes made will be reset.

        <virtual_hosts>
            use_https yes
            <mainsite>
                hostname staging.launchpad.net
                althostnames localhost, asuka.ubuntu.com
            </mainsite>
            <api>
                hostname api.staging.launchpad.net
            </api>
            <blueprints>
                hostname blueprints.staging.launchpad.net
            </blueprints>
            <code>
                hostname code.staging.launchpad.net
            </code>
            <translations>
                hostname translations.staging.launchpad.net
            </translations>
            <bugs>
                hostname bugs.staging.launchpad.net
            </bugs>
            <answers>
                hostname answers.staging.launchpad.net
            </answers>
            <openid>
                hostname login.staging.launchpad.net
            </openid>
            <shipitubuntu>
                hostname ubuntu.shipit.staging.launchpad.net
                althostnames shipit.staging.launchpad.net
            </shipitubuntu>
            <shipitkubuntu>
                hostname kubuntu.shipit.staging.launchpad.net
            </shipitkubuntu>
            <shipitedubuntu>
                hostname edubuntu.shipit.staging.launchpad.net
            </shipitedubuntu>
            <xmlrpc>
                hostname xmlrpc.staging.launchpad.net
                rooturl https://staging.launchpad.net/
            </xmlrpc>
            <xmlrpc-private>
                hostname xmlrpc.staging.lp.internal
            </xmlrpc-private>
            <feeds>
                hostname feeds.staging.launchpad.net
            </feeds>
        </virtual_hosts>

        db_statement_timeout 36000
        soft_request_timeout 18000

        <launchpad_session>
            dbuser session
            dbname session_staging
            cookie staging
        </launchpad_session>
        <launchpad_errorreports>
            errordir /srv/staging.launchpad.net/staging-logs
            oops_prefix S
            copy_to_zlog false
        </launchpad_errorreports>
    </launchpad>

    <productreleasefinder>
        dbuser productreleasefinder
    </productreleasefinder>

    <branchscanner>
        dbuser branchscanner
        <script_errorreports>
            errordir /srv/bzrsyncd.staging.launchpad.net/staging-logs/branch-scanner
            oops_prefix SSMS
            copy_to_zlog false
        </script_errorreports>
    </branchscanner>

    <authserver>
    </authserver>

    <librarian>
        dbuser librarian
        upload_host asuka.ubuntu.com
        upload_port 58090
        download_host asuka.ubuntu.com
        download_port 9040
        download_url http://staging.launchpadlibrarian.net/
        buildd_download_url http://staging.launchpadlibrarian.net/
        <librarian_server>
            logfile /srv/staging.launchpad.net/staging-logs/librarian.log
            root /srv/staging.launchpad.net/staging/librarian
            launch no
            spew no
            upstream_host librarian.ubuntu.com
            upstream_port 80
        </librarian_server>
        <librarian_gc>
            dbuser librariangc
        </librarian_gc>
    </librarian>

    <malone>
        # The From address for Malone email interface errors
        bugmail_error_from_address noreply@bugs.staging.launchpad.net
        buglist_batch_size 50
    </malone>

    <shipit>
        # XXX: salgado 2006-06-16 bug=50033:
        # Even though this is empty, it must be kept so that the default
        # values are used. See https://launchpad.net/bugs/50033 for details.
    </shipit>

    <rosetta>
        <poimport>
            dbuser poimport
        </poimport>
        <rosettaadmin>
            dbuser rosettaadmin
        </rosettaadmin>
    </rosetta>

    <distributionmirrorprober>
        dbuser distributionmirror
        cdimage_file_list_url http://releases.ubuntu.com/.manifest
        timeout 30
    </distributionmirrorprober>

    <cveupdater>
        dbuser cve
    </cveupdater>

    <zopeless>
        send_email no
        smtp_host localhost
        smtp_port 25
    </zopeless>

    <gpghandler>
        host keyserver.internal 
        public_host keyserver.ubuntu.com
        port 11371
    </gpghandler>

    <zeca>
        root /var/tmp/zeca
    </zeca>

    <gina>
        dbuser gina
        <gina_target warty>
            distro ubuntu
            distroseries warty
            pocketrelease warty
            root /srv/archive.ubuntu.com/ubuntu
            architectures i386,powerpc,amd64
        </gina_target>
        <gina_target warty-updates>
            distro ubuntu
            distroseries warty
            pocketrelease warty-updates
            pocket updates
            root /srv/archive.ubuntu.com/ubuntu
            architectures i386,powerpc,amd64
        </gina_target>
        <gina_target warty-security>
            distro ubuntu
            distroseries warty
            pocketrelease warty-security
            pocket security
            root /srv/archive.ubuntu.com/ubuntu
            architectures i386,powerpc,amd64
        </gina_target>
        <gina_target hoary>
            distro ubuntu
            distroseries hoary
            pocketrelease hoary
            root /srv/archive.ubuntu.com/ubuntu
            architectures i386,powerpc,amd64,ia64,sparc
        </gina_target>
        <gina_target hoary-updates>
            distro ubuntu
            distroseries hoary
            pocketrelease hoary-updates
            pocket updates
            root /srv/archive.ubuntu.com/ubuntu
            architectures i386,powerpc,amd64,ia64,sparc
        </gina_target>
        <gina_target hoary-security>
            distro ubuntu
            distroseries hoary
            pocketrelease hoary-security
            pocket security
            root /srv/archive.ubuntu.com/ubuntu
            architectures i386,powerpc,amd64,ia64,sparc
        </gina_target>
        <gina_target hoary-backports>
            distro ubuntu
            distroseries hoary
            pocketrelease hoary-backports
            pocket backports
            root /srv/archive.ubuntu.com/ubuntu
            architectures i386,powerpc,amd64,ia64,sparc
        </gina_target>
        <gina_target breezy>
            distro ubuntu
            distroseries breezy
            pocketrelease breezy
            root /srv/archive.ubuntu.com/ubuntu
            architectures i386,powerpc,amd64,ia64,sparc,hppa
        </gina_target>
        <gina_target breezy-updates>
            distro ubuntu
            distroseries breezy
            pocketrelease breezy-updates
            pocket updates
            root /srv/archive.ubuntu.com/ubuntu
            architectures i386,powerpc,amd64,ia64,sparc,hppa
        </gina_target>
        <gina_target breezy-security>
            distro ubuntu
            distroseries breezy
            pocketrelease breezy-security
            pocket security
            root /srv/archive.ubuntu.com/ubuntu
            architectures i386,powerpc,amd64,ia64,sparc,hppa
        </gina_target>
        <gina_target dapper>
            distro ubuntu
            distroseries dapper
            pocketrelease dapper
            root /srv/archive.ubuntu.com/ubuntu
            architectures i386,powerpc,amd64,ia64,sparc,hppa
        </gina_target>
        <gina_target dapper-updates>
            distro ubuntu
            distroseries dapper
            pocketrelease dapper-updates
            pocket updates
            root /srv/archive.ubuntu.com/ubuntu
            architectures i386,powerpc,amd64,ia64,sparc,hppa
        </gina_target>
        <gina_target dapper-security>
            distro ubuntu
            distroseries dapper
            pocketrelease dapper-security
            pocket security
            root /srv/archive.ubuntu.com/ubuntu
            architectures i386,powerpc,amd64,ia64,sparc,hppa
        </gina_target>
    </gina>

    <buildsequencer>
        # mailproblemsto launchpad-error-reports@lists.canonical.com
        mailproblemsto lp_archive@localhost
        # It makes no sense to allow the sequencer to start by default
        # on a developer machine because they're unlikely to have a 
        # build farm of their own. This does not prevent the daemon from
        # ever starting.
        launch no
        logfile -
        <buildsequencer_job slave_scanner>
            command cronscripts/buildd-slave-scanner.py
            mindelay 10
        </buildsequencer_job>
    </buildsequencer>

    <statistician>
        dbuser statistician
    </statistician>

    <answertracker>
        dbuser answertracker
        email_domain answers.staging.launchpad.net
    </answertracker>

    <uploadqueue>
        dbuser queued
    </uploadqueue>

    <uploader>
        dbuser uploader
        default_recipient_name Default Recipient
        default_recipient_address dsilvers@digital-scurf.org
        default_sender_name Default Sender
        default_sender_address dsilvers@staging.ubuntu.com
    </uploader>

    <builddmaster>
        dbuser fiera
        uploader scripts/process-upload.py -Mvv --context buildd
        root /srv/launchpad.net/builddmaster/
        socket_timeout 600
    </builddmaster>

    <supermirror>
        dbuser supermirror
        branchesdest /srv/bazaar.staging.launchpad.net/mirrors
        masterlock /srv/bazaar.staging.launchpad.net/data/masterlock
        authserver_url http://asuka.ubuntu.com:8999/branch/
        warehouse_root_url http://bazaar.staging.launchpad.net/+branches/
        maximum_workers 4
        <mirror_puller_errorreports>
            errordir /srv/bazaar.staging.launchpad.net/staging-logs/branch-puller-mirror
            oops_prefix SMSM
            copy_to_zlog false
        </mirror_puller_errorreports>
        <upload_puller_errorreports>
            errordir /srv/bazaar.staging.launchpad.net/staging-logs/branch-puller-upload
            oops_prefix SMSU
            copy_to_zlog false
        </upload_puller_errorreports>
        <import_puller_errorreports>
            errordir /srv/bazaar.staging.launchpad.net/staging-logs/branch-puller-import
            oops_prefix SMSI
            copy_to_zlog false
        </import_puller_errorreports>
    </supermirror>

    <codehosting>
        authserver http://asuka.ubuntu.com:8999/v2/
        host_key_pair_path /srv/bazaar.staging.launchpad.net/keys/
        branches_root /srv/bazaar.staging.launchpad.net/push-branches/
        port tcp:22:interface=91.189.90.153
        debug_logfile /srv/bazaar.staging.launchpad.net/staging-logs/codehosting/debug.log
        # The staging smart server and supermirror.
        supermirror_root http://bazaar.staging.launchpad.net/
        smartserver_root bzr+ssh://%(user)s@bazaar.staging.launchpad.net/
        # Point to staging codebrowse.
        codebrowse_root http://codebrowse.staging.launchpad.net/
    </codehosting>

    <codeimport>
    </codeimport>

    <karmacacheupdater>
        # Configuration used to run the karmacache updater.
        dbuser karma
    </karmacacheupdater>

    <targetnamecacheupdater>
        # Configuration used to run the bugtask targetnamecache updater.
        dbuser targetnamecacheupdater
    </targetnamecacheupdater>

    <expiredmembershipsflagger>
        dbuser teammembership
    </expiredmembershipsflagger>

    <personalpackagearchive>
    </personalpackagearchive>

    <archivepublisher>
    </archivepublisher>

    <mailman>
        <mailman-build>
            # If you change anything in this section, you must manually clean
            # and rebuild Mailman.  This will not happen automatically, and
            # Mailman will not build at all if the Mailman package can be
            # imported.

            # Whether Mailman should be built if it is not already.
            build yes

            # The --prefix location for the configure script.  This can be a
            # relative path to indicate a location relative to the
            # runlaunchpad.py script's current working directory.
            prefix lib/mailman

            # The 'VAR_DIR' location.  This is where Mailman will put and look
            # for variable run time data, such as the list pickles and queue
            # directories.
            var_dir /srv/lists.staging.launchpad.net/var/mailman

            # The user:group names that the Mailman process will run under.
            # You may need to invoke buildmailman.py or "make run" as root via
            # sudo to have the necessary permissions during the build or run
            # phase.  Leave this commented to use the current user and group.
            user_group launchpad:launchpad

            # Uncomment this to specify the site list's owner address and
            # password.  Otherwise, a fake email address and random password
            # will be used.
            #site_list_owner you@example.com:password

            # Uncomment this if you want a host_name other than the current
            # machine's `hostname -f`.  This is only used for the email domain
            # part.
            host_name lists.staging.launchpad.net
        </mailman-build>

        # Whether Mailman should be started (i.e mailmanctl start).
        launch yes

        # Host and port for connecting to the outgoing smtp server.  Valid
        # format is [host][:port] where the default is localhost:25
        smtp smtp.staging.launchpad.net:25

        xmlrpc_url http://xmlrpc.staging.lp.internal:8097/mailinglists
        #xmlrpc_runner_sleep 10

        beta_testers_team mailing-list-beta-testers
        archive_url_template http://lists.staging.launchpad.net/$$team_name
        list_subscription_headers https://staging.launchpad.net/people/+me/+editemails
        list_owner_header_template https://staging.launchpad.net/~$$team_name
    </mailman>

    <processmail>
        dbuser processmail
    </processmail>

    <checkwatches>
        # XXX: 2007-08-30 Graham Binns
        #      We have a default value for this, but due to bug 50033 we
        #      have to leave this empty section here.
    </checkwatches>
</canonical>
