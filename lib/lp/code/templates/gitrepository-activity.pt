<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  metal:use-macro="view/macro:page/main_only" i18n:domain="launchpad">

<body>

  <metal:macros fill-slot="bogus">
    <metal:macro define-macro="activity-value">
      <ul tal:condition="value">
        <li><b>Ref Pattern:</b> <span tal:content="value/ref_pattern" /></li>
        <tal:comment condition="nothing">
          Grant changes
        </tal:comment>
        <span tal:condition="python:'can_create' in value"><b>create: </b><span tal:content="value/can_create" />,
        </span>
        <span tal:condition="python:'can_push' in value"><b>push: </b><span tal:content="value/can_push" />, </span>
        <span tal:condition="python:'can_force_push' in value"><b>force-push: </b><span tal:content="value/can_force_push" /></span>
        <tal:comment condition="nothing">
          Rule changes
        </tal:comment>
        <li tal:condition="python: 'position' in value">Rule position: <span tal:content="value/position" /></li>
      </ul>
    </metal:macro>
  </metal:macros>

  <div metal:fill-slot="main">
    <div class="yui-g">
      <div class="top-portlet">
        <h1>Activity log for repository <span tal:replace="context/display_name" /></h1>
        <table id="activity-listing" class="listing">
          <thead>
            <tr>
              <th>Date</th>
              <th>Author</th>
              <th>Target</th>
              <th>What changed</th>
              <th>Old value</th>
              <th>New value</th>
            </tr>
          </thead>
          <tbody>
            <tr tal:repeat="log view/activity">
              <tal:comment condition="nothing">
                XXX: Gavin Panella 2009-08-12 bug=412963: Using strftime()
                here because fmt:datetime changes timezone, even though we
                always want to show only UTC.
              </tal:comment>
              <td tal:content="python:log.date_changed.strftime('%Y-%m-%d %T')">
                2004-09-24 12:04:43
              </td>
              <td tal:content="structure log/changer/fmt:link">Changer</td>
              <td tal:content="structure log/changee/fmt:link">Changee</td>
              <td tal:content="log/what_changed/title">description</td>
              <td>
                <tal:activity define="value log/old_value">
                  <metal:logs use-macro="template/macros/activity-value" />
                </tal:activity>
              </td>
              <td>
                <tal:activity define="value log/new_value">
                  <metal:logs use-macro="template/macros/activity-value" />
                </tal:activity>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

</body>

</html>
