  >>> from canonical.launchpad.helpers import backslashreplace

Go to the calendar subscribe page for the Ubuntu project calendar,
while logged in as "Sample Person:

  >>> print backslashreplace(str(http(r"""
  ... GET /ubuntu-project/+calendar/+subscribe HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... """)))
  HTTP/1.1 200 Ok
  Content-Length: ...
  Content-Type: text/html;charset=utf-8
  <BLANKLINE>
  ...
      <title>Subscribe to \u201cUbuntu Project Calendar\u201d</title>
  ...
        <form action=".../ubuntu-project/+calendar/+subscribe"
              method="post">
  ...
                <input type="radio" name="subscribe"
                       id="subscribe-yes" value="yes"
                       checked="checked" />
  ...
                <input type="radio" name="subscribe"
                       id="subscribe-no" value="no" />
  ...
              <select name="colour">
  ...
                <option style="background-color: #faffd2"
                        selected="selected" value="#faffd2">Yellow</option>
  ...


Unsubscribing from the calendar updates the field values, and also
loses the selected colour (the colour is used to identify calendars in
the merged view).

  >>> print backslashreplace(str(http(r"""
  ... POST /ubuntu-project/+calendar/+subscribe HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... Content-Length: 50
  ... Content-Type: application/x-www-form-urlencoded
  ... 
  ... subscribe=no&colour=%23faffd2&UPDATE_SUBMIT=Submit""")))
  HTTP/1.1 200 Ok
  Content-Length: ...
  Content-Type: text/html;charset=utf-8
  <BLANKLINE>
  ...
      <title>Subscribe to \u201cUbuntu Project Calendar\u201d</title>
  ...
        <form action=".../ubuntu-project/+calendar/+subscribe"
              method="post">
  ...
                <input type="radio" name="subscribe"
                       id="subscribe-yes" value="yes" />
  ...
                <input type="radio" name="subscribe"
                       id="subscribe-no" value="no"
                       checked="checked" />
  ...
              <select name="colour">
  ...
                <option style="background-color: #faffd2"
                        value="#faffd2">Yellow</option>
  ...


Resubscribe to the calendar:

  >>> print http(r"""
  ... POST /ubuntu-project/+calendar/+subscribe HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... Content-Length: 51
  ... Content-Type: application/x-www-form-urlencoded
  ... 
  ... subscribe=yes&colour=%23faffd2&UPDATE_SUBMIT=Submit""")
  HTTP/1.1 200 Ok
  Content-Length: ...
  Content-Type: text/html;charset=utf-8
  <BLANKLINE>
  ...
              <select name="colour">
  ...
                <option style="background-color: #faffd2"
                        selected="selected" value="#faffd2">Yellow</option>
  ...


We can get a list of the subscribed calendars for the logged in user,
along with options to alter subscription details:

  >>> print http(r"""
  ... GET /calendar/+subscriptions HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... """)
  HTTP/1.1 200 Ok
  Content-Length: ...
  Content-Type: text/html;charset=utf-8
  <BLANKLINE>
  ...
      <title>Calendar subscriptions</title>
  ...
  ...Sample Person's Calendar...
  ...
  ...Foo Bar's Calendar...
  ...
  ...Ubuntu Project Calendar...
  ...


We can also unsubscribe from the Ubuntu Project Calendar using this
page.  :

  >>> print http(r"""
  ... POST /calendar/+subscriptions HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... Content-Length: 106
  ... Content-Type: application/x-www-form-urlencoded
  ... 
  ... sub.1=yes&colour.1=%23c0d0ff&sub.2=yes&colour.2=%23c0ffc8&sub.3=no&colour.3=%23faffd2&UPDATE_SUBMIT=Submit""")
  HTTP/1.1 200 Ok
  Content-Length: ...
  Content-Type: text/html;charset=utf-8
  <BLANKLINE>
  ...
  ...Sample Person's Calendar...
  ...
  ...Foo Bar's Calendar...
  ...


Resubscribing to the calendar for the next test:

  >>> print http(r"""
  ... POST /ubuntu-project/+calendar/+subscribe HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... Content-Length: 51
  ... Content-Type: application/x-www-form-urlencoded
  ... 
  ... subscribe=yes&colour=%23faffd2&UPDATE_SUBMIT=Submit""")
  HTTP/1.1 200 Ok
  Content-Length: ...
  Content-Type: text/html;charset=utf-8
  <BLANKLINE>
  ...


Events that show up on the subscribed calendars also show up on the
merged view:

  >>> print http(r"""
  ... GET /ubuntu-project/+calendar/2004-12-06 HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... """)
  HTTP/1.1 200 Ok
  Content-Length: ...
  Content-Type: text/html;charset=utf-8
  <BLANKLINE>
  ...
      <title>Ubuntu Project Calendar - 6 December 2004</title>
  ...
                        <a href=".../ubuntu-project/+calendar/events/5">
                        16:00
                        -
                        The Mataro Sessions
                        </a>
  ...


  >>> print http(r"""
  ... GET /calendar/2004-12-06 HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... """)
  HTTP/1.1 200 Ok
  Content-Length: ...
  Content-Type: text/html;charset=utf-8
  <BLANKLINE>
  ...
      <title>Merged Calendar for Sample Person - 6 December 2004</title>
  ...
                        <a href=".../ubuntu-project/+calendar/events/5">
                        16:00
                        -
                        The Mataro Sessions
                        </a>
  ...

