= Deactivating mailing lists =

A team administrator can also deactivate a mailing list.  Mailman handles this
by archiving and deleting the mailing list data, which allows for easy
reconstitution later.

First, No Privileges Person will create a new team through the web.  Then he
will request a mailing list for that team, and an expert will approve that
request.

    >>> import itest_helper
    >>> browser = itest_helper.make_browser()
    >>> browser.open('http://launchpad.dev/people/+newteam')
    >>> browser.getControl(name='field.name').value = 'itest-one'
    >>> browser.getControl('Display Name').value = 'ITest One'
    >>> browser.getControl(name='field.subscriptionpolicy').displayValue = [
    ...     'Open Team']
    >>> browser.getControl('Create').click()
    >>> browser.getLink('Configure mailing list').click()
    >>> browser.getControl('Apply for Mailing List').click()

    >>> list_one = itest_helper.review_list('itest-one')
    >>> from Mailman.Utils import list_names
    >>> sorted(name for name in list_names() if name.startswith('itest-'))
    ['itest-one']

Because the mailing list is active, there is no archived backup file.

    >>> from Mailman import mm_cfg
    >>> import os
    >>> backup_file = os.path.join(mm_cfg.VAR_PREFIX,
    ...                            'backups', 'itest-one.tgz')
    >>> os.path.exists(backup_file)
    False

The team administrator can deactivate the list through the web.

    >>> browser.open('http://launchpad.dev/~itest-one/+mailinglist')
    >>> browser.getControl('Deactivate this Mailing List').click()
    >>> itest_helper.wait_for_mailman()

As far as Mailman is concerned, the mailing list no longer exists.

    >>> sorted(name for name in list_names() if name.startswith('itest-'))
    []

The list data has been backed up into the archive directory.  The backup is a
gzip'd tarfile containing the list's pickle data.

    >>> os.path.exists(backup_file)
    True
    >>> import tarfile
    >>> tarball = tarfile.open(backup_file, 'r:gz')
    >>> tarball.list()
    -... itest-one/
    -... itest-one/config.pck
    -... itest-one/config.pck.last
