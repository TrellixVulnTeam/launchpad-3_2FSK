<div
  tal:omit-tag=""
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  tal:define="
    bug context/bug|context;
    direct_subscriptions view/sorted_direct_subscriptions;
    also_notified_subscribers bug/getAlsoNotifiedSubscribers
  ">
  <div class="section" id="subscribers-direct">
    <h2>Subscribers</h2>
      <div id="subscribers-links">
      <div
        tal:condition="direct_subscriptions"
        tal:repeat="subscription direct_subscriptions"
        tal:attributes="
            class subscription/css_name;
            id string:direct-${subscription/css_name}">
        <metal:subscriber metal:define-macro="subscriber-row">

            <a
               tal:condition="subscription/person/name|nothing"
               tal:attributes="
                 href subscription/person/fmt:url;
                 title subscription/display_subscribed_by;
                 name subscription/person/fmt:displayname
               "
            >
              <tal:block replace="structure subscription/person/fmt:icon" />
              <tal:block replace="subscription/person/fmt:displayname/fmt:shorten/20" />
            </a>

            <a tal:condition="python: subscription.canBeUnsubscribedByUser(view.user)"
               href="+subscribe"
               tal:attributes="
                 title string:Unsubscribe ${subscription/person/fmt:displayname};
                 id string:unsubscribe-${subscription/css_name};
                 class python: view.getSubscriptionClassForUser(subscription.person)
               "
            >
              <img class="unsub-icon" src="/@@/remove" alt="Remove"
                tal:attributes="id string:unsubscribe-icon-${subscription/css_name}" />
            </a>

        </metal:subscriber>
      </div>
      </div>
      <div id="none-subscribers"
        tal:condition="not:direct_subscriptions">None</div>
  </div>
  <div id="subscribers-from-duplicates-container">
    <a id="subscribers-from-dupes-content-link"
       tal:attributes="href bug/fmt:url/+bug-portlet-dupe-subscribers-content"></a>
    <div id="subscribers-portlet-dupe-spinner"
         style="text-align: center; display: none">
      <img src="/@@/spinner" />
    </div>
  </div>
  <div
    tal:condition="also_notified_subscribers"
    id="subscribers-indirect"
    class="Section"
  >
    <h2>Also notified</h2>
    <div
      tal:repeat="subscriber also_notified_subscribers"
      tal:content="structure subscriber/fmt:link"
    />
  </div>
</div>
