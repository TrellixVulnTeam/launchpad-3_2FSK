<div
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  id="series-derivation" class="portlet"
  tal:define="overview_menu context/menu:overview">
  <tal:is_derived condition="context/is_derived_series">
    <tal:is_initialised condition="not: context/is_initialising">
    <h2>Derived from <tal:name replace="context/parent_series/displayname"/></h2>

      <tal:diffs define="nb_diffs view/num_differences;
                         nb_diffs_in_parent view/num_differences_in_parent;
                         nb_diffs_in_child view/num_differences_in_child;">
        <ul id="derivation_stats">
          <li class="sprite info" tal:condition="nb_diffs">
            <a tal:attributes="href string:${context/fmt:url}/+localpackagediffs">
              <tal:nb_diffs replace="nb_diffs"/>
                package<tal:plural
                         content="string:s"
                         condition="python:nb_diffs!=1"/> with differences.
            </a>
          </li>
         <li class="sprite info" tal:condition="nb_diffs_in_parent">
            <a tal:attributes="href string:${context/fmt:url}/+missingpackages">
              <tal:nb_diffs replace="nb_diffs_in_parent"/>
                package<tal:plural
                         content="string:s"
                         condition="python:nb_diffs_in_parent!=1"/>
                in <tal:replace
                     replace="context/parent_series/displayname">Sid</tal:replace>.
            </a>
          </li>
          <li class="sprite info" tal:condition="nb_diffs_in_child">
            <a tal:attributes="href string:${context/fmt:url}/+uniquepackages">
              <tal:nb_diffs replace="nb_diffs_in_child"/>
                package<tal:plural
                         content="string:s"
                         condition="python:nb_diffs_in_child!=1"/>
                in <tal:replace replace="context/displayname">Natty</tal:replace>.
            </a>
          </li>
         </ul>
        <tal:no_diffs
          condition="python:not(nb_diffs or nb_diffs_in_parent or nb_diffs_in_child)">
          No differences.
        </tal:no_diffs>
      </tal:diffs>
  </tal:is_initialised>
  <tal:is_initialising condition="context/is_initialising">
    <h2>Derived series</h2>
      This series is initialising.
  </tal:is_initialising>
  </tal:is_derived>
</div>
