<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  xml:lang="en"
  lang="en"
  dir="ltr"
  metal:use-macro="context/@@main_template/master"
  i18n:domain="launchpad"
>

  <head>
    <metal:head_epilogue fill-slot="head_epilogue">
      <script type="text/javascript">
        function disableSubmitButton() {
          var form = document.forms['shipit'];
          form.FORM_SUBMIT.disabled = true;
        }
      //</script>
    </metal:head_epilogue>
  </head>
<body>

<div metal:fill-slot="body">

<table>
<tbody>
<tr>
<td width="75%" style="vertical-align: top;" id="maincontent">

<tal:shipit-is-open condition="view/is_open" define="user view/user">

  <p class="informational message"
     tal:define="status view/process_status"
     tal:condition="status"
     tal:content="structure status" />

  <div class="error message"
    tal:repeat="top_of_page_error view/top_of_page_errors"
    tal:content="structure top_of_page_error">
    Schema validation errors.
  </div>

  <tal:current_request condition="view/current_order">
    <h1>Current Request Details</h1>
    <ul>
      <tal:block repeat="requested_cds view/current_order/getAllRequestedCDs">
        <li tal:condition="requested_cds/quantity">
          <strong tal:content="requested_cds/description" />
        </li>
      </tal:block>
    </ul>
    <div>
      <form name="cancelrequest" action="" method="post">
        <input type="hidden" name="order" 
               tal:attributes="value view/current_order/id" />

        <input type="submit" value="Cancel Request" name="cancel"
               class="formControls"/>
      </form>
    </div>
  </tal:current_request>

  <tal:pastrequests condition="user/pastShipItRequests">
    <h1>Shipped/Cancelled requests</h1>

    <metal:pastrequests use-macro="context/@@+shipit-macros/previous_requests" />
  </tal:pastrequests>

  <tal:has-current-order condition="view/current_order">
    <h1 tal:condition="view/currentOrderContainsCDsOfThisFlavour">
      Change your current request
    </h1>

    <h1 tal:condition="not: view/currentOrderContainsCDsOfThisFlavour">
      Request more CDs
    </h1>
  </tal:has-current-order>

  <tal:no-current-order condition="not: view/current_order">
    <h1 tal:condition="not: view/current_order">
      <span tal:condition="view/prerelease_mode">Pre-order</span>
      <span tal:condition="not: view/prerelease_mode">Request</span>
      <span tal:replace="view/flavour/title" />
      <span tal:replace="view/series/title" /> CDs
    </h1>

    <p class="informational message">
      <tal:no-prerelease condition="not: view/prerelease_mode">
        We can send you CDs free of charge, but it will take from
        six to ten weeks to deliver, so you may prefer to
        <a tal:attributes="href view/download_url">download the CD images</a>
        and record them yourself.
      </tal:no-prerelease>
      <tal:prerelease condition="view/prerelease_mode">
      <span tal:replace="view/flavour/title" />
        <span tal:replace="view/series/title" /> has not been released yet,
        but we'll record your request and send you the CDs as soon as that
        happens. Note that delivery will take from six to ten weeks once
        they are sent.
      </tal:prerelease>
    </p>
  </tal:no-current-order>

  <p tal:condition="view/should_show_custom_request">
    Delivery of special requests can take up to
    <strong>ten weeks</strong>. For quicker processing, choose a
    <a href="/myrequest">standard option</a> instead.
  </p>

  <p tal:condition="view/is_edubuntu">
    Edubuntu CDs are available only in the <strong>PC</strong> Edition. 
    This runs on x86-based systems like Intel Pentium and AMD Athlon.
  </p>

  <tal:not-edubuntu condition="not: view/is_edubuntu">
    <p>
      Different <span tal:replace="view/flavour/title" /> CDs are made
      for different types of computer:
    </p>

    <ul>
      <li>
        <strong>PC</strong> Edition, for almost all PCs,
        including x86-based systems like Intel Pentium and AMD
        Athlon. Choose this if you are unsure.
      </li>

      <li>
        <strong>64-bit PC</strong> Edition, for computers
        based on the AMD64 or EM64T architecture (e.g., Athlon64, Opteron,
        EM64T Xeon).
      </li>
    </ul>
  </tal:not-edubuntu>

  <tal:custom-request condition="view/should_show_custom_request">

    <div class="warning message">
      <p>
        While we will consider all requests, due to extremely high
        demand we may choose to send a smaller number of CDs, or refuse
        your request altogether.
      </p>
      <p>
        Requesting a smaller number of CDs or a <a href="/myrequest">standard
        option</a> will increase your chances of having the request approved.
        Remember, you can reuse the CDs!
      </p>
    </div>
  </tal:custom-request>

  <tal:standard-request condition="not: view/should_show_custom_request">
    <p class="informational message" tal:condition="user/is_trusted_on_shipit">
      The Ubuntu community would like to thank you for your
      contributions to the Ubuntu project. In recognition of this, we
      offer you an expanded set of options for your ShipIt request.
    </p>
  </tal:standard-request>

  <!-- Without using setTimeout() to disable the submit button it'll be
  disabled before the browser generates the request, which will cause the
  request to not contain the name/value of the button.
  -->
  <form name="shipit" action="" method="post"
        accept-charset="UTF-8"
        onsubmit="javascript: window.setTimeout('disableSubmitButton()', 1);">

  <table class="headers-right-aligned">
  <tbody>
  <tr>
    <th style="vertical-align: top;">I would like:</th>
    <td tal:define="selected_id view/selected_standardrequest">

      <tal:standard-request condition="not: view/should_show_custom_request">
        <div tal:repeat="request_type view/standardShipItRequests">
          <label>
            <input type="radio" name="ordertype"
              tal:attributes="value request_type/id;
                              checked python:request_type.id == selected_id" />
            <span tal:content="request_type/description" />
          </label>
        </div>

        <p>You can make a <a href="/specialrequest">special request</a>
        for different quantities, but note this will take longer to process
        and may not be approved at all.
        We will consider special requests if you are a teacher giving CDs to
        your students, or if you are distributing CDs at a conference or other
        organized event.
        </p>
      </tal:standard-request>

      <tal:custom-request condition="view/should_show_custom_request">
        <br />
        <table style="width: auto; margin-left: 0">
          <tr>
            <td>&nbsp;</td>
            <th style="text-align: left">Quantity</th>
          </tr>
          <tr tal:repeat="widget view/quantity_widgets">
            <span metal:use-macro="context/@@+shipit-macros/display_widget" />
          </tr>
        </table>

        <br />
        <div tal:define="widget nocall:view/reason_widget">
          <label>Why are you requesting these CDs?</label>
          <div style="color: #999; font-size: smaller">
            (Your answer must be in English)
          </div>
          <span metal:use-macro="context/@@launchpad_widget_macros/display_raw_widget" />
        </div>

        <input type="hidden" name="custom" value="1" />
      </tal:custom-request>

    </td>
  </tr>

  <metal:shipping_details use-macro="context/@@+shipit-macros/shipping_details" />

  <tr>
    <td></td>
    <td>
      <p>
        Please double-check your address
        before submitting your request.
      </p>
    </td>
  </tr>
  <tr>
    <td></td>
    <td>

      <tal:current_request condition="view/current_order">
        <input tal:condition="view/currentOrderContainsCDsOfThisFlavour"
               type="submit" value="Change Request" name="FORM_SUBMIT"
               class="formControls"/>

        <input tal:condition="not: view/currentOrderContainsCDsOfThisFlavour"
               type="submit" value="Request More CDs" name="FORM_SUBMIT"
               class="formControls"/>
      </tal:current_request>

      <tal:no_current_request condition="not: view/current_order">
        <input type="submit" value="Request CDs" name="FORM_SUBMIT"
               class="formControls"/>
      </tal:no_current_request>

    </td>
  </tr>
  </tbody>
  </table>

  </form>

</tal:shipit-is-open>

<tal:shipit-is-closed condition="not: view/is_open">
  <h1>ShipIt is currently closed</h1>

  <p class="informational message">We'll be back in a few days, shipping
  <span tal:replace="view/flavour/title" />
  <span tal:replace="view/series/title" /> CDs.
  </p>

  <tal:pastrequests condition="view/user/pastShipItRequests"
                    define="user view/user">
    <h2>Shipped/Cancelled requests</h2>

    <metal:pastrequests use-macro="context/@@+shipit-macros/previous_requests" />
  </tal:pastrequests>
</tal:shipit-is-closed>

</td>
<td width="25%" style="vertical-align: top;" id="amazon-links"
    tal:condition="view/is_open">
  <span tal:content="structure view/dvds_section" />
</td>
</tr>
</tbody>
</table>  
  
</div>
</body>
</html>

