= Branches Overview =

Products should link their branch listing page.

  >>> browser.open('http://launchpad.dev/products/gnome-terminal')
  >>> browser.getLink('Code').url
  'http://code.launchpad.dev/products/gnome-terminal/'

There are two listings of branches for a product. The short tabular listing,
and the detailed branch listing that includes branch summaries and more
hyperlinks. We'll use the presence of the summary for the Gnome Terminal
Mainline branch to distinguish the pages.

  >>> gterm_main_summary = "Release branch of GNOME Terminal for the GNOME 2.6 environment."

We should be able to display a list of branches for a product at +branches.

  >>> browser.open('http://launchpad.dev/products/gnome-terminal/+branches')
  >>> gterm_main_summary in browser.contents
  False

And another at +branchlisting. That one is the detailed branch listing.

  >>> browser.open('http://launchpad.dev/products/gnome-terminal/+branchlisting')
  >>> gterm_main_summary in browser.contents
  True

If there are no branches, we should display a message stating that there is no
branch registered for this product.

  >>> browser.open('http://launchpad.dev/products/applets/+branchlisting')
  >>> print browser.contents
  <!DOCTYPE...
  ...There are no branches registered for...

== Branch Filtering ==

Branches shown for products are filterable in the same way that 
branches for people are filterable (see xx-person-branches.txt).

  >>> browser.open('http://launchpad.dev/products/gnome-terminal/+branches')
  >>> from BeautifulSoup import BeautifulSoup
  >>> soup = BeautifulSoup(browser.contents)
  >>> table = str(soup.find('table', { 'id':'branchtable' } ))
  >>> status_values = ['New', 'Experimental', 'Development', 
  ... 'Mature', 'Merged', 'Abandoned']
  >>> for status in status_values:
  ...   status in table
  ...
  True
  True
  True
  True
  False
  False

And to look at all branches, select 'Any Status'

  >>> browser.getControl(name='field.lifecycle').displayValue = ['Any Status']
  >>> browser.getControl('Filter').click()
  >>> soup = BeautifulSoup(browser.contents)
  >>> table = str(soup.find('table', { 'id':'branchtable' } ))
  >>> for status in status_values:
  ...   status in table
  ...
  True
  True
  True
  True
  True
  True

Selecting an individual lifecycle status from the select control 
will cause only branches with that status to be listed.

  >>> browser.getControl(name='field.lifecycle').displayValue = ['Abandoned']
  >>> browser.getControl('Filter').click()
  >>> soup = BeautifulSoup(browser.contents)
  >>> table = str(soup.find('table', { 'id':'branchtable' } ))
  >>> for status in status_values:
  ...   status in table
  ...
  False
  False
  False
  False
  False
  True


http://code.launchpad.dev/products/firefox/+branches?field.lifecycle=Mature


If the product does have branches, but they are not visible with
the current filter, the table is shown, and a (hopefully)
helpful message supplied.

  >>> browser.open('http://code.launchpad.dev/'
  ...   'products/firefox/+branches?field.lifecycle=Mature')
  >>> browser.getControl(name='field.lifecycle').displayValue
  ['Mature']
  >>> soup = BeautifulSoup(browser.contents)
  >>> print str(soup.find('table', { 'id':'branchtable' } ))
  <table...
  ...There are branches registered for firefox but none of them match the
  current filter criteria for this page. Try filtering on "Any Status"...
  ...</table>
