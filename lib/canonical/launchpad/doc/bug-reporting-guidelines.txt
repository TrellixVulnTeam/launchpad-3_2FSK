= Bug Reporting Guidelines =

Guidelines can be set at the Distribution, Project or Product level to
help users file good bug reports, direct them to FAQs, and so forth.

    >>> login('foo.bar@canonical.com')

    >>> from canonical.launchpad.interfaces import (
    ...     IDistributionSet, IProjectSet, IProductSet)

    >>> distribution = getUtility(IDistributionSet).getByName('ubuntu')
    >>> project = getUtility(IProjectSet).getByName('mozilla')
    >>> product = getUtility(IProductSet).getByName('firefox')

    >>> for context in [distribution, project, product]:
    ...     context.bug_reporting_guidelines = (
    ...         "Welcome to %s!" % context.displayname)

In fact, all IBugTargets have guidelines available, but the others
delegate to the distribution or product level.

DistroSeries and SourcePackages defer to the Distribution:

    >>> distro_series = distribution.getSeries('warty')
    >>> print distro_series.bug_reporting_guidelines
    Welcome to Ubuntu!

    >>> source_package = distro_series.getSourcePackage('alsa-utils')
    >>> print source_package.bug_reporting_guidelines
    Welcome to Ubuntu!

DistributionSourcePackages also defer to the Distribution, but
additional package-specific guidelines can be specified.

    >>> distribution_source_package = (
    ...     distribution.getSourcePackage('alsa-utils'))
    >>> print distribution_source_package.bug_reporting_guidelines
    Welcome to Ubuntu!

    >>> distribution_source_package.bug_reporting_guidelines = (
    ...     u"Welcome to ALSA!")
    >>> print distribution_source_package.bug_reporting_guidelines
    Welcome to ALSA!
    <BLANKLINE>
    Welcome to Ubuntu!

ProductSeries defer to the Product:

    >>> product_series = product.getSeries('trunk')
    >>> print product_series.bug_reporting_guidelines
    Welcome to Mozilla Firefox!

One day these objects that defer bug_reporting_guidelines may have
their own guidelines. In the meantime the deferral is done with a
read-only property, and the security proxies also only allow read
access.

    >>> distro_series.bug_reporting_guidelines = 'Foobar'
    Traceback (most recent call last):
    ...
    ForbiddenAttribute: ...

    >>> source_package.bug_reporting_guidelines = 'Foobar'
    Traceback (most recent call last):
    ...
    ForbiddenAttribute: ...

    >>> distribution_source_package.bug_reporting_guidelines = 'Foobar'
    Traceback (most recent call last):
    ...
    ForbiddenAttribute: ...

    >>> product_series.bug_reporting_guidelines = 'Foobar'
    Traceback (most recent call last):
    ...
    ForbiddenAttribute: ...

The security proxies also prevent unprivileged users from editing the
guidelines.

    >>> from canonical.launchpad.interfaces import IPerson

    >>> def check_access(user, context):
    ...     if IPerson.providedBy(user):
    ...         login_person(user)
    ...     else:
    ...         login(user)
    ...     context.bug_reporting_guidelines = (
    ...         "%s let %s have access." % (
    ...             context.displayname,
    ...             getUtility(ILaunchBag).user.displayname))
    ...     print context.bug_reporting_guidelines

    >>> check_access("no-priv@canonical.com", distribution)
    Traceback (most recent call last):
    ...
    Unauthorized: ...

    >>> check_access("no-priv@canonical.com", project)
    Traceback (most recent call last):
    ...
    Unauthorized: ...

    >>> check_access("no-priv@canonical.com", product)
    Traceback (most recent call last):
    ...
    Unauthorized: ...

Of course the owner can edit the guidelines.

    >>> check_access(distribution.owner, distribution)
    Ubuntu let Ubuntu Team have access.

    >>> check_access(project.owner, project)
    the Mozilla Project let Sample Person have access.

    >>> check_access(product.owner, product)
    Mozilla Firefox let Sample Person have access.
