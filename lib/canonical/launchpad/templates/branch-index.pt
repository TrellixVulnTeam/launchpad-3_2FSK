<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="context/@@main_template/master"
      i18n:domain="launchpad"
>
  <body>
    <metal:heading fill-slot="pageheading">
      <h1>
        &ldquo;<tal:branch replace="context/displayname">Name</tal:branch>&rdquo;
        branch
      </h1>
    </metal:heading>

<metal:leftportlets fill-slot="portlets_one">
  <div tal:replace="structure context/@@+portlet-details" />
  <div tal:replace="structure context/@@+portlet-subscribers" />
</metal:leftportlets>

<div metal:fill-slot="main">

  <p tal:repeat="notice view/notices" tal:content="notice"
     class="informational message">
    notice goes here
  </p>

  <p class="highlighted" tal:condition="context/summary"
     tal:content="context/summary">
    $Branch.summary goes here. This should be quite short, just a single
    paragraph of text really, giving the branch highlights.
  </p>

  <p class="highlighted" tal:condition="not:context/summary">
    <i>This branch has no summary.</i>
  </p>

  <tal:pull-branch condition="context/url">
    <div>
      <b>Location:</b>
      <span class="lesser" tal:content="context/url">
        http://example.com/bzr/foo/foo.dev
      </span>
    </div>
    <div>
      <b>Mirror:</b>
      <span class="lesser" tal:content="view/supermirror_url">
        http://bazaar.launchpad.net/~user/product/branch
      </span>
    </div>
    <p class="discreet lesser">
      These URLs are intended for use with the
      <a href="http://www.bazaar-vcs.org/">Bazaar</a> version control system.
    </p>
  </tal:pull-branch>

  <tal:hosted-branch condition="not:context/url">
    <div>
      <b>Hosted on Launchpad:</b>
      <span class="lesser" tal:content="view/supermirror_url" class="lesser">
        http://bazaar.launchpad.net/~user/product/branch
      </span>
    </div>
    <p class="discreet lesser">
      This URL is intended for use with the
      <a href="http://www.bazaar-vcs.org/">Bazaar</a> version control system.
    </p>    
  </tal:hosted-branch>

  <tal:comment condition="nothing">
    <!-- XXX This style attribute is evil, but bold text makes the mirror error
    difficult to read. Checked with mpt about that. - David Allouche 2006-04-09
    -->
  </tal:comment>
  <p tal:condition="context/mirror_failures"
       class="warning message" style="font-weight: normal">
    Launchpad could not mirror this branch at
    <span tal:replace="context/last_mirror_attempt/fmt:datetime" />.
    <span tal:condition="context/mirror_status_message">
      The error was:
      <span tal:replace="context/mirror_status_message">Error 1</span>
    </span>
    <span tal:condition="not:context/mirror_status_message">
      No error message was recorded.
    </span>
  </p>

  <p class="highlighted lesser" tal:condition="context/whiteboard">
    <b>Whiteboard:</b>
    <span tal:replace="context/whiteboard">whiteboard</span>
  </p>

  <h2>Recent revisions</h2>

  <p tal:condition="not:context/revision_count">
    This branch has not been scanned for revisions yet, or no revisions were
    found on the last scan. Branches are scanned at least once a day.
  </p>

  <tal:history-available condition="context/revision_count">
  <table class="listing">
    <thead>
      <tr>
        <th colspan="2">Revision</th>
        <th tal:condition="view/user">Author</th>
        <th>Message</th>
      </tr>
    </thead>
    <tbody>
      <tr tal:repeat="rev_no context/latest_revisions">
        <td tal:content="rev_no/sequence">1</td>
        <td tal:content="rev_no/revision/revision_date/fmt:date">2005-10-05</td>
        <td tal:condition="view/user"
            tal:content="rev_no/revision/revision_author/name"
            >John Doe &lt;jdoe@example.com&gt;</td>
        <td tal:content="rev_no/revision/log_body">The revision commit message.</td>
      </tr>
    </tbody>
  </table>
  </tal:history-available>

  <tal:related-bugs condition="context/related_bugs">
    <h2>Related Bugs</h2>
    <ul style="list-style: none">
      <span tal:repeat="bug context/related_bugs"
            tal:omit-tag="">
        <li tal:condition="bug/required:launchpad.View">
          <a href="#"
             tal:content="string:${bug/id}. ${bug/title}"
             tal:attributes="href bug/fmt:url">Foo is Broken</a>
        </li>
      </span>
    </ul>
  </tal:related-bugs>

  <h2>Nearby</h2>
  <ul style="list-style: none">
    <li tal:condition="context/product">
      <a tal:attributes="href string:${context/product/fmt:url}/+branches">
	Other <tal:product replace="context/product/displayname" /> branches
      </a>
    </li>
    <li>
      <tal:author condition="context/author">
	<a tal:attributes="href string:${context/author/fmt:url}/+authoredbranches">
	  Other branches authored by <tal:person
	  replace="context/author/displayname">Author</tal:person>
	</a>
      </tal:author>
      <tal:no-author condition="not:context/author">
	<a tal:attributes="href string:${context/owner/fmt:url}/+registeredbranches">
	  Other branches registered (and not authored) by <tal:person
	  replace="context/owner/displayname">Owner</tal:person>
	</a>
      </tal:no-author>
    </li>
  </ul>
</div>
</body>
</html>
