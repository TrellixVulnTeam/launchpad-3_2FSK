= Deleting bug attachments =

If some attachment gets added which isn't relevant to the bug, it can be
deleted again from the bug attachment edit page.

    >>> from cStringIO import StringIO
    >>> user_browser.open('http://launchpad.dev/bugs/2')
    >>> user_browser.getLink('Comment/Attach File').click()
    >>> foo_file = StringIO('V1agra.')
    >>> user_browser.getControl('Include attachment').selected = True
    >>> user_browser.getControl('File').add_file(
    ...   foo_file, 'text/plain', 'foo.txt')
    >>> user_browser.getControl('Description').value = 'Great deal'
    >>> user_browser.getControl('Save Changes').click()

The attachment is now visible on the bug page.

    >>> user_browser.open('http://launchpad.dev/bugs/2')
    >>> attachment_portlet = find_portlet(
    ...     user_browser.contents, 'Bug attachments')
    >>> for li in attachment_portlet.findAll('li', 'download'):
    ...     print li.a.renderContents()
    Great deal

If we go to the attachment edit page, there's an option to delete the
attachment.

    >>> import re
    >>> user_browser.getLink(url=re.compile(r'attachments/\d')).click()
    >>> user_browser.title
    'Bug #2 - Edit attachment \xe2\x80\x9cGreat deal\xe2\x80\x9d'
    >>> user_browser.getControl('Delete attachment') is not None
    True

If the button is pressed, the attachment will be deleted, which means
that it won't show up in the attachments portlet anymore. Since there
arent' any other attachments, the portlet won't show up at all.

    >>> user_browser.getControl('Delete attachment').click()
    >>> user_browser.url
    'http://.../+bug/2'
    >>> for message in find_tags_by_class(user_browser.contents, 'message'):
    ...     print message.renderContents()
    Attachment "<a href="...">Great deal</a>" has been deleted.

    >>> print find_portlet(user_browser.contents, 'Bug attachments')
    None
