<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="context/@@main_template/master"
      i18n:domain="launchpad">

<head>
  <title metal:fill-slot="title">
    <span tal:content="context/release/distribution/title">Distro
    Title</span>
    <span tal:content="context/release/title">DistroRelease Title</span>:
    Source Packages
  </title>
  <!-- Plone style sheet -->
  <style type="text/css" media="screen">@import url(plone.css);</style>
</head>

<body>

<metal:leftportlets fill-slot="portlets_one">

<tal:block tal:define="distro context/release/distribution">

 <div class="portlet">
  <h4><span tal:content="distro/title">DISTRO</span> Links</h4>

   <div class="portletBody">

     <div class="portletContent even">

     <ul>
     <li><a tal:attributes="href string:/distros/${distro/name}">
     Home Page</a></li>
     <li><a tal:attributes="href string:/distros/${distro/name}/releases">
      Releases</a></li>
     <li><a tal:attributes="href string:/distros/${distro/name}/src">
      Source Packages</a></li>
     <li><a tal:attributes="href string:/distros/${distro/name}/bin">
     Binary Packages</a></li>
     </ul>

     </div>
   </div>  
 </div>

 <div class="portlet">
  <h4>Local Links</h4>
   <div class="portletBody">
     <div class="portletContent even">
     <ul>
     <li> Release: <a tal:attributes="href string:/distros/${distro/name}/releases/${context/release/name}" 
            tal:content="context/release/title">RELEASE</a></li>
     </ul>
     </div>
   </div>  
 </div>

</tal:block>



</metal:leftportlets>


<div metal:fill-slot="main">

    <h1 style="margin-bottom: 1em;"><span tal:content="context/release/distribution/title" />
    <span tal:content="context/release/title" />: Source Packages</h1>

    <div align="center" tal:define="sourcecount context/release/sourcecount">

      <form name="search" method="get" action="">
       <div class="formControls">
        <label>Package name:</label>
        <input tal:attributes="value request/name|nothing" 
               title="Enter the package name" size="50"
               type="text" name="name"/>
        <input type="submit" value="Search"/>
       </div>
      </form>

      <a tal:attributes="href string:../../src/${context/release/name}?showall=1">
        View All  
        (<span tal:content="sourcecount"/> Packages)
      </a>

    </div>

<!-- XXX: Need section stuff in db. They are in soyuz.dia but  -->
<!-- the db implementatio is missing -->

  <tal:block tal:define="bn view/sourcePackagesBatchNavigator">

    <p tal:condition="python: bn is None and request.get('name', None)">
        No packages containing '<span tal:replace="request/name" />' were found.
    </p>

    <div tal:condition="bn">
      <tal:block tal:define="prev_url bn/prevBatchURL; next_url bn/nextBatchURL;">

        <ul>
          <li tal:repeat="package python:list(bn.currentBatch())">
            <a tal:content="string: ${package/name} : ${package/shortdesc}"
                 tal:attributes="href package/name">PACKAGE</a></li>
        </ul>
        <fieldset tal:condition="python:prev_url or next_url">
          <div>
              <table>
              <tr>
                <th tal:condition="prev_url">
                  <a tal:attributes="href prev_url"><b>&lt;&lt; Prev</b></a>
                </th>
                <th tal:repeat="page_link bn/batchPageURLs">
                 <a tal:attributes="href python:page_link.values()[0]"
                        tal:content="python:page_link.keys()[0]"></a>
                </th>
                <th tal:condition="next_url" >
                 <a tal:attributes="href next_url"><b>Next &gt;&gt;></b></a>
                </th>
                </tr>
            </table>
          </div>
        </fieldset>

      </tal:block>
    </div>
  </tal:block>


  </div>

</body>

</html>
