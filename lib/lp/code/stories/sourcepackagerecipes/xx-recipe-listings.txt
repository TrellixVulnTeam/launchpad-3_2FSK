====================
Recipe Listing Pages
====================

Pages that want to display lists of recipes use the recipe-listing
page template, and views derived from RecipeListingView.


    >>> def print_recipe_listing_head(browser):
    ...     table = find_tag_by_id(browser.contents, 'recipetable')
    ...     for row in table.thead.fetch('tr'):
    ...         print extract_text(row)

    >>> def print_recipe_listing_contents(browser):
    ...     table = find_tag_by_id(browser.contents, 'recipetable')
    ...     for row in table.tbody.fetch('tr'):
    ...         print extract_text(row)


Branch Recipe Listings
======================

Create a sample branch.
    >>> login('foo.bar@canonical.com')
    >>> recipeless_branch = factory.makeBranch()
    >>> recipeless_branch_url = canonical_url(recipeless_branch)
    >>> logout()
    >>> nopriv_browser = setupBrowser(
    ...     auth='Basic nopriv@canonical.com:test')

The link to the source package recipe listings should not be shown.

    >>> nopriv_browser.open(recipeless_branch_url)
    >>> nopriv_browser.getLink('View source package recipes')
    Traceback (most recent call last):
    ...
    LinkNotFoundError

Create a new sample branch, but this time create some source package branches
to go along with them.

    >>> login('foo.bar@canonical.com')
    >>> branch = factory.makeBranch()
    >>> branch_url = canonical_url(branch)
    >>> recipe1 = factory.makeSourcePackageRecipe(
    ...     None, None, None, None, None, None, branch)
    >>> recipe2 = factory.makeSourcePackageRecipe(
    ...     None, None, None, None, None, None, branch)
    >>> recipe3 = factory.makeSourcePackageRecipe(
    ...     None, None, None, None, None, None, branch)
    >>> logout()

The link to source package recipes should now be shown.  Let's click through.

    >>> nopriv_browser.open(branch_url)
    >>> nopriv_browser.getLink('View source package recipes').click()
    >>> print nopriv_browser.url
    http://code.launchpad.dev/~person-name.../product-name.../branch.../+recipes

The "Base branch" column should not be shown.

    >>> print_recipe_listing_head(nopriv_browser)
    Name
    Project
    Owner
    Registered

The branch page should have a list of all the recipes the branch is a
base_branch for.

    >>> print_recipe_listing_contents(nopriv_browser)
    generic-string... Product-name... Person-name...
    generic-string... Product-name... Person-name...
    generic-string... Product-name... Person-name...
