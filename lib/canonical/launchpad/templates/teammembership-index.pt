<tal:do-this-first tal:content="view/processForm" />
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="context/@@main_template/master"
      i18n:domain="launchpad">

<body>

<metal:macros fill-slot="bogus">
  <metal:macro define-macro="person">
      <a tal:attributes="href context/person/fmt:url"
        tal:content="string: ${context/person/browsername}
                             (${context/person/name})"></a>
  </metal:macro>
  <metal:macro define-macro="error">
    <tr><td colspan="2">
      &nbsp;
      <p class="portalError" tal:condition="view/errormessage"
         tal:content="view/errormessage" />
    </td></tr>
  </metal:macro>
  <metal:macro define-macro="comment">
    <tr>
      <th>Comment:</th>
      <td><textarea cols="40" name="comment" 
                    tal:content="request/comment|context/reviewercomment|nothing">
          </textarea></td>
    </tr>
  </metal:macro>
  <metal:macro define-macro="expiry-radios">
    <label for="never">
      <input tal:attributes="checked python: view.neverExpiresIsSelected()
                                             and 'checked' or ''"
             type="radio" id="never" value="never" name="expires" />
        Never<br />
    </label>
    <label for="date">
      <input tal:attributes="checked python: view.expiresIsSelected()
                                             and 'checked' or ''"
      type="radio" id="date" value="date" name="expires" />
      On
    </label>
  </metal:macro>
</metal:macros>

<div metal:fill-slot="main">

      <div tal:condition="view/isActive"> 

        <h1>Active Member</h1>

        <p>
          <metal:person use-macro="template/macros/person" />
          is an <em>Active Member</em> of 
          <span tal:replace="context/team/browsername" />.
        </p>

        <form action="" method="POST" name="editactive">
          <table>
          <tr>
            <th>Member since:</th>
            <td tal:content="context/datejoined/fmt:date" />
          </tr>

          <tr>
            <th>Administrator:</th>
            <td>
              <tal:can-change condition="view/allowChangeAdmin">
                <label for="admin">
                  <input tal:attributes="checked python:view.adminIsSelected()
                                                 and 'checked' or ''"
                         type="radio" value="yes" name="admin" id="admin" />
                  Yes
                </label>
                <label for="notadmin">
                  <input tal:attributes="checked python:not view.adminIsSelected()
                                                 and 'checked' or ''"
                         type="radio" value="no" name="admin" id="notadmin" />
                  No
                </label>
              </tal:can-change>
              <tal:cant-change condition="not: view/allowChangeAdmin">
                <span tal:condition="view/isAdmin">Yes</span>
                <span tal:condition="not: view/isAdmin">No</span>
              </tal:cant-change>
            </td>
          </tr>

          <metal:error use-macro="template/macros/error" />

          <tr>
            <th>Subscription expires:</th>
            <td tal:condition="view/canChangeExpirationDate">
              <metal:radios use-macro="template/macros/expiry-radios" />
              <span tal:replace="structure view/dateChooserWithCurrentExpirationSelected" />
            </td>
            <td tal:condition="not: view/canChangeExpirationDate">
              <span tal:condition="context/dateexpires"
                    tal:replace="context/dateexpires/fmt:date" />
              <span tal:condition="not: context/dateexpires">Never</span>
            </td>
          </tr>

          <metal:comment use-macro="template/macros/comment" />

          <tr>
            <th />
            <td>
              <input type="submit" value="Change" name="editactive" />
              <input type="submit" value="Deactivate" name="editactive" />
            </td>
          </tr>
        </table>
        </form>
      </div>

      <div tal:condition="view/isInactive"> 

        <h1>Inactive Member</h1>
        <p tal:condition="view/isExpired">
          <metal:person use-macro="template/macros/person" />
          is an <em>Expired Member</em> of
          <span tal:replace="context/team/browsername" />.
        </p>

        <p tal:condition="view/isDeactivated">
          <metal:person use-macro="template/macros/person" />
          is a <em>Deactivated Member</em> of
          <span tal:replace="context/team/browsername" />.
        </p>

        <form action="" method="POST" name="editinactive">
          <table>
          <tr>
            <th>Became member in:</th>
            <td tal:content="context/datejoined/fmt:date" />
          </tr>

          <tal:expired condition="view/isExpired">
            <tr>
              <th>Subscription expired in:</th>
              <td tal:content="context/dateexpires/fmt:date"></td>
            </tr>

            <metal:error use-macro="template/macros/error" />

            <tr>
              <th>Expiration:</th>
              <td>
                <label for="leave">
                  <input checked="checked"
                         type="radio" id="leave" value="leave" name="expires" />
                    Don't change<br />
                </label>
                <metal:radios use-macro="template/macros/expiry-radios" />
                <span tal:replace="structure view/dateChooserForExpiredMembers" />
              </td>
            </tr>
          </tal:expired>

          <tal:not-expired condition="not: view/isExpired">
            <metal:error use-macro="template/macros/error" />
            <tr><td colspan="2">&nbsp;</td></tr>
            <tr>
              <th>Subscription expires:</th>
              <td>
                <metal:radios use-macro="template/macros/expiry-radios" />
                <span tal:replace="structure view/dateChooserWithCurrentExpirationSelected" />
              </td>
            </tr>
          </tal:not-expired>

          <metal:comment use-macro="template/macros/comment" />

          <tr>
            <td colspan="2" align="right">
              <input tal:condition="view/isExpired" type="submit" value="Renew"
                     name="editinactive" />
              <input tal:condition="view/isDeactivated" type="submit"
                     value="Reactivate" name="editinactive" />
            </td>
          </tr>
        </table>

        </form>
      </div>

      <div tal:condition="view/isProposed"> 

        <h1>Proposed Member</h1>
        <p>
          <metal:person use-macro="template/macros/person" />
          wants to join this team.
          If this is okay, select a membership expiration date if necessary
          before choosing <samp>Approve</samp>.
        </p>
        <p class="portalMessage" tal:condition="view/errormessage"
           tal:content="view/errormessage" />

        <form action="" method="POST" name="editproposed">
          <table>
            <tr>
              <th>Membership applied for:</th>
              <td tal:content="context/datejoined/fmt:date" />
            </tr>

            <metal:error use-macro="template/macros/error" />

            <tr>
              <th>Subscription expires:</th>
              <td>
                <metal:radios use-macro="template/macros/expiry-radios" />
                <span tal:replace="structure view/dateChooserForProposedMembers" />
              </td>
            </tr>

            <metal:comment use-macro="template/macros/comment" />

            <tr>
              <th />
              <td>
                <input type="submit" value="Approve" name="editproposed" />
                <input type="submit" value="Decline" name="editproposed" />
              </td>
            </tr>
          </table>

        </form>

      </div>

      <div tal:condition="view/isDeclined"> 

        <h1>Declined Member</h1>
        <p>
          <metal:person use-macro="template/macros/person" />
          asked to join this team, but the request was declined.
        </p>

      </div>

</div>

</body>
</html>
