
This is needed to make utilities work, it seems.

  >>> from canonical.launchpad.ftests import login
  >>> login("launchpad.anonymous")

Get a tarball representation of a template's translations.

  >>> from canonical.launchpad.components.poexport import POTemplateExporter
  >>> from canonical.launchpad.database import POTemplate

  >>> template = POTemplate.get(1)
  >>> exporter = POTemplateExporter(template)
  >>> tarfile_string = exporter.export_tarball()

Check it has the right members.

  >>> from canonical.launchpad.helpers import string_to_tarfile
  >>> tarfile = string_to_tarfile(tarfile_string)
  >>> tarfile.getnames()
  ['rosetta-evolution-2.2/', 'rosetta-evolution-2.2/es.po']

Check the PO file looks like what we expected.

  >>> fh = tarfile.extractfile('rosetta-evolution-2.2/es.po')
  >>> fh.readline()
  '# traducci\xc3\xb3n de es.po al Spanish\n'

Check GNU tar can cope with it.

  >>> from canonical.launchpad.helpers import simple_popen2
  >>> print simple_popen2('tar ztf -', tarfile_string)
  rosetta-evolution-2.2/
  rosetta-evolution-2.2/es.po
  <BLANKLINE>
  >>> pofile = simple_popen2('tar zxfO - rosetta-evolution-2.2/es.po',
  ...     tarfile_string)
  >>> pofile.split('\n')[0]
  '# traducci\xc3\xb3n de es.po al Spanish'

