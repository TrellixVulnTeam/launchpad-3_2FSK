

POTemplate index page
=====================


DistoSeries
-----------

The index page for a POTemplate lists all available translations
for a source package. No Privileges Person visits the 
evolution-2.2 POTemplate page.

    >>> anon_browser.open("http://translations.launchpad.dev/"
    ...     "ubuntu/hoary/+source/evolution/+pots/evolution-2.2/")
    >>> print anon_browser.title
    Template ...evolution-2.2... :
    ...evolution... package : Translations : Hoary (5.04) : Ubuntu

The owner of the template is diplayed.

    >>> owner_display = find_tag_by_id(anon_browser.contents,
    ...                                'potemplate-owner')
    >>> print extract_text(owner_display)
    Owner: Rosetta Administrators

The page lists the status of all the translations. It merges the
No Privileges Person's languages (which are South African) with
the translated languages. English, which is a South African language
is not included because it is not translatable. For each language, we
show the number of messages that are untranslated, the percentage
that represents, when the translation was updated, and by whom.

    >>> content = find_main_content(anon_browser.contents)
    >>> print extract_text(content.findAll('h1')[0])
    Translation status

    >>> table = content.findAll('table')[0]
    >>> for row in table.findAll('tr'):
    ...     print extract_text(row).encode('us-ascii', 'backslashreplace')
    Language        Status  Untranslated Need review Changed Last    Edited By
    Afrikaans               22           ...         ...     &mdash; &mdash;
    Japanese                21           ...         ...     ...     Carlos...
    Sotho, Southern         22           ...         ...     &mdash; &mdash;
    Spanish                 15           1           1       ...     Valentina Commissari
    Xhosa                   22           ...         ...     ...     &mdash;
    Zulu                    22           ...         ...     &mdash; &mdash;

When products have more than one template, the page informs the user
that there are alternates that may be translated.

    >>> anon_browser.open("http://translations.launchpad.dev/"
    ...     "evolution/trunk/+pots/evolution-2.2-test")
    >>> alternate_notice = find_tag_by_id(anon_browser.contents,
    ...                                   'potemplate-relatives')
    >>> print extract_text(alternate_notice)
    Other templates here: evolution-2.2

The notice links to the alternate template.

    >>> print alternate_notice
    <p...>
    <span>Other templates here:</span>
    <a href="/evolution/trunk/+pots/evolution-2.2">evolution-2.2</a>...
    </p>

English is not translatable. We do not display English in the list of
languages when the user speaks English or even when English
translations exist. The Mozilla sourcepackage pkgconf-mozilla has
English translations, but they are not displayed to the user.

    >>> anon_browser.open('http://translations.launchpad.dev/ubuntu/hoary/'
    ...     '+source/mozilla/+pots/pkgconf-mozilla')
    >>> table = find_tag_by_id(anon_browser.contents, 'language-chart')
    >>> for row in table.findAll('tr')[0:6]:
    ...     print extract_text(row).encode('us-ascii', 'backslashreplace')
    Language    Status  Untranslated Need review Changed Last  Edited By
    Afrikaans             9            ...         ...   ...   &mdash;
    Czech                 ...          ...         ...   ...   Miroslav Kure
    Danish                ...          ...         ...   ...   Morten Brix...
    Dutch                 ...          ...         ...   ...   Luk Claes
    Finnish               ...          ...         ...   ...   P\xf6ll\xe4


DistroSeries and ProductSeries interlinks 
-----------------------------------------

We are presented not only with links to alternate templates from the same
source, but also with links to the same template in (other) distroseries.

    >>> anon_browser.open('http://translations.launchpad.dev/evolution/trunk/+pots/evolution-2.2')
    >>> alternate_notice = find_tag_by_id(anon_browser.contents,
    ...                                   'potemplate-rel-by-name')
    >>> print extract_text(alternate_notice)
    Templates with the same name elsewhere: Ubuntu Hoary
    >>> print alternate_notice
    <p...<a href="/ubuntu/hoary/+source/evolution/+pots/evolution-2.2"...

The template in the other distroseries links back to this one.

    >>> anon_browser.open('http://translations.launchpad.dev/ubuntu/hoary/+source/evolution/+pots/evolution-2.2')
    >>> alternate_notice = find_tag_by_id(anon_browser.contents,
    ...                                   'potemplate-rel-by-name')
    >>> print extract_text(alternate_notice)
    Templates with the same name elsewhere: Evolution trunk
    >>> print alternate_notice
    <p...<a href="/evolution/trunk/+pots/evolution-2.2"...


Administration section
----------------------

Accessing the POTemplate index as anonymous user, the Administration
section should not be displayed, and there should be no Download or
Upload links

    >>> anon_browser.open('http://translations.launchpad.dev/ubuntu/hoary/+source/evolution/+pots/evolution-2.2')
    >>> anon_browser.getLink('upload')
    Traceback (most recent call last):
    ...
    LinkNotFoundError

    >>> anon_browser.getLink('download').click()
    Traceback (most recent call last):
    ...
    LinkNotFoundError

Authenticated users should see the Download link, but not the Upload one

    >>> user_browser.open('http://translations.launchpad.dev/ubuntu/hoary/+source/evolution/+pots/evolution-2.2')
    >>> user_browser.getLink('upload')
    Traceback (most recent call last):
    ...
    LinkNotFoundError

    >>> user_browser.getLink('download').click()
    >>> print user_browser.url
    http://translations.launchpad.dev/ubuntu/hoary/+source/evolution/+pots/evolution-2.2/+export

Translation admins will see both Download and Upload links. 
Beside Administer this template, Change permissions and Change details
should be also displayed

    >>> admin_browser.open('http://translations.launchpad.dev/ubuntu/hoary/+source/evolution/+pots/evolution-2.2')
    >>> admin_browser.getLink('upload').click()
    >>> print admin_browser.url
    http://translations.launchpad.dev/ubuntu/hoary/+source/evolution/+pots/evolution-2.2/+upload

    >>> admin_browser.open('http://translations.launchpad.dev/ubuntu/hoary/+source/evolution/+pots/evolution-2.2')
    >>> admin_browser.getLink('download').click()
    >>> print admin_browser.url
    http://translations.launchpad.dev/ubuntu/hoary/+source/evolution/+pots/evolution-2.2/+export

    >>> admin_browser.open('http://translations.launchpad.dev/ubuntu/hoary/+source/evolution/+pots/evolution-2.2')
    >>> admin_browser.getLink('Administer this template').click()
    >>> print admin_browser.url
    http://translations.launchpad.dev/ubuntu/hoary/+source/evolution/+pots/evolution-2.2/+admin

    >>> admin_browser.open('http://translations.launchpad.dev/ubuntu/hoary/+source/evolution/+pots/evolution-2.2')
    >>> admin_browser.getLink('Change details').click()
    >>> print admin_browser.url
    http://translations.launchpad.dev/ubuntu/hoary/+source/evolution/+pots/evolution-2.2/+edit

    >>> admin_browser.open('http://translations.launchpad.dev/ubuntu/hoary/+source/evolution/+pots/evolution-2.2')
    >>> admin_browser.getLink('Change permissions').click()
    >>> print admin_browser.url
    http://translations.launchpad.dev/ubuntu/+settings

