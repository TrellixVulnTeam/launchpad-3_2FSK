<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  xml:lang="en"
  lang="en"
  dir="ltr"
  metal:use-macro="context/@@main_template/master"
  i18n:domain="launchpad"
>

<body>

<style type="text/css" metal:fill-slot="head_epilogue">
  #code-review-votes {
    margin: 2em 0;
  }
</style>

<div metal:fill-slot="main">

  <tal:summary replace="structure context/@@+pagelet-summary" />

  <h1>Proposal to merge branch</h1>

  <tal:superseded-proposal condition="context/supersedes">
    <p id="superseded-proposal">
      This proposal supersedes a
      <a tal:attributes="href context/supersedes/fmt:url">
        proposal from
        <tal:when replace="context/supersedes/date_created/fmt:date" /></a>.
    </p>
  </tal:superseded-proposal>
  <tal:superseded-by condition="context/superseded_by">
    <p id="superseded-by">
      This proposal has been superseded by a
      <a tal:attributes="href context/superseded_by/fmt:url">
        proposal from
        <tal:when replace="context/superseded_by/date_created/fmt:date" /></a>.
    </p>
  </tal:superseded-by>

  <tal:whiteboard condition="context/whiteboard">
    <h2>Whiteboard</h2>
    <div id="branch-whiteboard-value" class="whiteboard"
      tal:content="structure context/whiteboard/fmt:text-to-html">
      Whiteboard text goes here.
    </div>
  </tal:whiteboard>

  <tal:votes replace="structure context/@@+votes-with-links"/>

  <div tal:define="link context/menu:context/request_review"
       tal:condition="link/enabled"
       tal:content="structure link/render">
       Request review
  </div>

  <tal:comments repeat="row view/comments" >
    <div tal:content="structure row/comment/@@+fragment-summary"
         tal:attributes="style row/style" />
  </tal:comments>

  <div tal:define="link context/menu:context/add_comment"
       tal:condition="link/enabled"
       tal:content="structure link/render">
       Add comment
  </div>

  <div id="source-revisions"
       tal:condition="not: context/queue_status/enumvalue:MERGED">
  <h2>Unmerged revisions</h2>

    <tal:history-available condition="context/source_branch/revision_count"
                           define="branch context/source_branch;
                                   revisions view/unlanded_revisions">
      <metal:landing-target use-macro="branch/@@+macros/branch-revisions"/>
    </tal:history-available>

    <tal:remote-branch condition="context/source_branch/branch_type/enumvalue:REMOTE">
      <p>Recent revisions are not available due to the source branch being remote.</p>
    </tal:remote-branch>
  </div>
</div>

</body>
</html>
