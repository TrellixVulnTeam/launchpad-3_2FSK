Rejecting and Reopening
=======================

An open support request should contain a link to allow its rejection.

    >>> from zope.testbrowser.testing import Browser

    >>> user_browser.open(
    ...     'http://launchpad.dev/products/firefox/+ticket/2')
    >>> user_browser.url
    'http://launchpad.dev/products/firefox/+ticket/2'
    >>> user_browser.getLink('Reject Request').click()
    >>> user_browser.url
    'http://launchpad.dev/products/firefox/+ticket/2/+reject'
    >>> 'Reject support request' in user_browser.contents
    True

When we POST that back to the ticket page we should see a status of
Rejected, and a message saying that it has been rejected.

    >>> user_browser.getControl('Reject').click()
    >>> user_browser.url
    'http://launchpad.dev/products/firefox/+ticket/2'
    >>> 'Rejected' in user_browser.contents
    True

If you are the person who made the support request, you should be able to
reopen it.

    >>> creator = Browser()
    >>> creator.addHeader('Authorization', 'Basic test@canonical.com:test')
    >>> creator.open('http://launchpad.dev/products/firefox/+ticket/2'
    >>> creator.getLink('Reopen Request').click()
    >>> creator.url
    'http://launchpad.dev/products/firefox/+ticket/2/+reopen'
    
POSTIng that form should make the status Open, with a message saying that the
support request was reopened. In addition, we should see the reopenings
portlet, listing a single instance of reopening by Foo Bar. And finally, we
should see the "Show History" action item.

    >>> creator.getControl('Reopen').click()
    >>> creator.url
    'http://launchpad.dev/products/firefox/+ticket/2'
    >>> 'You have reopened this request' in creator.contents
    True
    >>> 'Open' in creator.contents
    True
    >>> 'This request was reopened:' in creator.contents

The +history page should be visible for this ticket.

  >>> print http(r"""
  ... GET /products/firefox/+ticket/2/+history HTTP/1.1
  ... """)
  HTTP/1.1 200 Ok
  ...
          <td>...</td>
          <td>Sample Person</td>
          <td>Rejected</td>
          <td>Sample Person</td>
          <td>...
  ...
