= The BranchDetailsStorage application =

The branch details storage application is an XMLRPC service that
manipulates branch data related to pulling branches.  It is available
as the branchdetails attribute of our private XMLRPC instance.

    >>> from canonical.launchpad.interfaces import (
    ...     IPrivateApplication)
    >>> from canonical.launchpad.interfaces.codehosting import (
    ...     IBranchDetailsStorageApplication)
    >>> from canonical.launchpad.webapp.testing import verifyObject

    >>> private_root = getUtility(IPrivateApplication)
    >>> verifyObject(
    ...     IBranchDetailsStorageApplication,
    ...     private_root.branchdetails)
    True

The BranchDetailsStorageAPI view provides the IBranchDetailsStorage
XML-RPC API:

    >>> from zope.publisher.xmlrpc import TestRequest
    >>> from canonical.launchpad.interfaces.codehosting import IBranchDetailsStorage
    >>> from canonical.launchpad.xmlrpc.codehosting import (
    ...     BranchDetailsStorageAPI)

    >>> branchdetails_api = BranchDetailsStorageAPI(
    ...     private_root.branchdetails, TestRequest())
    >>> verifyObject(IBranchDetailsStorage, branchdetails_api)
    True

The IBranchDetailsStorage interface defines some methods, for which
see the unit tests.  To allow a minimal test here, we call
getBranchPullQueue, which will return an empty list.

    >>> from canonical.launchpad.interfaces.branch import BranchType
    >>> branchdetails_api.getBranchPullQueue(BranchType.HOSTED.name)
    []

This remains true what it is accessed over XMLRPC.

    >>> import xmlrpclib
    >>> from canonical.functional import XMLRPCTestTransport
    >>> branchdetails = xmlrpclib.ServerProxy(
    ...     'http://xmlrpc-private.launchpad.dev:8087/branchdetails',
    ...     transport=XMLRPCTestTransport())
    >>> branchdetails.getBranchPullQueue(BranchType.HOSTED.name)
    []
