Helper Functions and Classes
============================

There are some helper functions and classes located in
canonical.launchpad.helpers which can be used in order to avoid
duplicating code in different parts of Launchpad.

Getting a valid name as our database asks for from a string
-----------------------------------------------------------

    >>> from zope.component import getUtility
    >>> from zope.interface import implements
    >>> from canonical.launchpad.interfaces import IPersonSet, IHasOwner
    >>> from canonical.launchpad.ftests import login
    >>> from canonical.launchpad.helpers import getValidNameFromString

The string has capital letters.

    >>> original_string = 'EvilStringNotFollowingOurRules'
    >>> getValidNameFromString(original_string)
    'evilstringnotfollowingourrules'

The string has underscores.

    >>> original_string = 'evil_string_not_following_our_rules'
    >>> getValidNameFromString(original_string)
    'evil-string-not-following-our-rules'

The string has white spaces.

    >>> original_string = 'evil string not following our rules'
    >>> getValidNameFromString(original_string)
    'evil-string-not-following-our-rules'

A mix of all previous cases.

    >>> original_string = 'Evil String Not_Following_our rUles'
    >>> getValidNameFromString(original_string)
    'evil-string-not-following-our-rules'


check_permission
----------------

    >>> from canonical.launchpad.helpers import check_permission

This is the same check available in TALES as something/required:permission.Name.
It checks that the currently logged in user has the requested permission on an
object:

    >>> personset = getUtility(IPersonSet)
    >>> sample_person = personset.get(12)

    >>> login('test@canonical.com')
    >>> check_permission('launchpad.Edit', sample_person)
    True
    >>> sabdfl = personset.getByEmail('mark@hbd.com')
    >>> check_permission('launchpad.Edit', sabdfl)
    False

If the permission doesn't exist, it raises an error:

    >>> check_permission('mushroom.Badger', sample_person)
    Traceback (most recent call last):
    ...
    ValueError: ('Undefined permission id', 'mushroom.Badger')


