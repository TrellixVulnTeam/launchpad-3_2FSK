<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="context/@@main_template/master"
      i18n:domain="launchpad">

<body>

<metal:leftportlets fill-slot="portlets_one">
  <div tal:content="structure context/@@+portlet-details" />
  <div tal:content="structure context/distribution/@@+portlet-details|nothing" />
</metal:leftportlets>

<metal:rightportlets fill-slot="portlets_two">
    <tal:block content="structure context/@@+portlet-bugtasklist-mybugs" />
    <tal:releasebugs
        tal:condition="context/@@+portlet-bugtasklist-releasebugs|nothing"
        tal:content="structure context/@@+portlet-bugtasklist-releasebugs" />
</metal:rightportlets>

<div metal:fill-slot="main">

<metal:page
    define-macro="page"
    tal:define="listing_columns view/task_columns;
                task_batch_navigator view/search">

  <tal:tag condition="view/assign_to_milestones|nothing"/>

  <metal:heading define-slot="heading" tal:replace="nothing" />

  <form name="bugtask_search" action="" method="GET">
  <tal:show-search-widgets condition="view/shouldShowSearchWidgets">
    <table>
      <tr>
        <th>
          <label tal:content="view/searchtext_widget/label">
            Bug id or text:
          </label>
        </th>
        <td>
          <tal:searchtext content="structure view/searchtext_widget" />
          <input type="submit" name="search" value="Search" />
        </td>
      </tr>
      <tr>
        <th>
          <label metal:use-macro="context/@@+bugtask-macros-listview/sortwidget_label" />
        </th>
        <td>
          <metal:widget use-macro="context/@@+bugtask-macros-listview/sortwidget" />
        </td>
      </tr>

      <metal:extra_widgets_in_table
          metal:define-slot="extra_search_widgets_in_table"
          tal:replace="nothing">
        Slot for placing extra search widgets in side the table.
      </metal:extra_widgets_in_table>

    </table>
    <metal:extra_widgets_below_table
        metal:define-slot="extra_search_widgets_below_table"
        tal:replace="nothing">
      Slot for placing extra search widgets below the table.
    </metal:extra_widgets_below_table>
  </tal:show-search-widgets>

  <tal:navigation
    replace="structure task_batch_navigator/@@+navigation-links"
    tal:condition="python:view.showBatchedListing() and task_batch_navigator.batch"
  />
  <tal:table_view tal:condition="view/showTableView">
    <table
       metal:use-macro="context/@@+bugtask-macros-tableview/batched-table" />
  </tal:table_view>
  <tal:list_view tal:condition="view/showListView"
                 tal:define="show_targetname view/shouldShowTargetName|nothing;
                             do_not_show_assignee view/doNotShowAssignee|nothing">

      <table>
        <tr tal:repeat="task task_batch_navigator/batch">
          <td tal:condition="view/mass_edit_allowed">
            <input type="checkbox" name="task" tal:attributes="value task/id" />
          </td>
          <metal:taskrow use-macro="task/@@+bugtask-macros-listview/item" />
        </tr>
      </table>
    </tal:list_view>

    <tal:edit tal:condition="view/mass_edit_allowed">
      <tal:block content="structure view/milestone_assignment_widget" />
      <input type="submit" name="assign_to_milestone"
             value="Assign to Milestone" />
    </tal:edit>

    </form>

    <tal:navigation
      replace="structure task_batch_navigator/@@+navigation-links"
      tal:condition="python:view.showBatchedListing() and task_batch_navigator.batch"
    />

  <tal:resultslist condition="not: task_batch_navigator/batch">
    <br />
    No matching results found. 
    <tal:block condition="not: view/_personContext">
      Would you like to
      <a href="#"
         tal:attributes="href string:${context/fmt:url}/+filebug;
                         title string:Report a bug on ${context/displayname}">
                         open a new bug?</a>
    </tal:block>
  </tal:resultslist>

  <script>
    <!--
        document.forms[0].elements['field.searchtext'].focus();
        //-->
  </script>

</metal:page>

</div>


</body>

</html>
