<tal:root
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  omit-tag="">

<metal:detailed_display define-macro="detailed_display">
  <tal:comment replace="nothing">
    This macro expects two variables to be defined:
      - 'file': The ProductReleaseFile
      - 'has_edit': A boolean saying whether the user has edit rights on this
                    ProductReleaseFile.
  </tal:comment>

  <tal:define-lfa define="lfa file/libraryfile">
    <td>
      <img alt="download icon" src="/@@/download" />
      <strong>
        <a tal:attributes="href file/url"
           tal:content="lfa/filename">filename</a>
      </strong>
      (<a tal:attributes="href file/md5_url">md5</a
        ><tal:signature condition="file/signature">,
      <a tal:attributes="href file/signature_url">sig</a></tal:signature>)
    </td>
    <td tal:condition="show_release|nothing">
      <tal:version content="release/version">version</tal:version>
    </td>
    <td tal:content="file/description">
      Installer for i386
    </td>
    <td style="text-align: center;">
      <tal:downloaded condition="lfa/hits">
        <span tal:replace="lfa/hits/fmt:intcomma">10</span>
        <br />
        <span style="font-size: 75%; color: grey;">
          <tal:downloaded-today condition="not:lfa/last_downloaded/days">
            last downloaded <strong>today</strong>
          </tal:downloaded-today>
          <tal:not-downloaded-today condition="lfa/last_downloaded/days">
            <strong tal:content="lfa/last_downloaded/fmt:approximateduration" />
            since last download
          </tal:not-downloaded-today>
      </tal:downloaded>
      <tal:not-downloaded condition="not:lfa/hits">
        -
      </tal:not-downloaded>
    </td>
    <td tal:condition="has_edit"
        align="center">
      <input type="checkbox"
             tal:define="cbnum string:${repeat/file/index}"
             tal:attributes="value lfa/id; name string:checkbox_${cbnum}" />
    </td>
  </tal:define-lfa>

</metal:detailed_display>
</tal:root>
