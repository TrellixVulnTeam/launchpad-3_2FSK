<div
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  xml:lang="en"
  lang="en"
  dir="ltr"
  i18n:domain="launchpad">

  <div metal:define-macro="form">

    <form action="." 
          tal:attributes="action view/action_url"
          method="post"
          enctype="multipart/form-data"
          accept-charset="UTF-8">

      <div metal:define-macro="formbody">

        <h1 tal:condition="view/label"
            tal:content="view/label"
            metal:define-slot="heading"
            >Add Something</h1>

        <p metal:define-slot="extra_info" tal:replace="nothing">
          This is the description of the form.
          This text will be in bold, beneath the title of the form,
          and should give any introductory information required.
          Don't use it to state the bleeding obvious!
        </p>

        <p metal:define-slot="error_count" class="error message"
           tal:condition="view/errors"
           tal:content="view/error_count" />

        <p metal:define-slot="error_messages" class="error message"
          tal:repeat="form_wide_error view/form_wide_errors"
          tal:content="structure form_wide_error">
          Schema validation errors.
        </p>

        <div class="row" 
             metal:define-slot="extra_top" 
             tal:replace="nothing">
            <div>Extra top</div>
            <div><input type="text" style="width:100%" /></div>
        </div>

        <metal:widgets metal:define-slot="widgets">
          <div metal:use-macro="context/@@launchpad_form/widget_rows" />
        </metal:widgets>

        <script type="text/javascript"
                tal:define="script view/focusedElementScript"
                tal:condition="script"
                tal:content="structure script" />

        <div class="row"
             metal:define-slot="extra_bottom" 
             tal:replace="nothing">
          <div>Extra bottom</div>
          <div class="field"><input type="text" style="width:100%" /></div>
        </div>

      </div>
      <div class="actions" metal:define-slot="buttons">
        <input tal:repeat="action view/actions"
               tal:replace="structure action/render"
          />
      </div>

      <div class="row" 
           metal:define-slot="extra_buttons" 
           tal:replace="nothing">
      </div>

    </form>
  </div>

  <metal:macro define-macro="widget_rows">
    <table class="form">
      <tal:block define="widgets widgets|view/widgets"
                 repeat="widget widgets">

  <metal:macro define-macro="widget_row"
      tal:define="field_name widget/context/__name__;
                  error python:view.getFieldError(field_name);
                  error_class python:error and 'error' or None;
                  show_optional python:view.showOptionalMarker(field_name)">
    <tal:is-visible condition="widget/visible">
      <tr tal:condition="python: view.isSingleLineLayout(field_name)">
        <th tal:condition="display_label|python:True">
          <label tal:attributes="for widget/name"
                 tal:content="string:${widget/label}:">Label</label>
        </th>
        <td tal:attributes="class error_class" width="100%">
          <div>
            <input tal:replace="structure widget" />
            <span tal:condition="show_optional"
                  class="fieldRequired">(Optional)</span>
          </div>
          <div class="message" tal:condition="error"
               tal:content="structure error">Error message</div>
          <p class="formHelp"
             tal:condition="widget/hint"
             tal:content="widget/hint">Some Help Text
          </p>
        </td>
      </tr>
      <tal:block condition="python: view.isMultiLineLayout(field_name)">
        <tr>
          <th colspan="2" style="text-align: left"><label
              tal:attributes="for widget/name"
              tal:content="string:${widget/label}:">Label:</label>
            <span tal:condition="show_optional"
                  class="fieldRequired">(Optional)</span>
          </th>
        </tr>
        <tr>
          <td colspan="2" tal:attributes="class error_class">
            <div tal:content="structure widget">
              <input type="text" style="width: 100%" />
            </div>
            <div class="message" tal:condition="error"
                 tal:content="structure error">Error message</div>
            <p class="formHelp"
               tal:condition="widget/hint"
               tal:content="widget/hint">Some Help Text
            </p>
          </td>
        </tr>
      </tal:block>
      <tr tal:condition="python: view.isCheckBoxLayout(field_name)">
        <th></th>
        <td tal:attributes="class error_class" width="100%">
          <input type="checkbox" tal:replace="structure widget" />
          <label tal:attributes="for widget/name"
                 tal:content="widget/label">Label</label>
          <div class="message" tal:condition="error"
               tal:content="structure error">Error message</div>
          <p class="formHelp"
             tal:condition="widget/hint"
             tal:content="widget/hint">Some Help Text
          </p>
        </td>
      </tr>
    </tal:is-visible>
    <tal:not-visible condition="not: widget/visible">
      <tr>
        <td tal:content="structure widget/hidden" />
      </tr>
    </tal:not-visible>
  </metal:macro>

      </tal:block>
    </table>
  </metal:macro>

</div>
