<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  xml:lang="en"
  lang="en"
  dir="ltr"
  metal:use-macro="view/macro:page/onecolumn"
  i18n:domain="launchpad"
>
<body>

<metal:block fill-slot="head_epilogue">
  <style type="text/css">
    canvas {
      border: 1px solid #000;
      float: left;
      margin-right: 20px;
      margin-bottom: 20px;
    }
  </style>

</metal:block>


<div metal:fill-slot="main">

  <a id="zoom-in" href="javascript:void(0)">Zoom in</a>
  | <a id="zoom-out" href="javascript:void(0)">Zoom out</a>

  <div id="canvas-container">
      <canvas id="supercanvas"></canvas>
  </div>
  <script type="text/javascript">
    YUI().use('registry.timeline', 'node', function(Y) {
        Y.on('domready', function(e) {
          if (Y.UA.ie) {
              return;
          }

          var graph;
          var zoom_in = Y.get('#zoom-in');
          zoom_in.on('click', function() {
              graph.zoom('in');
          });

          var zoom_out = Y.get('#zoom-out');
          zoom_out.on('click', function() {
              graph.zoom('out');
          });

          var display_graph = function(result) {
              var timeline = result;
              var canvas = document.getElementById('supercanvas');
              graph = new Y.registry.timeline.TimelineGraph(
                  timeline, canvas);
              graph.stretch_canvas();
              graph.draw();
          }

          var client = new LP.client.Launchpad();
          var timeline = client.named_get(
              LP.client.cache['context']['self_link'],
              'get_timeline', {
                  parameters: {},
                  on: {
                      success: display_graph,
                      failure: function(e) {
                          alert('failure:' + e);
                      }
                  }
              });
        });
    });
  </script>

</div>

</body>
</html>
